<!DOCTYPE html>
<html>

<head>
	<title>
	Deployment Â· SOFAStack
</title>
	<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="SOFAStack is a Scalable Open Financial Architecture for building cloud native applications" />

<meta name="generator" content="Hugo 0.55.6" /><link rel="shortcut icon" href=https://gw.alipayobjects.com/os/q/cms/images/jqu9346l/4ba95631-2489-4885-881f-bc7f8d787d5e_w64_h61.png type="image/png">

<link href="https://unpkg.com/purecss@1.0.0/build/base-min.css" rel="stylesheet">



<link href="/css/main.css" rel="stylesheet">
<link href="/css/zoom-image.css" rel="stylesheet">

<script src="/js/iconfont.js"></script>
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>window.SITE_LANGUAGE = "en"</script>
<script src="/js/app.js"></script>





<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-142131411-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>

<body>
	<header class="ss-header">
	<nav class="navbar" role="navigation" aria-label="main navigation">
		<div class="navbar-brand">
			<a class="logo-link" href="/en/">
				<img class="logo" src="/img/logo.png">
			</a>
			<div class="-show-mobile">
				<a id="mobile-menu-icon">
					<svg class="icon" aria-hidden="true">
						<use xlink:href="#icon-menu"></use>
					</svg>
				</a>
				<nav id="mobile-menu">
					
          
            <a
              class=""
              href="/en/projects/">
              <span>
                Projects
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
            <a
              class=""
              href="/en/guides/">
              <span>
                Guides
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
            <a
              class=""
              href="/en/blog/">
              <span>
                Blog
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
            <a
              class=""
              href="/en/activities/">
              <span>
                Activity
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
            <a
              class=""
              href="/awesome/">
              <span>
                Awesome SOFA
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
					
				</nav>
			</div>
		</div>

		<div class="navbar-menu -hidden-mobile">
			<div class="navbar-start">
				
				
					<a class="navbar-item "
						href="/en/projects/">Projects</a>
				
					<a class="navbar-item "
						href="/en/guides/">Guides</a>
				
					<a class="navbar-item "
						href="/en/blog/">Blog</a>
				
					<a class="navbar-item "
						href="/en/activities/">Activity</a>
				
					<a class="navbar-item "
						href="/awesome/">Awesome SOFA</a>
				
			</div>
			<div class="navbar-end">
				<div class="navbar-item">
					<div id="js-menu-search" class="navbar-search">
						<input class="input" placeholder="Search">
						<svg class="icon" aria-hidden="true">
							<use xlink:href="#icon-search"></use>
						</svg>
					</div>
				</div>
				
			</div>
		</div>
	</nav>
</header>


	

	

	

	

	



	

<div class="ss-layout-container">
	<aside class="ss-layout-aside -left ss-card -soft-hidden">
		






	<div id="js-drawer" class="ss-toc">
		<div id="js-drawer-handle" class="drawer-handle">
			<svg class="icon icon-menu" aria-hidden="true">
				<use xlink:href="#icon-menu"></use>
			</svg>
			<svg class="icon icon-close" aria-hidden="true">
				<use xlink:href="#icon-close"></use>
			</svg>
		</div>
		<div class="drawer-body">
			<div class="header" title="SOFARegistry is a production-level, low-latency, and highly available service registry powered by Ant Financial.">SOFARegistry




	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	










<div class="ss-toc-list-card -hidden-mobile">
  <svg class="icon -hidden-mobile" aria-hidden="true">
    <use xlink:href="#icon-menu1"></use>
  </svg>
  <div class="ss-tooltip">
		
			
				<div class="toc-list">
					<h4 class="title">Main Projects</h4>
					<ul class="list">
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-boot/overview>
									SOFABoot
								</a>
              </li>
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-rpc/overview>
									SOFARPC
								</a>
              </li>
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-mosn/overview>
									SOFAMOSN
								</a>
              </li>
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-tracer/overview>
									SOFATracer
								</a>
              </li>
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-lookout/overview>
									SOFALookout
								</a>
              </li>
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-registry/overview>
									SOFARegistry
								</a>
              </li>
						
					</ul>
				</div>
			
		
			
				<div class="toc-list">
					<h4 class="title">Incubating Projects</h4>
					<ul class="list">
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-mesh/overview>
									SOFAMesh
								</a>
              </li>
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-dashboard/overview>
									SOFADashboard
								</a>
              </li>
						
					</ul>
				</div>
			
		
			
				<div class="toc-list">
					<h4 class="title">Tool Projects</h4>
					<ul class="list">
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-bolt/overview>
									SOFABolt
								</a>
              </li>
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-jraft/overview>
									SOFAJRaft
								</a>
              </li>
						
							<li class="item">
								
								
									
								
								<a href=/en/projects/sofa-acts/overview>
									SOFAActs
								</a>
              </li>
						
							<li class="item">
								
								
									
										
									
								
								<a href=https://www.sofastack.tech/en/projects/sofa-boot/sofa-ark-readme/>
									SOFAArk
								</a>
              </li>
						
					</ul>
				</div>
			
		
			
				<div class="toc-list">
					<h4 class="title">Ecosystem Projects</h4>
					<ul class="list">
						
							<li class="item">
								
								
									
										
									
								
								<a href=https://seata.io>
									Seata
								</a>
              </li>
						
					</ul>
				</div>
			
		
  </div>
</div>
			</div>
			<div class="body">
				



<ul class="leaf-section">
	
		
		
			<li class="item">
				<div class="link">
					<svg class="icon arrow" aria-hidden="true">
						<use xlink:href="#icon-arrow"></use>
					</svg>
					<a
						title="Introduction"
					>Introduction</a>
				</div>
				



<ul class="leaf-section">
	
		
			<li class="item">
				<div class="link">
					<a
						title="Overview"
						href="/en/projects/sofa-registry/overview"
					>Overview</a>
				</div>
			</li>
		
		
	
		
			<li class="item">
				<div class="link">
					<a
						title="Terminology"
						href="/en/projects/sofa-registry/terminology"
					>Terminology</a>
				</div>
			</li>
		
		
	
</ul>
			</li>
		
	
		
		
			<li class="item">
				<div class="link">
					<svg class="icon arrow" aria-hidden="true">
						<use xlink:href="#icon-arrow"></use>
					</svg>
					<a
						title="Quick start"
					>Quick start</a>
				</div>
				



<ul class="leaf-section">
	
		
			<li class="item">
				<div class="link">
					<a
						title="Server deployment"
						href="/en/projects/sofa-registry/server-quick-start"
					>Server deployment</a>
				</div>
			</li>
		
		
	
		
			<li class="item">
				<div class="link">
					<a
						title="Client usage"
						href="/en/projects/sofa-registry/client-quick-start"
					>Client usage</a>
				</div>
			</li>
		
		
	
</ul>
			</li>
		
	
		
		
			<li class="item">
				<div class="link">
					<svg class="icon arrow" aria-hidden="true">
						<use xlink:href="#icon-arrow"></use>
					</svg>
					<a
						title="Developer guide"
					>Developer guide</a>
				</div>
				



<ul class="leaf-section">
	
		
			<li class="item">
				<div class="link">
					<a
						title="JAVA SDK"
						href="/en/projects/sofa-registry/java-sdk"
					>JAVA SDK</a>
				</div>
			</li>
		
		
	
</ul>
			</li>
		
	
</ul>
			</div>
		</div>
	</div>

	</aside>

	<main class="ss-layout-main -card">
		




<div class="ss-meta">
	<div class="container">
		<h1 class="title">
			Deployment
		</h1>
		<a class="edit-button -hidden-mobile"
			href="https://github.com/sofastack/sofastack.tech/edit/master/content/en/projects/sofa-registry/deployment/index.md"
		>Edit</a>
	</div>
	<div class="meta">
		Update time: 0001-01-01
	</div>
</div>

		<article class="typo">
	<h2 id="environment-preparation">Environment preparation</h2>

<p>To use SOFARegistry, you need to prepare the basic environment first. SOFARegistry depends on the following environment:</p>

<ul>
<li>Linux, UNIX, Mac, and Windows are supported.</li>
<li>JDK8</li>
<li>Compile it with Apache Maven 3.2.5 or later versions.</li>
</ul>

<h2 id="two-deployment-modes">Two deployment modes</h2>

<ul>
<li>Integrated deployment

<ul>
<li>Package and integrate the three roles of meta, data, and session into one jvm, which can be deployed on a standalone machine or a cluster. The deployment is simple.</li>
</ul></li>
<li>Independent deployment

<ul>
<li>Deploy the meta, data, and session roles separately. You can deploy each of them on a standalone machine or a cluster. You can deploy different numbers of servers for each role as needed.</li>
<li>We recommend that you use this deployment mode in the production environment.</li>
</ul></li>
</ul>

<h2 id="deployment-steps">Deployment steps</h2>

<h3 id="1-download-source-code-and-compile-and-package-the-code">1. Download source code, and compile and package the code</h3>

<h4 id="1-1-download-the-source-code">1.1 Download the source code</h4>

<pre><code class="language-bash">git clone https://github.com/sofastack/sofa-registry.git
cd sofa-registry
</code></pre>

<h4 id="1-2-compile-and-package-the-code">1.2 Compile and package the code</h4>

<pre><code class="language-bash">mvn clean package -DskipTests
</code></pre>

<h3 id="2-deploy-sofaregistry">2. Deploy SOFARegistry</h3>

<h4 id="2-1-integrated-deployment">2.1 Integrated deployment</h4>

<p>Package and integrate the three roles of meta, data, and session into one jvm, which can be deployed on a standalone machine or a cluster.</p>

<h5 id="2-1-1-standalone-deployment">2.1.1 Standalone deployment</h5>

<p>For more information about the standalone deployment mode of integrated deployment, see <a href="../server-quick-start">Quick start- Server deployment</a>.</p>

<h5 id="2-1-2-cluster-deployment">2.1.2 Cluster deployment</h5>

<ul>
<li>Decompress registry-integration.tgz and modify the configuration file.</li>
</ul>

<p>Cluster deployment: In this mode, you need to build a cluster of two or more servers. We recommend that you use at least three servers. Note: Currently, you cannot deploy more than one SOFARegistry instance on the same server, which means you must have at least three different servers. The method for deploying SOFARegistry on each server is basically the same as that in standalone deployment:</p>

<pre><code class="language-bash">cp server/distribution/integration/target/registry-integration.tgz &lt;somewhere&gt;
cd &lt;somewhere&gt; &amp;&amp; mkdir registry-integration 
tar -zxvf registry-integration.tgz -C registry-integration
</code></pre>

<p>The difference is that, when you deploy each server in the cluster deployment mode, you need to modify the <em>conf/application.properties</em> configuration:</p>

<pre><code class="language-bash"># Enter the IP addresses or hostnames of the three servers in the following fields (the hostname will be resolved to the IP address within SOFARegistry)
nodes.metaNode=DefaultDataCenter:&lt;hostname1&gt;,&lt;hostname2&gt;,&lt;hostname3&gt;
nodes.localDataCenter=DefaultDataCenter
nodes.localRegion=DefaultZone
</code></pre>

<ul>
<li>Start registry-integration</li>
</ul>

<p>After modifying the configuration file for each server, you can start registry-integration as specified in Server deployment.</p>

<ul>
<li>Linux/Unix/Mac: sh bin/startup.sh.</li>
<li>Windows: Double click the startup.bat file under the bin directory.</li>
<li>Check the running status: For each server, you can access the healthcheck API provided by these three roles, or view <em>logs/registry-startup.log to check the running status.</em></li>
</ul>

<pre><code class="language-bash"># View the healthcheck API of the meta role (one leader and two followers):
$ curl http://localhost:9615/health/check
{&quot;success&quot;:true,&quot;message&quot;:&quot;... raftStatus:Leader&quot;}

# View the healthcheck API of the data role:
$ curl http://localhost:9622/health/check
{&quot;success&quot;:true,&quot;message&quot;:&quot;... status:WORKING&quot;}

# View the healthcheck API of the session role:
$ curl http://localhost:9603/health/check
{&quot;success&quot;:true,&quot;message&quot;:&quot;...&quot;}
</code></pre>

<h2 id="2-2-independent-deployment">2.2 Independent deployment</h2>

<p>DDeploy the meta, data, and session soles separately. Each of the roles can be deployed on a standalone machine or a cluster. You can deploy different numbers of servers for each role as needed. We recommend that you use this deployment mode in the production environment.</p>

<p>Next, we will describe the deployment steps of the 3-3-2 mode (three meta servers + three data servers + two session servers)</p>

<h4 id="2-2-1-deploy-the-meta-role">2.2.1 Deploy the meta role</h4>

<ul>
<li>Decompress the registry-meta.tgz and modify the configuration file.</li>
</ul>

<p>Deploy the meta role on three servers. Run the following command to deploy the role on each machine:</p>

<pre><code class="language-bash">cp server/distribution/meta/target/registry-meta.tgz &lt;somewhere&gt;
cd &lt;somewhere&gt; &amp;&amp; mkdir registry-meta 
tar -zxvf registry-meta.tgz -C registry-meta
</code></pre>

<p>You need to modify the configuration of <em>conf/application.properties</em> when you deploy the role on each machine:</p>

<pre><code class="language-bash"># Enter the IP addresses or hostnames of the three meta machines in the following fields (the hostname will be resolved to the IP address within SOFARegistry).
nodes.metaNode=DefaultDataCenter:&lt;meta_hostname1&gt;,&lt;meta_hostname2&gt;,&lt;meta_hostname3&gt;
nodes.localDataCenter=DefaultDataCenter
</code></pre>

<ul>
<li>Start registry-meta.

<ul>
<li>Linux/Unix/Mac: sh bin/startup.sh.</li>
<li>Windows: Double click the startup.bat file under the bin directory.</li>
</ul></li>
<li>Check the running status: For each server, you can access the healthcheck API provided by the meta role, or view logs/registry-startup.log to check the running status.</li>
</ul>

<pre><code class="language-bash"># View the healthcheck API of the meta role (one leader and two followers):
$ curl http://localhost:9615/health/check
{&quot;success&quot;:true,&quot;message&quot;:&quot;... raftStatus:Leader&quot;}
</code></pre>

<h4 id="2-2-2-deploy-the-data-role">2.2.2 Deploy the data role</h4>

<ul>
<li>Decompress the registry-data.tgz and modify the configuration file.</li>
</ul>

<p>Deploy the data role on three servers. Run the following command to deploy the role on each machine:</p>

<pre><code class="language-bash">cp server/distribution/data/target/registry-data.tgz &lt;somewhere&gt;
cd &lt;somewhere&gt; &amp;&amp; mkdir registry-data 
tar -zxvf registry-data.tgz -C registry-data
</code></pre>

<p>You need to modify the configuration of <em>conf/application.properties</em> when you deploy the role on each machine:</p>

<pre><code class="language-bash"># Enter the IP addresses or hostnames of the three meta machines in the following fields (the hostname will be resolved to the IP address within SOFARegistry).
nodes.metaNode=DefaultDataCenter:&lt;meta_hostname1&gt;,&lt;meta_hostname2&gt;,&lt;meta_hostname3&gt;
nodes.localDataCenter=DefaultDataCenter
data.server.numberOfReplicas=1
</code></pre>

<ul>
<li>Restart registry-data.

<ul>
<li>Linux/Unix/Mac: sh bin/startup.sh.</li>
<li>Windows: Double click the startup.bat file under the bin directory.</li>
</ul></li>
<li>Check the running status: For each server, you can access the healthcheck API provided by the data role, or view <em>logs/registry-startup.log to check the running status.</em></li>
</ul>

<pre><code class="language-bash"># View the healthcheck API of the data role:
$ curl http://localhost:9622/health/check
{&quot;success&quot;:true,&quot;message&quot;:&quot;... status:WORKING&quot;}
</code></pre>

<h4 id="2-2-2-deploy-the-session-role">2.2.2 Deploy the session role</h4>

<ul>
<li>Decompress the registry-session.tgz and modify the configuration file.</li>
</ul>

<p>Deploy the session role on two servers. Run the following command to deploy the role on each machine:</p>

<pre><code class="language-bash">cp server/distribution/session/target/registry-session.tgz &lt;somewhere&gt;
cd &lt;somewhere&gt; &amp;&amp; mkdir registry-session 
tar -zxvf registry-session.tgz -C registry-session
</code></pre>

<p>You need to modify the configuration of <em>conf/application.properties</em> when you deploy the role on each machine:</p>

<pre><code class="language-bash"># Enter the IP addresses or hostnames of the three meta machines in the following fields (the hostname will be resolved to the IP address within SOFARegistry).
nodes.metaNode=DefaultDataCenter:&lt;meta_hostname1&gt;,&lt;meta_hostname2&gt;,&lt;meta_hostname3&gt;
nodes.localDataCenter=DefaultDataCenter
nodes.localRegion=DefaultZone
</code></pre>

<ul>
<li>Start registry-session

<ul>
<li>Linux/Unix/Mac: sh bin/startup.sh.</li>
<li>Windows: Double click the startup.bat file under the bin directory.</li>
</ul></li>
<li>Check the running status: For each server, you can access the healthcheck API provided by the session role, or view <em>logs/registry-startup.log to check the running status.</em></li>
</ul>

<pre><code class="language-bash"># View the healthcheck API of the session role:
$ curl http://localhost:9603/health/check
{&quot;success&quot;:true,&quot;message&quot;:&quot;...&quot;}
</code></pre>

</article>
	</main>
</div>



	


<footer class="ss-footer">
	<div class="container">
		<div class="links">
			
				<div class="cate">
					<h2 class="cate-title">Resources</h2>
					
						<a class="link" href="https://github.com/sofastack">Github</a>
					
						<a class="link" href="https://gitee.com/sofastack/">Gitee</a>
					
						<a class="link" href="https://github.com/sofastack-guides">Samples</a>
					
				</div>
			
				<div class="cate">
					<h2 class="cate-title">Social Media</h2>
					
						<a class="link" href="https://zhuanlan.zhihu.com/sofastack">Zhihu</a>
					
						<a class="link" href="https://weibo.com/sofastack">Weibo</a>
					
						<a class="link" href="https://twitter.com/sofastack_io">Twitter</a>
					
				</div>
			
				<div class="cate">
					<h2 class="cate-title">Get Involved</h2>
					
						<a class="link" href="https://github.com/sofastack/sofastack.tech/issues">Feedback</a>
					
						<a class="link" href="https://github.com/sofastack/community">Community</a>
					
						<a class="link" href="https://github.com/sofastack/sofastack.tech/wiki">Wiki</a>
					
						<a class="link" href="mailto:sofa@alipay.cloud.com">Email</a>
					
				</div>
			
				<div class="cate">
					<h2 class="cate-title">Ant Financial Open Source</h2>
					
						<a class="link" href="https://ant.design/">Ant.Design</a>
					
						<a class="link" href="https://eggjs.org/">Egg.js</a>
					
						<a class="link" href="https://sqlflow.org">SQLFlow</a>
					
						<a class="link" href="https://tech.antfin.com/open-source">More</a>
					
				</div>
			
		</div>
		<div class="qrcode">
			
				<div>
					<img class="qrcode-img" src="/img/qrcode/qrcode_1.png" />
					<p class="qrcode-desc">Wechat Official Account</p>
				</div>
			
				<div>
					<img class="qrcode-img" src="/img/qrcode/qrcode_2.png" />
					<p class="qrcode-desc">DingTalk Group</p>
				</div>
			
		</div>
	</div>
	<div class="copyright">
		<p>
			Â© 2019 ç¹éå¿
			<a href="#">æ»ICPå¤14007546å·</a>
		</p>
	</div>
</footer>
</body>

</html>