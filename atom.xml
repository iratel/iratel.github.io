<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶</title>
  
  <subtitle>HaloğŸ’«</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://xujin.org/"/>
  <updated>2019-01-13T05:49:46.955Z</updated>
  <id>http://xujin.org/</id>
  
  <author>
    <name>HaloğŸ’«</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Spring Cloudç¬¬äºŒä»£</title>
    <link href="http://xujin.org/sc/sc2/"/>
    <id>http://xujin.org/sc/sc2/</id>
    <published>2018-11-27T06:00:00.000Z</published>
    <updated>2019-01-13T05:49:46.955Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>: éšç€Eurekaä¸å†ç»´æŠ¤ï¼ŒHystrixä¸å†å¼€å‘æ–°åŠŸèƒ½ï¼Œè¿›å…¥ç»´æŠ¤çŠ¶æ€ã€‚ä»¥åŠæœ€è¿‘ä¸­å›½å¼€æºå‡ºç°ä¸€äº›å¤§äº‹ï¼Œé¢„æµ‹ä¸€ä¸‹2019å¹´æœªæ¥Spring Cloudç”Ÿæ€åœˆä¸­çš„ç¬¬äºŒä»£ç»„ä»¶çš„ç»„åˆï¼Œä»…<code>ä»£è¡¨ä¸ªäººçœ‹æ³•</code>ã€‚</p><p> <img src="/banner/sc2.png" alt=""></p><h2 id="1-Spring-Cloudç¬¬ä¸€ä»£"><a href="#1-Spring-Cloudç¬¬ä¸€ä»£" class="headerlink" title="1. Spring Cloudç¬¬ä¸€ä»£"></a>1. Spring Cloudç¬¬ä¸€ä»£</h2><p>  Spring Cloudè‡ªä»æ¨å‡ºä¹‹åï¼Œç»™å¤§å®¶çš„æ„Ÿè§‰å°±æ˜¯Spring Cloudåš<code>å®ƒæœ€æ“…é•¿çš„äº‹ï¼Œä¹Ÿå°±æ˜¯é«˜åº¦æŠ½è±¡å’Œå°è£…ï¼Œå¼ºå¼ºè”æ‰‹æ•´åˆæœ€ä¼˜ä¸œè¥¿ä¸ºæˆ‘æ‰€ç”¨</code>ï¼Œæ¯”å¦‚Netflixå¼€æºçš„Eurekaï¼ŒHystrixï¼ŒRibbonç­‰ã€‚è€Œä¸”æä¾›<code>å¤šç§æŠ€æœ¯é€‰å‹ï¼Œæ€åº¦ä¸­ç«‹è€Œé€‰æœ€ä¼˜</code>ã€‚8å¤©å‰ä¹Ÿå°±æ˜¯2018å¹´11æœˆ19å·å·¦å³ï¼ŒNetflixçš„å¼€æºé¡¹ç›®Hystrixå®£å¸ƒçŠ¶æ€ï¼Œä¸å†å¼€å‘æ–°åŠŸèƒ½ï¼Œå¤„äºç»´æŠ¤çŠ¶æ€ã€‚å¼•å‘æœ‹å‹åœˆçš„ä¸€äº›æ€è€ƒã€‚</p><a id="more"></a><p><img src="/images/sc/hystrix.jpg" alt=""></p><blockquote><p>è™½ç„¶Eurekaï¼ŒHystrixç­‰ä¸å†ç»§ç»­å¼€å‘æˆ–ç»´æŠ¤ï¼Œä½†æ˜¯ç›®å‰æ¥è¯´ä¸å½±å“ä½¿ç”¨ï¼Œä¸ç®¡æ€ä¹ˆè¯´æ„Ÿè°¢å¼€æºï¼Œå‘Netflixå…¬å¸çš„å¼€æºè‡´æ•¬ã€‚</p></blockquote><p>  éšç€Spring Cloudç”Ÿæ€åœˆçš„å‘å±•ä¸æˆé•¿ï¼ŒSpring Cloudé™†ç»­æ¨å‡ºäº†è‡ªå·±çš„ä¸€äº›ç»„ä»¶ï¼ŒæŒ‘é€‰ä¸»è¦ç»„ä»¶è¯´æ˜å¦‚ä¸‹è¡¨æ‰€ç¤º:</p><table><thead><tr><th>ç»„ä»¶</th><th>æ¥æº</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Spring-cloud-openfeign</td><td>åŸºäºFeignçš„å‡çº§</td><td>æœåŠ¡ä¹‹é—´è°ƒç”¨çš„å¿…å¤‡ç»„ä»¶</td></tr><tr><td>spring-cloud-zuul</td><td>æ¥æºäºNetflix Zuul</td><td>ç›®å‰è¿˜åœ¨ç»§ç»­ç»´æŠ¤ï¼Œä½†æ˜¯å·²ç»æœ‰è‡ªå·±çš„Spring Cloud Gateway,ä¸ä¹…å°†æ¥é€æ¸æ·˜æ±°</td></tr><tr><td>spring-cloud-eureka</td><td>é›†æˆäºNetflix Eureka</td><td>ç›®å‰è¿˜åœ¨è·ŸéšSpring Cloudç‰ˆæœ¬å‡çº§ç»´æŠ¤ï¼Œæœ€ç»ˆä¹Ÿä¼šè¢«æ›¿ä»£</td></tr><tr><td>spring-cloud-config</td><td>è‡ªç ”</td><td>åŠŸèƒ½ä¸è¶³ï¼Œå›½å†…ä½¿ç”¨å…¶å®ƒé…ç½®ä¸­å¿ƒæ›¿ä»£ï¼Œæ¯”å¦‚æºç¨‹çš„Apollo</td></tr><tr><td>å…¨é“¾è·¯ç›‘æ§(sleuth+zikpinæˆ–pinpont)</td><td>sleuthè‡ªç ”ï¼Œå…¶å®ƒç¬¬ä¸‰æ–¹</td><td>å›½å†…ç›®å‰ä½¿ç”¨æœ€å¤šçš„æ˜¯skywalingç­‰ä¸Šç”Ÿäº§</td></tr><tr><td>spring-cloud-ribbon</td><td>æ¥æºäºNetflixé›†æˆ</td><td>ribbonç›®å‰è¿˜åœ¨è·ŸéšSpring Cloudç‰ˆæœ¬ç»´æŠ¤ä¸­ï¼Œç›®å‰å­µåŒ–æœªæ¥æ›¿ä»£å“spring-cloud-lb</td></tr><tr><td>Spring-cloud-hystrix</td><td>æ¥æºäºNetflixé›†æˆ</td><td>ç›®å‰è¿˜åœ¨è·ŸéšSpring Cloudç‰ˆæœ¬ç»´æŠ¤ä¸­ç›®å‰å·²ç»å­µåŒ–spring-cloud-r4j</td></tr></tbody></table><h2 id="2-Spring-Cloud-ç¬¬äºŒä»£"><a href="#2-Spring-Cloud-ç¬¬äºŒä»£" class="headerlink" title="2. Spring Cloud ç¬¬äºŒä»£"></a>2. Spring Cloud ç¬¬äºŒä»£</h2><p> Spring Cloudç¬¬ä¸€ä»£å’Œç¬¬äºŒä»£çš„ç»„ä»¶ç»„åˆæ±‡æ€»ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><table><thead><tr><th></th><th>Spring Cloudç¬¬ä¸€ä»£</th><th>Spring Cloudç¬¬äºŒä»£</th></tr></thead><tbody><tr><td>ç½‘å…³</td><td>Spring Cloud Zuul</td><td>Spring Cloud Gateway</td></tr><tr><td>æ³¨å†Œä¸­å¿ƒ</td><td>eureka(ä¸å†æ›´æ–°)ï¼ŒConsul,ZK</td><td>é˜¿é‡ŒNacosï¼Œæ‹æ‹è´·radarç­‰å¯é€‰</td></tr><tr><td>é…ç½®ä¸­å¿ƒ</td><td>spring cloud config</td><td>é˜¿é‡ŒNacosï¼Œæºç¨‹Apolloï¼Œéšè¡Œä»˜Config Keeper</td></tr><tr><td>å®¢æˆ·ç«¯è½¯è´Ÿè½½å‡è¡¡</td><td>Ribbon</td><td>spring-cloud-loadbalancer</td></tr><tr><td>ç†”æ–­å™¨</td><td>Hystrix</td><td>spring-cloud-r4j(Resilience4J)ï¼Œé˜¿é‡ŒSentinel</td></tr></tbody></table><blockquote><p>ç”±äºZuulæ€§èƒ½ä¸€èˆ¬ï¼Œzuul 2.x(ä¸€ç›´è·³ç¥¨ï¼Œè™½æœ€ç»ˆå¼€æºï¼‰ä½†æ˜¯Spring Cloudå®˜æ–¹å·²ç»æ¨å‡ºSpring Cloud gateway,Spring Cloudä¸­å›½ç¤¾åŒºå¾ˆä¹…ä¹‹å‰å·²ç»è¯å®ï¼ŒSpring Cloudå°†ä¸ä¼šé›†æˆzuul 2.xï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä¸å°±æœªæ¥Zuulå°†ä»Spring Cloudç”Ÿæ€åœˆä¸­é€€å‡ºã€‚</p></blockquote><hr><blockquote><p>ribbonç”±äºä¸æ”¯æŒwebFluxçš„è´Ÿè½½å‡è¡¡ï¼ŒSpring Cloudå®˜æ–¹å¾ˆæ—©å°±åœ¨å­µåŒ–å™¨é¡¹ç›®ä¸­å­µåŒ–spring-cloud-loadbalancerï¼Œç›®å‰å·²ç»å°†ä»£ç åˆå¹¶åˆ°spring-cloud-commonä¸­ï¼Œé¢„è®¡åœ¨Spring Cloud Gç‰ˆå¯ä»¥ä½¿ç”¨ï¼Œé¢„è®¡2018å¹´12æœˆåº•realeseã€‚</p></blockquote><hr><blockquote><p>è‡³äºHystrixï¼ŒNetflixåœ¨2018å¹´11æœˆ19å·å·¦å³ï¼ŒNetflixçš„å¼€æºé¡¹ç›®Hystrixå®£å¸ƒçŠ¶æ€ï¼Œä¸å†å¼€å‘æ–°åŠŸèƒ½ï¼Œå¤„äºç»´æŠ¤çŠ¶æ€ï¼Œå…¶å®åœ¨ä¹‹å‰Spring Cloudå®˜æ–¹å°±åœ¨å­µåŒ–spring-cloud-r4j.</p></blockquote><h2 id="3-å¼€æºé¡¹ç›®çš„é“¾æ¥"><a href="#3-å¼€æºé¡¹ç›®çš„é“¾æ¥" class="headerlink" title="3.å¼€æºé¡¹ç›®çš„é“¾æ¥"></a>3.å¼€æºé¡¹ç›®çš„é“¾æ¥</h2><p>æœ¬æ–‡æ‰€æåˆ°çš„å¼€æºé¡¹ç›®é“¾æ¥æ±‡æ€»å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><a href="https://github.com/alibaba/Sentinel" target="_blank" rel="noopener">https://github.com/alibaba/Sentinel</a></p><p><a href="https://github.com/spring-cloud-incubator/spring-cloud-r4j" target="_blank" rel="noopener">https://github.com/spring-cloud-incubator/spring-cloud-r4j</a></p><p><a href="https://github.com/alibaba/nacos" target="_blank" rel="noopener">é˜¿é‡ŒNacos-https://github.com/alibaba/nacos</a></p><p><a href="https://github.com/sxfad/config-keeper" target="_blank" rel="noopener">éšè¡Œä»˜Config-keeper-https://github.com/sxfad/config-keeper</a></p><p><a href="https://github.com/spring-cloud-incubator/spring-cloud-loadbalancer" target="_blank" rel="noopener">spring-cloud-loadbalancer</a></p><p><a href="https://github.com/ctripcorp/apollo" target="_blank" rel="noopener">https://github.com/ctripcorp/apollo</a></p><p><a href="https://github.com/apache/incubator-skywalking" target="_blank" rel="noopener">https://github.com/apache/incubator-skywalking</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;: éšç€Eurekaä¸å†ç»´æŠ¤ï¼ŒHystrixä¸å†å¼€å‘æ–°åŠŸèƒ½ï¼Œè¿›å…¥ç»´æŠ¤çŠ¶æ€ã€‚ä»¥åŠæœ€è¿‘ä¸­å›½å¼€æºå‡ºç°ä¸€äº›å¤§äº‹ï¼Œé¢„æµ‹ä¸€ä¸‹2019å¹´æœªæ¥Spring Cloudç”Ÿæ€åœˆä¸­çš„ç¬¬äºŒä»£ç»„ä»¶çš„ç»„åˆï¼Œä»…&lt;code&gt;ä»£è¡¨ä¸ªäººçœ‹æ³•&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt; &lt;img src=&quot;/banner/sc2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-Spring-Cloudç¬¬ä¸€ä»£&quot;&gt;&lt;a href=&quot;#1-Spring-Cloudç¬¬ä¸€ä»£&quot; class=&quot;headerlink&quot; title=&quot;1. Spring Cloudç¬¬ä¸€ä»£&quot;&gt;&lt;/a&gt;1. Spring Cloudç¬¬ä¸€ä»£&lt;/h2&gt;&lt;p&gt;  Spring Cloudè‡ªä»æ¨å‡ºä¹‹åï¼Œç»™å¤§å®¶çš„æ„Ÿè§‰å°±æ˜¯Spring Cloudåš&lt;code&gt;å®ƒæœ€æ“…é•¿çš„äº‹ï¼Œä¹Ÿå°±æ˜¯é«˜åº¦æŠ½è±¡å’Œå°è£…ï¼Œå¼ºå¼ºè”æ‰‹æ•´åˆæœ€ä¼˜ä¸œè¥¿ä¸ºæˆ‘æ‰€ç”¨&lt;/code&gt;ï¼Œæ¯”å¦‚Netflixå¼€æºçš„Eurekaï¼ŒHystrixï¼ŒRibbonç­‰ã€‚è€Œä¸”æä¾›&lt;code&gt;å¤šç§æŠ€æœ¯é€‰å‹ï¼Œæ€åº¦ä¸­ç«‹è€Œé€‰æœ€ä¼˜&lt;/code&gt;ã€‚8å¤©å‰ä¹Ÿå°±æ˜¯2018å¹´11æœˆ19å·å·¦å³ï¼ŒNetflixçš„å¼€æºé¡¹ç›®Hystrixå®£å¸ƒçŠ¶æ€ï¼Œä¸å†å¼€å‘æ–°åŠŸèƒ½ï¼Œå¤„äºç»´æŠ¤çŠ¶æ€ã€‚å¼•å‘æœ‹å‹åœˆçš„ä¸€äº›æ€è€ƒã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Spring Cloud" scheme="http://xujin.org/categories/Spring-Cloud/"/>
    
    
      <category term="Spring Cloud" scheme="http://xujin.org/tags/Spring-Cloud/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨Nacoså®ç°Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±</title>
    <link href="http://xujin.org/sc/gw/gw10/"/>
    <id>http://xujin.org/sc/gw/gw10/</id>
    <published>2018-11-17T06:00:00.000Z</published>
    <updated>2019-01-12T03:33:48.579Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬æ–‡ä¸»è¦ä»‹ç»é€šè¿‡Nacosä¸‹å‘è·¯ç”±é…ç½®å®ç°Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±ã€‚</p><h2 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1.å‰è¨€"></a>1.å‰è¨€</h2><p>   ç½‘å…³ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œé‚£å°±æ˜¯è·¯ç”±é…ç½®å’Œè·¯ç”±è§„åˆ™ï¼Œè·¯ç”±é…ç½®æ˜¯æŒ‡é…ç½®æŸè¯·æ±‚è·¯å¾„è·¯ç”±åˆ°æŒ‡å®šçš„ç›®çš„åœ°å€ã€‚è€Œè·¯ç”±è§„åˆ™æ˜¯æŒ‡åŒ¹é…åˆ°è·¯ç”±é…ç½®ä¹‹åï¼Œå†æ ¹æ®è·¯ç”±è§„åˆ™è¿›è¡Œè½¬å‘å¤„ç†ã€‚<br>   Spring Cloud Gatewayä½œä¸ºæ‰€æœ‰è¯·æ±‚æµé‡çš„å…¥å£ï¼Œåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¸ºäº†ä¿è¯é«˜å¯é å’Œé«˜å¯ç”¨ï¼Œå°½é‡é¿å…é‡å¯,éœ€è¦å®ç°Spring Cloud GatewayåŠ¨æ€è·¯ç”±é…ç½®ã€‚å‰é¢ç« èŠ‚ä»‹ç»äº†Spring Cloud Gatewayæä¾›çš„ä¸¤ç§æ–¹æ³•å»é…ç½®è·¯ç”±è§„åˆ™ï¼Œä½†éƒ½æ˜¯åœ¨Spring Cloud Gatewayå¯åŠ¨æ—¶å€™ï¼Œå°±å°†è·¯ç”±é…ç½®å’Œè§„åˆ™åŠ è½½åˆ°å†…å­˜é‡Œï¼Œæ— æ³•åšåˆ°ä¸é‡å¯ç½‘å…³å°±å¯ä»¥åŠ¨æ€çš„å¯¹åº”è·¯ç”±çš„é…ç½®å’Œè§„åˆ™è¿›è¡Œå¢åŠ ï¼Œä¿®æ”¹å’Œåˆ é™¤ã€‚æœ¬æ–‡æ˜¯åŸºäº<a href="http://xujin.org/sc/gw/gw09/">Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±å®ç°</a><br>åŸºç¡€ä¹‹ä¸Šç¼–å†™ï¼Œé€šè¿‡Nacosé…ç½®æœåŠ¡ä¸‹å‘è·¯ç”±é…ç½®å®ç°åŠ¨æ€è·¯ç”±ã€‚</p><a id="more"></a><h2 id="2-Spring-Cloud-Gatewayç®€å•çš„åŠ¨æ€è·¯ç”±å®ç°"><a href="#2-Spring-Cloud-Gatewayç®€å•çš„åŠ¨æ€è·¯ç”±å®ç°" class="headerlink" title="2. Spring Cloud Gatewayç®€å•çš„åŠ¨æ€è·¯ç”±å®ç°"></a>2. Spring Cloud Gatewayç®€å•çš„åŠ¨æ€è·¯ç”±å®ç°</h2><p>Spring Cloud Gatewayçš„å®˜æ–¹æ–‡æ¡£å¹¶æ²¡æœ‰è®²å¦‚ä½•åŠ¨æ€é…ç½®ï¼ŒæŸ¥çœ‹ Spring Cloud Gatewayçš„æºç ï¼Œå‘ç°<code>åœ¨org.springframework.cloud.gateway.actuate.GatewayControllerEndpoint</code>ç±»ä¸­æä¾›äº†åŠ¨æ€é…ç½®çš„Restæ¥å£ï¼Œä½†æ˜¯<code>éœ€è¦å¼€å¯Gatewayçš„ç«¯ç‚¹</code>ï¼Œè€Œä¸”æä¾›çš„åŠŸèƒ½ä¸æ˜¯å¾ˆå¼ºå¤§ã€‚é€šè¿‡å‚è€ƒå’ŒGatewayControllerEndpointç›¸å…³çš„ä»£ç ï¼Œå¯ä»¥è‡ªå·±ç¼–ç å®é™…åŠ¨æ€è·¯ç”±é…ç½®ã€‚<br>ä¸‹é¢é€šè¿‡æ¡ˆä¾‹çš„æ–¹å¼å»è®²è§£æ€ä¹ˆé€šNacoså®ç°Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±ã€‚æ¡ˆä¾‹å·¥ç¨‹å¦‚spring-cloud-gateway-nacosæ‰€ç¤ºã€‚</p><blockquote><p>ä»£ç åœ°å€:<a href="https://github.com/SpringCloud/spring-cloud-gateway-nacos" target="_blank" rel="noopener">https://github.com/SpringCloud/spring-cloud-gateway-nacos</a></p></blockquote><h2 id="3-ç®€å•åŠ¨æ€è·¯ç”±çš„å®ç°"><a href="#3-ç®€å•åŠ¨æ€è·¯ç”±çš„å®ç°" class="headerlink" title="3. ç®€å•åŠ¨æ€è·¯ç”±çš„å®ç°"></a>3. ç®€å•åŠ¨æ€è·¯ç”±çš„å®ç°</h2><h3 id="3-1-æ–°å»ºMavenå·¥ç¨‹sc-gateway-server"><a href="#3-1-æ–°å»ºMavenå·¥ç¨‹sc-gateway-server" class="headerlink" title="3.1 æ–°å»ºMavenå·¥ç¨‹sc-gateway-server"></a>3.1 æ–°å»ºMavenå·¥ç¨‹sc-gateway-server</h3><p>  é…ç½®ä¸»è¦çš„æ ¸å¿ƒä¾èµ–å¦‚ä»£ç æ¸…å•æ‰€ç¤ºï¼š<br>  ä»£ç æ¸…å•: spring-cloud-gateway-nacos/sc-gateway-server/pom.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.nacos<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nacos-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>0.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="3-2-æ ¹æ®Spring-Cloud-Gatewayçš„è·¯ç”±æ¨¡å‹å®šä¹‰æ•°æ®ä¼ è¾“æ¨¡å‹"><a href="#3-2-æ ¹æ®Spring-Cloud-Gatewayçš„è·¯ç”±æ¨¡å‹å®šä¹‰æ•°æ®ä¼ è¾“æ¨¡å‹" class="headerlink" title="3.2 æ ¹æ®Spring Cloud Gatewayçš„è·¯ç”±æ¨¡å‹å®šä¹‰æ•°æ®ä¼ è¾“æ¨¡å‹"></a>3.2 æ ¹æ®Spring Cloud Gatewayçš„è·¯ç”±æ¨¡å‹å®šä¹‰æ•°æ®ä¼ è¾“æ¨¡å‹</h3><p> åˆ†åˆ«åˆ›å»ºGatewayRouteDefinition.java, GatewayPredicateDefinition.java, GatewayFilterDefinition.javaè¿™ä¸‰ä¸ªç±»ã€‚<br>(1) åˆ›å»ºè·¯ç”±å®šä¹‰æ¨¡å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayRouteDefinition</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è·¯ç”±çš„Id</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="comment">//è·¯ç”±æ–­è¨€é›†åˆé…ç½®</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;GatewayPredicateDefinition&gt; predicates = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">//è·¯ç”±è¿‡æ»¤å™¨é›†åˆé…ç½®</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;GatewayFilterDefinition&gt; filters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">//è·¯ç”±è§„åˆ™è½¬å‘çš„ç›®æ ‡uri</span></span><br><span class="line">    <span class="keyword">private</span> String uri;</span><br><span class="line">    <span class="comment">//è·¯ç”±æ‰§è¡Œçš„é¡ºåº</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> order = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//æ­¤å¤„çœç•¥getå’Œsetæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(2)åˆ›å»ºè¿‡æ»¤å™¨å®šä¹‰æ¨¡å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayFilterDefinition</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Filter Name</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">//å¯¹åº”çš„è·¯ç”±è§„åˆ™</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; args = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">//æ­¤å¤„çœç•¥Getå’ŒSetæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(3)åˆ›å»ºè·¯ç”±æ–­è¨€å®šä¹‰æ¨¡å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayPredicateDefinition</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ–­è¨€å¯¹åº”çš„Name</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">//é…ç½®çš„æ–­è¨€è§„åˆ™</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; args = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">//æ­¤å¤„çœç•¥Getå’ŒSetæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-ç¼–å†™åŠ¨æ€è·¯ç”±å®ç°ç±»"><a href="#3-3-ç¼–å†™åŠ¨æ€è·¯ç”±å®ç°ç±»" class="headerlink" title="3.3 ç¼–å†™åŠ¨æ€è·¯ç”±å®ç°ç±»"></a>3.3 ç¼–å†™åŠ¨æ€è·¯ç”±å®ç°ç±»</h3><p>ç¼–å†™DynamicRouteServiceImplå¹¶å®ç°ApplicationEventPublisherAwareæ¥å£ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicRouteServiceImpl</span> <span class="keyword">implements</span> <span class="title">ApplicationEventPublisherAware</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RouteDefinitionWriter routeDefinitionWriter;</span><br><span class="line">    <span class="keyword">private</span> ApplicationEventPublisher publisher;</span><br><span class="line">    <span class="comment">//å¢åŠ è·¯ç”±</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(RouteDefinition definition)</span> </span>&#123;</span><br><span class="line">        routeDefinitionWriter.save(Mono.just(definition)).subscribe();</span><br><span class="line">        <span class="keyword">this</span>.publisher.publishEvent(<span class="keyword">new</span> RefreshRoutesEvent(<span class="keyword">this</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ›´æ–°è·¯ç”±</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(RouteDefinition definition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.routeDefinitionWriter.delete(Mono.just(definition.getId()));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"update fail,not find route  routeId: "</span>+definition.getId();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            routeDefinitionWriter.save(Mono.just(definition)).subscribe();</span><br><span class="line">            <span class="keyword">this</span>.publisher.publishEvent(<span class="keyword">new</span> RefreshRoutesEvent(<span class="keyword">this</span>));</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"update route  fail"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ é™¤è·¯ç”±</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ResponseEntity&lt;Object&gt;&gt; delete(String id) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.routeDefinitionWriter.delete(Mono.just(id))</span><br><span class="line">                .then(Mono.defer(() -&gt; Mono.just(ResponseEntity.ok().build())))</span><br><span class="line">                .onErrorResume(t -&gt; t <span class="keyword">instanceof</span> NotFoundException, t -&gt; Mono.just(ResponseEntity.notFound().build()));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationEventPublisher</span><span class="params">(ApplicationEventPublisher applicationEventPublisher)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.publisher = applicationEventPublisher;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4-ç¼–å†™Nacosç›‘å¬æ¥æ”¶ä¸‹å‘çš„è·¯ç”±é…ç½®"><a href="#3-4-ç¼–å†™Nacosç›‘å¬æ¥æ”¶ä¸‹å‘çš„è·¯ç”±é…ç½®" class="headerlink" title="3.4 ç¼–å†™Nacosç›‘å¬æ¥æ”¶ä¸‹å‘çš„è·¯ç”±é…ç½®"></a>3.4 ç¼–å†™Nacosç›‘å¬æ¥æ”¶ä¸‹å‘çš„è·¯ç”±é…ç½®</h3><h3 id="3-4-1-ä½¿ç”¨Nacosç›‘å¬ä¸‹å‘çš„é…ç½®"><a href="#3-4-1-ä½¿ç”¨Nacosç›‘å¬ä¸‹å‘çš„é…ç½®" class="headerlink" title="3.4.1 ä½¿ç”¨Nacosç›‘å¬ä¸‹å‘çš„é…ç½®"></a>3.4.1 ä½¿ç”¨Nacosç›‘å¬ä¸‹å‘çš„é…ç½®</h3><p>ç›‘å¬Nacos Config Serverä¸‹å‘é…ç½®çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicRouteServiceImplByNacos</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DynamicRouteServiceImpl dynamicRouteService;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DynamicRouteServiceImplByNacos</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        dynamicRouteByNacosListener(<span class="string">"sc-gateway"</span>,<span class="string">"xujin_test"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç›‘å¬Nacos Serverä¸‹å‘çš„åŠ¨æ€è·¯ç”±é…ç½®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> group</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dynamicRouteByNacosListener</span> <span class="params">(String dataId, String group)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ConfigService configService=NacosFactory.createConfigService(<span class="string">"127.0.0.1:8848"</span>);</span><br><span class="line">            String content = configService.getConfig(dataId, group, <span class="number">5000</span>);</span><br><span class="line">            System.out.println(content);</span><br><span class="line">            configService.addListener(dataId, group, <span class="keyword">new</span> Listener()  &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveConfigInfo</span><span class="params">(String configInfo)</span> </span>&#123;</span><br><span class="line">                    RouteDefinition definition= JSON.parseObject(configInfo,RouteDefinition.class);</span><br><span class="line">                    dynamicRouteService.update(definition);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> Executor <span class="title">getExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NacosException e) &#123;</span><br><span class="line">            <span class="comment">//todo æé†’:å¼‚å¸¸è‡ªè¡Œå¤„ç†æ­¤å¤„çœç•¥</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-4-2-ä¸¤ç§æ–¹å¼åˆ›å»ºConfigService"><a href="#3-4-2-ä¸¤ç§æ–¹å¼åˆ›å»ºConfigService" class="headerlink" title="3.4.2 ä¸¤ç§æ–¹å¼åˆ›å»ºConfigService"></a>3.4.2 ä¸¤ç§æ–¹å¼åˆ›å»ºConfigService</h4><p>ä½¿ç”¨ä¸¤ç§æ–¹å¼åˆ›å»ºcom.alibaba.nacos.api.config.ConfigService</p><ul><li>1.æ„å»ºPropertiesåˆ›å»º</li></ul><p>ä½¿ç”¨createConfigService(Properties properties)ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤º:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">            properties.put(<span class="string">"nacos.server-addr"</span>, <span class="string">""</span>);</span><br><span class="line">            properties.put(PropertyKeyConst.SERVER_ADDR, <span class="string">"127.0.0.1:8848"</span>);</span><br><span class="line">            ConfigService configService=NacosFactory.createConfigService(properties);</span><br></pre></td></tr></table></figure></p><blockquote><p>æ³¨æ„:PropertyKeyConstæ˜¯com.alibaba.nacos.api.PropertyKeyConst</p></blockquote><ul><li>2.åªä¼ é€’Nacos Config Serverçš„åœ°å€</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ConfigService configService=NacosFactory.createConfigService(<span class="string">"127.0.0.1:8848"</span>);</span><br></pre></td></tr></table></figure><h2 id="4-ä½¿ç”¨Nacosä¸‹å‘é…ç½®"><a href="#4-ä½¿ç”¨Nacosä¸‹å‘é…ç½®" class="headerlink" title="4. ä½¿ç”¨Nacosä¸‹å‘é…ç½®"></a>4. ä½¿ç”¨Nacosä¸‹å‘é…ç½®</h2><h3 id="4-1-Nacosæ¦‚è¿°"><a href="#4-1-Nacosæ¦‚è¿°" class="headerlink" title="4.1 Nacosæ¦‚è¿°"></a>4.1 Nacosæ¦‚è¿°</h3><p>   Naocsç”±é˜¿é‡Œå¼€æºï¼ŒNacos è‡´åŠ›äºå¸®åŠ©æ‚¨å‘ç°ã€é…ç½®å’Œç®¡ç†å¾®æœåŠ¡ã€‚Nacos æä¾›äº†ä¸€ç»„ç®€å•æ˜“ç”¨çš„ç‰¹æ€§é›†ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿå®ç°åŠ¨æ€æœåŠ¡å‘ç°ã€æœåŠ¡é…ç½®ã€æœåŠ¡å…ƒæ•°æ®åŠæµé‡ç®¡ç†ã€‚<br>   Nacos å¸®åŠ©æ‚¨æ›´æ•æ·å’Œå®¹æ˜“åœ°æ„å»ºã€äº¤ä»˜å’Œç®¡ç†å¾®æœåŠ¡å¹³å°ã€‚ Nacos æ˜¯æ„å»ºä»¥â€œæœåŠ¡â€ä¸ºä¸­å¿ƒçš„ç°ä»£åº”ç”¨æ¶æ„ (ä¾‹å¦‚å¾®æœåŠ¡èŒƒå¼ã€äº‘åŸç”ŸèŒƒå¼) çš„æœåŠ¡åŸºç¡€è®¾æ–½ã€‚githubåœ°å€:<a href="https://github.com/alibaba/nacos" target="_blank" rel="noopener">https://github.com/alibaba/nacos</a></p><blockquote><p>æ›´å¤šNacosçš„ä»‹ç»ï¼Œè¯·è®¿é—®å®˜æ–¹ç½‘ç«™:<a href="https://nacos.io/" target="_blank" rel="noopener">https://nacos.io/</a></p></blockquote><h3 id="4-2-åœ¨IDEä¸­å¯åŠ¨-Nacos"><a href="#4-2-åœ¨IDEä¸­å¯åŠ¨-Nacos" class="headerlink" title="4.2 åœ¨IDEä¸­å¯åŠ¨ Nacos"></a>4.2 åœ¨IDEä¸­å¯åŠ¨ Nacos</h3><p>è®¿é—®<a href="https://github.com/alibaba/nacos" target="_blank" rel="noopener">https://github.com/alibaba/nacos</a> ,ä½¿ç”¨Gitå…‹éš†Nacosä»£ç ï¼Œç›´æ¥å¯¼å…¥åˆ°IDEAä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºè®¾ç½®å¯åŠ¨å‚æ•°ï¼Œç›´æ¥å¯åŠ¨ã€‚</p><p><img src="/images/mw/nacos/nacos0.jpg" alt=""></p><blockquote><p>ä»IDEä¸­å¯åŠ¨Nacosæ˜¯æˆ‘æ¯”è¾ƒæ¨èçš„æ–¹å¼ï¼Œå› ä¸ºå¯ä»¥éšæ—¶Debug Nacosä»»ä½•ä»£ç ï¼Œå…¶å®ƒå¯åŠ¨æ–¹å¼è¯·å‚è€ƒå®˜ç½‘ã€‚</p></blockquote><h2 id="5-æµ‹è¯•"><a href="#5-æµ‹è¯•" class="headerlink" title="5.æµ‹è¯•"></a>5.æµ‹è¯•</h2><h3 id="5-1-Nacosä¸­ä¸‹å‘Spring-Cloud-Gatewayçš„è·¯ç”±é…ç½®"><a href="#5-1-Nacosä¸­ä¸‹å‘Spring-Cloud-Gatewayçš„è·¯ç”±é…ç½®" class="headerlink" title="5.1  Nacosä¸­ä¸‹å‘Spring Cloud Gatewayçš„è·¯ç”±é…ç½®"></a>5.1  Nacosä¸­ä¸‹å‘Spring Cloud Gatewayçš„è·¯ç”±é…ç½®</h3><ul><li>1.æ‰“å¼€æµè§ˆå™¨è®¿é—®URL:<a href="http://localhost:8848/nacos/index.html" target="_blank" rel="noopener">http://localhost:8848/nacos/index.html</a> ,Nacosçš„ç®¡æ§å¹³å°å¦‚ä¸‹æ‰€ç¤º:</li></ul><p><img src="/images/mw/nacos/nacos1.jpg" alt=""></p><ul><li>2.åœ¨Nacosçš„é…ç½®åˆ—è¡¨ç‚¹å‡»<code>+</code>æŒ‰é’®ï¼Œä¸‹å‘Spring Cloud Gatewayçš„è·¯ç”±é…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤º:</li></ul><p><img src="/images/mw/nacos/nacos2.jpg" alt=""></p><hr><p>ç”¨äºæµ‹è¯•çš„ç¤ºä¾‹æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"filters"</span>: [],</span><br><span class="line"><span class="attr">"id"</span>: <span class="string">"jd_route"</span>,</span><br><span class="line"><span class="attr">"order"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="attr">"predicates"</span>: [&#123;</span><br><span class="line"><span class="attr">"args"</span>: &#123;</span><br><span class="line"><span class="attr">"pattern"</span>: <span class="string">"/jd"</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">"name"</span>: <span class="string">"Path"</span></span><br><span class="line">&#125;],</span><br><span class="line"><span class="attr">"uri"</span>: <span class="string">"http://www.jd.com"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/mw/nacos/nacos3.jpg" alt=""><br><img src="/images/mw/nacos/nacos4.jpg" alt=""></p><h3 id="5-2-å¯åŠ¨sc-gateway-server"><a href="#5-2-å¯åŠ¨sc-gateway-server" class="headerlink" title="5.2 å¯åŠ¨sc-gateway-server"></a>5.2 å¯åŠ¨sc-gateway-server</h3><ul><li>1.Debugå¯åŠ¨sc-gateway-server,è°ƒè¯•æˆªå›¾å¦‚ä¸‹æ‰€ç¤º:</li></ul><p><img src="/images/mw/nacos/nacos5.jpg" alt=""></p><ul><li>2.é€šè¿‡Spring Cloud gatewayçš„ç«¯ç‚¹ï¼ŒæŸ¥çœ‹è·¯ç”±ä¿¡æ¯</li></ul><p><img src="/images/mw/nacos/nacos6.jpg" alt=""></p><ul><li>3.é€šè¿‡è®¿é—®<a href="http://localhost:8080/jd" target="_blank" rel="noopener">http://localhost:8080/jd</a> ,å¯ä»¥è½¬å‘åˆ°äº¬ä¸œå•†åŸä¸»é¡µ</li></ul><h3 id="5-3-æ›´æ–°è·¯ç”±é…ç½®"><a href="#5-3-æ›´æ–°è·¯ç”±é…ç½®" class="headerlink" title="5.3 æ›´æ–°è·¯ç”±é…ç½®"></a>5.3 æ›´æ–°è·¯ç”±é…ç½®</h3><ul><li>1.é€šè¿‡Nacosä¸‹å‘é…ç½®ï¼Œä¿®æ”¹Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±è§„åˆ™</li></ul><p><img src="/images/mw/nacos/nacos7.jpg" alt=""></p><ul><li>2.æŸ¥çœ‹è®¿é—®Spring Cloud gatewayçš„ç«¯ç‚¹é…ç½®ï¼Œå¯ä»¥çœ‹åˆ°åŠ¨æ€è·¯ç”±ä¿®æ”¹å¦‚ä¸‹:</li></ul><p><img src="/images/mw/nacos/nacos8.jpg" alt=""></p><ul><li>3.é€šè¿‡è®¿é—®<a href="http://localhost:8080/jd" target="_blank" rel="noopener">http://localhost:8080/jd</a> ,å¯ä»¥è½¬å‘åˆ°ç™¾åº¦ç›¸å…³é¡µé¢</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬æ–‡ä¸»è¦ä»‹ç»é€šè¿‡Nacosä¸‹å‘è·¯ç”±é…ç½®å®ç°Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±ã€‚&lt;/p&gt;
&lt;h2 id=&quot;1-å‰è¨€&quot;&gt;&lt;a href=&quot;#1-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;1.å‰è¨€&quot;&gt;&lt;/a&gt;1.å‰è¨€&lt;/h2&gt;&lt;p&gt;   ç½‘å…³ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œé‚£å°±æ˜¯è·¯ç”±é…ç½®å’Œè·¯ç”±è§„åˆ™ï¼Œè·¯ç”±é…ç½®æ˜¯æŒ‡é…ç½®æŸè¯·æ±‚è·¯å¾„è·¯ç”±åˆ°æŒ‡å®šçš„ç›®çš„åœ°å€ã€‚è€Œè·¯ç”±è§„åˆ™æ˜¯æŒ‡åŒ¹é…åˆ°è·¯ç”±é…ç½®ä¹‹åï¼Œå†æ ¹æ®è·¯ç”±è§„åˆ™è¿›è¡Œè½¬å‘å¤„ç†ã€‚&lt;br&gt;   Spring Cloud Gatewayä½œä¸ºæ‰€æœ‰è¯·æ±‚æµé‡çš„å…¥å£ï¼Œåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¸ºäº†ä¿è¯é«˜å¯é å’Œé«˜å¯ç”¨ï¼Œå°½é‡é¿å…é‡å¯,éœ€è¦å®ç°Spring Cloud GatewayåŠ¨æ€è·¯ç”±é…ç½®ã€‚å‰é¢ç« èŠ‚ä»‹ç»äº†Spring Cloud Gatewayæä¾›çš„ä¸¤ç§æ–¹æ³•å»é…ç½®è·¯ç”±è§„åˆ™ï¼Œä½†éƒ½æ˜¯åœ¨Spring Cloud Gatewayå¯åŠ¨æ—¶å€™ï¼Œå°±å°†è·¯ç”±é…ç½®å’Œè§„åˆ™åŠ è½½åˆ°å†…å­˜é‡Œï¼Œæ— æ³•åšåˆ°ä¸é‡å¯ç½‘å…³å°±å¯ä»¥åŠ¨æ€çš„å¯¹åº”è·¯ç”±çš„é…ç½®å’Œè§„åˆ™è¿›è¡Œå¢åŠ ï¼Œä¿®æ”¹å’Œåˆ é™¤ã€‚æœ¬æ–‡æ˜¯åŸºäº&lt;a href=&quot;http://xujin.org/sc/gw/gw09/&quot;&gt;Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±å®ç°&lt;/a&gt;&lt;br&gt;åŸºç¡€ä¹‹ä¸Šç¼–å†™ï¼Œé€šè¿‡Nacosé…ç½®æœåŠ¡ä¸‹å‘è·¯ç”±é…ç½®å®ç°åŠ¨æ€è·¯ç”±ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/categories/Spring-Cloud-Gateway/"/>
    
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/tags/Spring-Cloud-Gateway/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±å®ç°</title>
    <link href="http://xujin.org/sc/gw/gw09/"/>
    <id>http://xujin.org/sc/gw/gw09/</id>
    <published>2018-11-03T06:00:00.000Z</published>
    <updated>2019-01-12T03:33:39.419Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬æ–‡ä¸»è¦ä»‹ç»äº†Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±çš„ç®€å•å®ç°æ–¹å¼ã€‚</p><h2 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1.å‰è¨€"></a>1.å‰è¨€</h2><p>   ç½‘å…³ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œé‚£å°±æ˜¯è·¯ç”±é…ç½®å’Œè·¯ç”±è§„åˆ™ï¼Œè·¯ç”±é…ç½®æ˜¯æŒ‡é…ç½®æŸè¯·æ±‚è·¯å¾„è·¯ç”±åˆ°æŒ‡å®šçš„ç›®çš„åœ°å€ã€‚è€Œè·¯ç”±è§„åˆ™æ˜¯æŒ‡åŒ¹é…åˆ°è·¯ç”±é…ç½®ä¹‹åï¼Œå†æ ¹æ®è·¯ç”±è§„åˆ™è¿›è¡Œè½¬å‘å¤„ç†ã€‚<br>   Spring Cloud Gatewayä½œä¸ºæ‰€æœ‰è¯·æ±‚æµé‡çš„å…¥å£ï¼Œåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¸ºäº†ä¿è¯é«˜å¯é å’Œé«˜å¯ç”¨ï¼Œå°½é‡é¿å…é‡å¯,éœ€è¦å®ç°Spring Cloud GatewayåŠ¨æ€è·¯ç”±é…ç½®ã€‚å‰é¢ç« èŠ‚ä»‹ç»äº†Spring Cloud Gatewayæä¾›çš„ä¸¤ç§æ–¹æ³•å»é…ç½®è·¯ç”±è§„åˆ™ï¼Œä½†éƒ½æ˜¯åœ¨Spring Cloud Gatewayå¯åŠ¨æ—¶å€™ï¼Œå°±å°†è·¯ç”±é…ç½®å’Œè§„åˆ™åŠ è½½åˆ°å†…å­˜é‡Œï¼Œæ— æ³•åšåˆ°ä¸é‡å¯ç½‘å…³å°±å¯ä»¥åŠ¨æ€çš„å¯¹åº”è·¯ç”±çš„é…ç½®å’Œè§„åˆ™è¿›è¡Œå¢åŠ ï¼Œä¿®æ”¹å’Œåˆ é™¤ã€‚<code>æœ¬ç¯‡æ–‡ç« ç®€å•ä»‹ç»å¦‚ä½•å®ç°Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±ã€‚</code><br><a id="more"></a></p><h2 id="2-Spring-Cloud-Gatewayç®€å•çš„åŠ¨æ€è·¯ç”±å®ç°"><a href="#2-Spring-Cloud-Gatewayç®€å•çš„åŠ¨æ€è·¯ç”±å®ç°" class="headerlink" title="2. Spring Cloud Gatewayç®€å•çš„åŠ¨æ€è·¯ç”±å®ç°"></a>2. Spring Cloud Gatewayç®€å•çš„åŠ¨æ€è·¯ç”±å®ç°</h2><p>Spring Cloud Gatewayçš„å®˜æ–¹æ–‡æ¡£å¹¶æ²¡æœ‰è®²å¦‚ä½•åŠ¨æ€é…ç½®ï¼ŒæŸ¥çœ‹ Spring Cloud Gatewayçš„æºç ï¼Œå‘ç°<code>åœ¨org.springframework.cloud.gateway.actuate.GatewayControllerEndpoint</code>ç±»ä¸­æä¾›äº†åŠ¨æ€é…ç½®çš„Restæ¥å£ï¼Œä½†æ˜¯<code>éœ€è¦å¼€å¯Gatewayçš„ç«¯ç‚¹</code>ï¼Œè€Œä¸”æä¾›çš„åŠŸèƒ½ä¸æ˜¯å¾ˆå¼ºå¤§ã€‚é€šè¿‡å‚è€ƒå’ŒGatewayControllerEndpointç›¸å…³çš„ä»£ç ï¼Œå¯ä»¥è‡ªå·±ç¼–ç å®é™…åŠ¨æ€è·¯ç”±é…ç½®ã€‚<br>ä¸‹é¢é€šè¿‡æ¡ˆä¾‹çš„æ–¹å¼å»è®²è§£æ€ä¹ˆå®ç°Gatewayçš„åŠ¨æ€è·¯ç”±é…ç½®ã€‚æ¡ˆä¾‹å·¥ç¨‹å¦‚ch18-7-gatewayæ‰€ç¤ºã€‚</p><blockquote><p>ä»£ç åœ°å€:<a href="https://github.com/SpringCloud/spring-cloud-code/blob/master/ch18-7/ch18-7-gateway" target="_blank" rel="noopener">https://github.com/SpringCloud/spring-cloud-code/blob/master/ch18-7/ch18-7-gateway</a></p></blockquote><h2 id="3-ç®€å•åŠ¨æ€è·¯ç”±çš„å®ç°"><a href="#3-ç®€å•åŠ¨æ€è·¯ç”±çš„å®ç°" class="headerlink" title="3. ç®€å•åŠ¨æ€è·¯ç”±çš„å®ç°"></a>3. ç®€å•åŠ¨æ€è·¯ç”±çš„å®ç°</h2><h3 id="3-1-æ–°å»ºMavenå·¥ç¨‹ch18-7-gateway"><a href="#3-1-æ–°å»ºMavenå·¥ç¨‹ch18-7-gateway" class="headerlink" title="3.1 æ–°å»ºMavenå·¥ç¨‹ch18-7-gateway"></a>3.1 æ–°å»ºMavenå·¥ç¨‹ch18-7-gateway</h3><p>  é…ç½®ä¸»è¦çš„æ ¸å¿ƒä¾èµ–å¦‚ä»£ç æ¸…å•18-33æ‰€ç¤ºï¼š<br>  ä»£ç æ¸…å•: ch18-7/ch18-7-gateway/pom.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="3-2-æ ¹æ®Spring-Cloud-Gatewayçš„è·¯ç”±æ¨¡å‹å®šä¹‰æ•°æ®ä¼ è¾“æ¨¡å‹"><a href="#3-2-æ ¹æ®Spring-Cloud-Gatewayçš„è·¯ç”±æ¨¡å‹å®šä¹‰æ•°æ®ä¼ è¾“æ¨¡å‹" class="headerlink" title="3.2 æ ¹æ®Spring Cloud Gatewayçš„è·¯ç”±æ¨¡å‹å®šä¹‰æ•°æ®ä¼ è¾“æ¨¡å‹"></a>3.2 æ ¹æ®Spring Cloud Gatewayçš„è·¯ç”±æ¨¡å‹å®šä¹‰æ•°æ®ä¼ è¾“æ¨¡å‹</h3><p> åˆ†åˆ«åˆ›å»ºGatewayRouteDefinition.java, GatewayPredicateDefinition.java, GatewayFilterDefinition.javaè¿™ä¸‰ä¸ªç±»ã€‚<br>(1) <code>åˆ›å»ºè·¯ç”±å®šä¹‰æ¨¡å‹</code>å¦‚ä¸‹ä»£ç æ¸…å•18-34æ‰€ç¤ºï¼š<br>ä»£ç æ¸…å• 18-34: ch18-7/ch18-7-gateway/src/main/java/cn/springcloud/book/gateway/model/GatewayRouteDefinition.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayRouteDefinition</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è·¯ç”±çš„Id</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="comment">//è·¯ç”±æ–­è¨€é›†åˆé…ç½®</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;GatewayPredicateDefinition&gt; predicates = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">//è·¯ç”±è¿‡æ»¤å™¨é›†åˆé…ç½®</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;GatewayFilterDefinition&gt; filters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">//è·¯ç”±è§„åˆ™è½¬å‘çš„ç›®æ ‡uri</span></span><br><span class="line">    <span class="keyword">private</span> String uri;</span><br><span class="line">    <span class="comment">//è·¯ç”±æ‰§è¡Œçš„é¡ºåº</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> order = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//æ­¤å¤„çœç•¥getå’Œsetæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(2)<code>åˆ›å»ºè¿‡æ»¤å™¨å®šä¹‰æ¨¡å‹</code>,ä»£ç å¦‚ä»£ç æ¸…å•18-35æ‰€ç¤ºï¼š<br>ä»£ç æ¸…å•18-35: ch18-7/ch18-7-gateway/src/main/java/cn/springcloud/book/gateway/model/GatewayFilterDefinition.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayFilterDefinition</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Filter Name</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">//å¯¹åº”çš„è·¯ç”±è§„åˆ™</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; args = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">//æ­¤å¤„çœç•¥Getå’ŒSetæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(3)<code>è·¯ç”±æ–­è¨€å®šä¹‰æ¨¡å‹</code>ï¼Œä»£ç å¦‚ä»£ç æ¸…å•18-36æ‰€ç¤º:<br>ä»£ç æ¸…å•18-36: ch18-7/ch18-7-gateway/src/main/java/cn/springcloud/book/gateway/model/GatewayPredicateDefinition.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayPredicateDefinition</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ–­è¨€å¯¹åº”çš„Name</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">//é…ç½®çš„æ–­è¨€è§„åˆ™</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; args = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">//æ­¤å¤„çœç•¥Getå’ŒSetæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-ç¼–å†™åŠ¨æ€è·¯ç”±å®ç°ç±»"><a href="#3-3-ç¼–å†™åŠ¨æ€è·¯ç”±å®ç°ç±»" class="headerlink" title="3.3 ç¼–å†™åŠ¨æ€è·¯ç”±å®ç°ç±»"></a>3.3 ç¼–å†™åŠ¨æ€è·¯ç”±å®ç°ç±»</h3><p>ç¼–å†™DynamicRouteServiceImplå¹¶å®ç°ApplicationEventPublisherAwareæ¥å£ï¼Œä»£ç å¦‚ä»£ç æ¸…å•18-37æ‰€ç¤º: ch18-37/ch18-7-gateway/src/main/java/cn/springcloud/book/gateway/route/DynamicRouteServiceImpl.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicRouteServiceImpl</span> <span class="keyword">implements</span> <span class="title">ApplicationEventPublisherAware</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RouteDefinitionWriter routeDefinitionWriter;</span><br><span class="line">    <span class="keyword">private</span> ApplicationEventPublisher publisher;</span><br><span class="line">    <span class="comment">//å¢åŠ è·¯ç”±</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(RouteDefinition definition)</span> </span>&#123;</span><br><span class="line">        routeDefinitionWriter.save(Mono.just(definition)).subscribe();</span><br><span class="line">        <span class="keyword">this</span>.publisher.publishEvent(<span class="keyword">new</span> RefreshRoutesEvent(<span class="keyword">this</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ›´æ–°è·¯ç”±</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(RouteDefinition definition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.routeDefinitionWriter.delete(Mono.just(definition.getId()));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"update fail,not find route  routeId: "</span>+definition.getId();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            routeDefinitionWriter.save(Mono.just(definition)).subscribe();</span><br><span class="line">            <span class="keyword">this</span>.publisher.publishEvent(<span class="keyword">new</span> RefreshRoutesEvent(<span class="keyword">this</span>));</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"update route  fail"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ é™¤è·¯ç”±</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ResponseEntity&lt;Object&gt;&gt; delete(String id) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.routeDefinitionWriter.delete(Mono.just(id))</span><br><span class="line">                .then(Mono.defer(() -&gt; Mono.just(ResponseEntity.ok().build())))</span><br><span class="line">                .onErrorResume(t -&gt; t <span class="keyword">instanceof</span> NotFoundException, t -&gt; Mono.just(ResponseEntity.notFound().build()));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationEventPublisher</span><span class="params">(ApplicationEventPublisher applicationEventPublisher)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.publisher = applicationEventPublisher;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4-ç¼–å†™Restæ¥å£"><a href="#3-4-ç¼–å†™Restæ¥å£" class="headerlink" title="3.4 ç¼–å†™Restæ¥å£"></a>3.4 ç¼–å†™Restæ¥å£</h3><p>ç¼–å†™RouteControllerç±»çš„æä¾›Restæ¥å£ï¼Œç”¨äºåŠ¨æ€è·¯ç”±é…ç½®ã€‚ä»£ç å¦‚ä»£ç æ¸…å•18-38æ‰€ç¤º:<br>ä»£ç æ¸…å• 18-38: ch18-7/ch18-7-gateway/src/main/java/cn/springcloud/book/gateway/controller/RouteController.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/route"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RouteController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DynamicRouteServiceImpl dynamicRouteService;</span><br><span class="line">    <span class="comment">//å¢åŠ è·¯ç”±</span></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/add"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(@RequestBody GatewayRouteDefinition gwdefinition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            RouteDefinition definition = assembleRouteDefinition(gwdefinition);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.dynamicRouteService.add(definition);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"succss"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//åˆ é™¤è·¯ç”±</span></span><br><span class="line">    <span class="meta">@DeleteMapping</span>(<span class="string">"/routes/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ResponseEntity&lt;Object&gt;&gt; delete(<span class="meta">@PathVariable</span> String id) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.dynamicRouteService.delete(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ›´æ–°è·¯ç”±</span></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/update"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(@RequestBody GatewayRouteDefinition gwdefinition)</span> </span>&#123;</span><br><span class="line">        RouteDefinition definition = assembleRouteDefinition(gwdefinition);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.dynamicRouteService.update(definition);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-5-é…ç½®application-ymlæ–‡ä»¶"><a href="#3-5-é…ç½®application-ymlæ–‡ä»¶" class="headerlink" title="3.5 é…ç½®application.ymlæ–‡ä»¶"></a>3.5 é…ç½®application.ymlæ–‡ä»¶</h3><p>åœ¨application.ymlæ–‡ä»¶é…ç½®åº”ç”¨çš„é…ç½®ä¿¡æ¯ï¼Œå¹¶å¼€å¯Spring Cloud Gatewayå¯¹å¤–æä¾›çš„ç«¯ç‚¹Restæ¥å£ã€‚ä»£ç å¦‚ä»£ç æ¸…å•18-39æ‰€ç¤º:<br>ä»£ç æ¸…å• 18-39: ch18-7/ch18-7-gateway/src/main/resources/application.yml<br>é…ç½®è¾“å‡ºæ—¥å¿—å¦‚ä¸‹æ‰€ç¤º:<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®è¾“å‡ºæ—¥å¿—</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="attr">  level:</span></span><br><span class="line">    <span class="string">org.springframework.cloud.gateway:</span> <span class="string">TRACE</span></span><br><span class="line">    <span class="string">org.springframework.http.server.reactive:</span> <span class="string">DEBUG</span></span><br><span class="line">    <span class="string">org.springframework.web.reactive:</span> <span class="string">DEBUG</span></span><br><span class="line">    <span class="string">reactor.ipc.netty:</span> <span class="string">DEBUG</span></span><br><span class="line"><span class="comment">#å¼€å¯ç«¯ç‚¹</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line"><span class="attr">  endpoints:</span></span><br><span class="line"><span class="attr">    web:</span></span><br><span class="line"><span class="attr">      exposure:</span></span><br><span class="line"><span class="attr">        include:</span> <span class="string">'*'</span></span><br><span class="line"><span class="attr">  security:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></p><h3 id="3-6-å¯åŠ¨ch18-7-gatewayåº”ç”¨æµ‹è¯•"><a href="#3-6-å¯åŠ¨ch18-7-gatewayåº”ç”¨æµ‹è¯•" class="headerlink" title="3.6 å¯åŠ¨ch18-7-gatewayåº”ç”¨æµ‹è¯•"></a>3.6 å¯åŠ¨ch18-7-gatewayåº”ç”¨æµ‹è¯•</h3><p>(1) å¯åŠ¨ch18-7-gatewayåº”ç”¨ä¹‹åï¼Œç”±äºå¼€å¯äº†ç«¯ç‚¹ï¼Œé¦–å…ˆæ‰“å¼€æµè§ˆå™¨è®¿é—®ç«¯ç‚¹URL:<br><a href="http://localhost:8080/actuator/gateway/routes" target="_blank" rel="noopener">http://localhost:8080/actuator/gateway/routes</a>  ,æŸ¥çœ‹è·¯ç”±ä¿¡æ¯è¿”å›ä¸ºç©ºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="/images/sc-g-route/1.png" alt="ç©ºçš„è·¯ç”±ä¿¡æ¯"></p><p>(2)æ‰“å¼€PostManï¼Œè®¿é—®<a href="http://localhost:8080/route/add" target="_blank" rel="noopener">http://localhost:8080/route/add</a>, å‘èµ·Postè¯·æ±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º,è¿”å›successè¯´æ˜å‘Gatewayå¢åŠ è·¯ç”±é…ç½®æˆåŠŸã€‚<br><img src="/images/sc-g-route/2.png" alt="åŠ¨æ€æ·»åŠ è·¯ç”±æˆåŠŸ"></p><p> ç„¶åå†æ‰“å¼€PostManè®¿é—®ç«¯ç‚¹URL:<a href="http://localhost:8080/actuator/gateway/routes" target="_blank" rel="noopener">http://localhost:8080/actuator/gateway/routes</a> ,<br> æŸ¥çœ‹è·¯ç”±ä¿¡æ¯è¿”å›å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ·»åŠ çš„è·¯ç”±é…ç½®ã€‚<br><img src="/images/sc-g-route/3.png" alt="è·¯ç”±ç«¯ç‚¹è¿”å›ç»“æœ"></p><p>(3) æ‰“å¼€æµè§ˆå™¨è®¿é—®<a href="http://localhost:8080/jd" target="_blank" rel="noopener">http://localhost:8080/jd</a>, å¯ä»¥æ­£å¸¸è½¬å‘<a href="https://www.jd.com/å¯¹åº”çš„äº¬ä¸œå•†åŸé¦–é¡µã€‚" target="_blank" rel="noopener">https://www.jd.com/å¯¹åº”çš„äº¬ä¸œå•†åŸé¦–é¡µã€‚</a><br>(4) é€šè¿‡è®¿é—®<a href="http://localhost:8080/route/update" target="_blank" rel="noopener">http://localhost:8080/route/update</a>, å¯¹idä¸ºjd_routeçš„è·¯ç”±æ›´æ–°é…ç½®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/images/sc-g-route/4.png" alt="æ›´æ–°è·¯ç”±é…ç½®"></p><p> ç„¶åå†è®¿é—®è·¯ç”±ç«¯ç‚¹URL,å‘ç°è·¯ç”±é…ç½®å·²ç»è¢«æ›´æ–°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="/images/sc-g-route/5.png" alt="æŸ¥çœ‹è·¯ç”±ç«¯ç‚¹"></p><p>ç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—®<a href="http://localhost:8080/taobao" target="_blank" rel="noopener">http://localhost:8080/taobao</a> ,å¯ä»¥æˆåŠŸè½¬å‘åˆ°æ·˜å®ç½‘ã€‚<br>(5) é€šè¿‡è®¿é—®http: //localhost:8080/route/delete/jd_route,å…¶ä¸­çš„idä¸ºè·¯ç”±å¯¹åº”çš„idï¼Œåˆ é™¤è·¯ç”±ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="/images/sc-g-route/6.png" alt="åˆ é™¤è·¯ç”±æˆåŠŸ"></p><h2 id="4-Spring-Cloud-Gatewayæ¨èæ–‡ç« "><a href="#4-Spring-Cloud-Gatewayæ¨èæ–‡ç« " class="headerlink" title="4.Spring Cloud Gatewayæ¨èæ–‡ç« "></a>4.Spring Cloud Gatewayæ¨èæ–‡ç« </h2><p><a href="http://xujin.org/sc/gw/gw08/">Spring Cloud Gatewayä¸­çš„æƒé‡è·¯ç”±</a><br><a href="http://xujin.org/sc/gw/gw07/">Spring Cloud Gatewayä¸­çš„GatewayFilterå’ŒGlobalFilter</a><br><a href="http://xujin.org/sc/gw/gw06/">Spring Cloud Gatewayåªæœ‰Preå’ŒPOSTä¸¤ç§ç±»å‹çš„Filter</a><br><a href="http://xujin.org/sc/gw/gw05/">Spring Cloud GatewayåŸºäºæœåŠ¡å‘ç°çš„é»˜è®¤è·¯ç”±è§„åˆ™</a><br><a href="http://xujin.org/sc/gw/gw04/">Spring Cloud Gatewayçš„Beforeè·¯ç”±æ–­è¨€å·¥å‚</a><br><a href="http://xujin.org/sc/gw/gw03/">Spring Cloud Gatewayçš„Afterè·¯ç”±æ–­è¨€å·¥å‚</a><br><a href="http://xujin.org/sc/gw/gw02/">Spring Cloud Gatewayæ­ç§˜ä¹‹å¤„ç†è¯·æ±‚æµç¨‹</a><br><a href="http://xujin.org/sc/gw/gw-01/">Spring Cloud Gatewayå…¥é—¨æ¡ˆä¾‹</a></p><h2 id="5-ã€Šé‡æ–°å®šä¹‰Spring-Cloudå®æˆ˜ã€‹ä¸­çš„Spring-Cloud-Gateway"><a href="#5-ã€Šé‡æ–°å®šä¹‰Spring-Cloudå®æˆ˜ã€‹ä¸­çš„Spring-Cloud-Gateway" class="headerlink" title="5.ã€Šé‡æ–°å®šä¹‰Spring Cloudå®æˆ˜ã€‹ä¸­çš„Spring Cloud Gateway"></a>5.ã€Šé‡æ–°å®šä¹‰Spring Cloudå®æˆ˜ã€‹ä¸­çš„Spring Cloud Gateway</h2><p>ç¬¬17ç« Spring Cloud Gatewayä¸Šç¯‡399<br>17.1 Spring Cloud Gatewayæ¦‚è¿°399<br>17.1.1 ä»€ä¹ˆæ˜¯Spring Cloud Gateway399<br>17.1.2 Spring Cloud Gatewayçš„æ ¸å¿ƒæ¦‚å¿µ399<br>17.2 Spring Cloud Gatewayçš„å·¥ä½œåŸç†400<br>17.3 Spring Cloud Gatewayå…¥é—¨æ¡ˆä¾‹401<br>17.4 Spring Cloud Gatewayçš„è·¯ç”±æ–­è¨€404<br>17.4.1 Afterè·¯ç”±æ–­è¨€å·¥å‚404<br>17.4.2 Beforeè·¯ç”±æ–­è¨€å·¥å‚406<br>17.4.3 Betweenè·¯ç”±æ–­è¨€å·¥å‚406<br>17.4.4 Cookieè·¯ç”±æ–­è¨€å·¥å‚407<br>17.4.5 Headerè·¯ç”±æ–­è¨€å·¥å‚408<br>17.4.6 Hostè·¯ç”±æ–­è¨€å·¥å‚410<br>17.4.7 Methodè·¯ç”±æ–­è¨€å·¥å‚411<br>17.4.8 Queryè·¯ç”±æ–­è¨€å·¥å‚411<br>17.4.9 RemoteAddrè·¯ç”±æ–­è¨€å·¥å‚412<br>17.5 Spring Cloud Gatewayçš„å†…ç½®Filter413<br>17.5.1 AddRequestHeaderè¿‡æ»¤å™¨å·¥å‚413<br>17.5.2 AddRequestParameterè¿‡æ»¤å™¨413<br>17.5.3 RewritePathè¿‡æ»¤å™¨414<br>17.5.4 AddResponseHeaderè¿‡æ»¤å™¨415<br>17.5.5 StripPrefixè¿‡æ»¤å™¨416<br>17.5.6 Retryè¿‡æ»¤å™¨417<br>17.5.7 Hystrixè¿‡æ»¤å™¨418<br>17.6 æœ¬ç« å°ç»“420<br>ç¬¬18ç«  Spring Cloud Gatewayä¸‹ç¯‡421<br>18.1 GatewayåŸºäºæœåŠ¡å‘ç°çš„è·¯ç”±è§„åˆ™421<br>18.1.1 Gatewayçš„æœåŠ¡å‘ç°è·¯ç”±æ¦‚è¿°421<br>18.1.2 æœåŠ¡å‘ç°çš„è·¯ç”±è§„åˆ™æ¡ˆä¾‹422<br>18.2 Gateway Filterå’ŒGlobal Filter425<br>18.2.1 Gateway Filterå’ŒGlobal Filteræ¦‚è¿°425<br>18.2.2 è‡ªå®šä¹‰Gateway Filteræ¡ˆä¾‹425<br>18.2.3 è‡ªå®šä¹‰Global Filteræ¡ˆä¾‹427<br>18.3 Spring Cloud Gatewayå®æˆ˜428<br>18.3.1 Spring Cloud Gatewayæƒé‡è·¯ç”±428<br>18.3.2 Spring Cloud Gatewayä¸­Httpsçš„ä½¿ç”¨æŠ€å·§431<br>18.3.3 Spring Cloud Gatewayé›†æˆSwagger436<br>18.3.4 Spring Cloud Gatewayé™æµ442<br>18.3.5 Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±450<br>18.4 Spring Cloud Gatewayæºç ç¯‡458<br>18.4.1 Spring Cloud Gatewayçš„å¤„ç†æµç¨‹458<br>18.4.2 Gatewayä¸­ServerWebExchangeæ„å»ºåˆ†æ459<br>18.4.3 DispatcherHandleræºç åˆ†æ460<br>18.4.4 RoutePredicateHandlerMappingæºç åˆ†æ461<br>18.4.5 FilteringWebHandleræºç åˆ†æ462<br>18.4.6 æ‰§è¡ŒFilteræºç åˆ†æ463<br>18.5 æœ¬ç« å°ç»“465</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ ch17-1</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-1-1-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-1-2-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-1.iml</span><br><span class="line">â”‚   â””â”€â”€ pom.xml</span><br><span class="line">â”œâ”€â”€ ch17-2</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2-1-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2-2-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2-3-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2-4-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2-5-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2-6-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2-7-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2-8-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2-9-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2-service</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-2.iml</span><br><span class="line">â”‚   â””â”€â”€ pom.xml</span><br><span class="line">â”œâ”€â”€ ch17-3</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-3-1-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-3-2-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-3-3-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-3-4-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-3-5-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-3-6-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-3-7-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-3-service</span><br><span class="line">â”‚   â”œâ”€â”€ ch17-3.iml</span><br><span class="line">â”‚   â””â”€â”€ pom.xml</span><br><span class="line">â”œâ”€â”€ ch18-1</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-1-consumer</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-1-eureka</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-1-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-1-provider</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-1.iml</span><br><span class="line">â”‚   â””â”€â”€ pom.xml</span><br><span class="line">â”œâ”€â”€ ch18-2</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-2-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-2-provider</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-2.iml</span><br><span class="line">â”‚   â”œâ”€â”€ pom.xml</span><br><span class="line">â”‚   â””â”€â”€ reademe.txt</span><br><span class="line">â”œâ”€â”€ ch18-3</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-3-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-3-provider</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-3.iml</span><br><span class="line">â”‚   â””â”€â”€ pom.xml</span><br><span class="line">â”œâ”€â”€ ch18-4</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-4-eureka</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-4-gateway-https</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-4-service-a</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-4-service-b</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-4.iml</span><br><span class="line">â”‚   â”œâ”€â”€ pom.xml</span><br><span class="line">â”‚   â””â”€â”€ reademe.md</span><br><span class="line">â”œâ”€â”€ ch18-5</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-5-eureka</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-5-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-5-service</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-5.iml</span><br><span class="line">â”‚   â””â”€â”€ pom.xml</span><br><span class="line">â”œâ”€â”€ ch18-6</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-6-1-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-6-2-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-6-3-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-6-provider</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-6.iml</span><br><span class="line">â”‚   â””â”€â”€ pom.xml</span><br><span class="line">â”œâ”€â”€ ch18-7</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-7-gateway</span><br><span class="line">â”‚   â”œâ”€â”€ ch18-7.iml</span><br><span class="line">â”‚   â”œâ”€â”€ pom.xml</span><br><span class="line">â”‚   â””â”€â”€ readme.md</span><br></pre></td></tr></table></figure><blockquote><p>Spring Cloud Gatewayæ‰€æœ‰ç¤ºä¾‹ä»£ç åœ°å€:<a href="https://github.com/SpringCloud/spring-cloud-code" target="_blank" rel="noopener">https://github.com/SpringCloud/spring-cloud-code</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬æ–‡ä¸»è¦ä»‹ç»äº†Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±çš„ç®€å•å®ç°æ–¹å¼ã€‚&lt;/p&gt;
&lt;h2 id=&quot;1-å‰è¨€&quot;&gt;&lt;a href=&quot;#1-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;1.å‰è¨€&quot;&gt;&lt;/a&gt;1.å‰è¨€&lt;/h2&gt;&lt;p&gt;   ç½‘å…³ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œé‚£å°±æ˜¯è·¯ç”±é…ç½®å’Œè·¯ç”±è§„åˆ™ï¼Œè·¯ç”±é…ç½®æ˜¯æŒ‡é…ç½®æŸè¯·æ±‚è·¯å¾„è·¯ç”±åˆ°æŒ‡å®šçš„ç›®çš„åœ°å€ã€‚è€Œè·¯ç”±è§„åˆ™æ˜¯æŒ‡åŒ¹é…åˆ°è·¯ç”±é…ç½®ä¹‹åï¼Œå†æ ¹æ®è·¯ç”±è§„åˆ™è¿›è¡Œè½¬å‘å¤„ç†ã€‚&lt;br&gt;   Spring Cloud Gatewayä½œä¸ºæ‰€æœ‰è¯·æ±‚æµé‡çš„å…¥å£ï¼Œåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¸ºäº†ä¿è¯é«˜å¯é å’Œé«˜å¯ç”¨ï¼Œå°½é‡é¿å…é‡å¯,éœ€è¦å®ç°Spring Cloud GatewayåŠ¨æ€è·¯ç”±é…ç½®ã€‚å‰é¢ç« èŠ‚ä»‹ç»äº†Spring Cloud Gatewayæä¾›çš„ä¸¤ç§æ–¹æ³•å»é…ç½®è·¯ç”±è§„åˆ™ï¼Œä½†éƒ½æ˜¯åœ¨Spring Cloud Gatewayå¯åŠ¨æ—¶å€™ï¼Œå°±å°†è·¯ç”±é…ç½®å’Œè§„åˆ™åŠ è½½åˆ°å†…å­˜é‡Œï¼Œæ— æ³•åšåˆ°ä¸é‡å¯ç½‘å…³å°±å¯ä»¥åŠ¨æ€çš„å¯¹åº”è·¯ç”±çš„é…ç½®å’Œè§„åˆ™è¿›è¡Œå¢åŠ ï¼Œä¿®æ”¹å’Œåˆ é™¤ã€‚&lt;code&gt;æœ¬ç¯‡æ–‡ç« ç®€å•ä»‹ç»å¦‚ä½•å®ç°Spring Cloud Gatewayçš„åŠ¨æ€è·¯ç”±ã€‚&lt;/code&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/categories/Spring-Cloud-Gateway/"/>
    
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/tags/Spring-Cloud-Gateway/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šé‡æ–°å®šä¹‰Spring Cloudå®æˆ˜ã€‹</title>
    <link href="http://xujin.org/re/01/"/>
    <id>http://xujin.org/re/01/</id>
    <published>2018-09-24T06:00:00.000Z</published>
    <updated>2019-01-13T05:53:02.653Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦:</strong> ä»Šå¤©æ˜¯2018å¹´9æœˆ24å·ä¸­ç§‹èŠ‚ï¼Œç¥ç¦å¤§å®¶ä¸­ç§‹èŠ‚å¿«ä¹ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»ã€Šé‡æ–°å®šä¹‰Spring Cloudå®æˆ˜ã€‹ã€‚</p><a id="more"></a><h2 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1. å‰è¨€"></a>1. å‰è¨€</h2><p>   éšç€äº’è”ç½‘çš„å¿«é€Ÿæ™®åŠï¼Œäº‘è®¡ç®—è¿‘å¹´æ¥å¾—åˆ°è“¬å‹ƒå‘å±•ï¼Œä¼ä¸šçš„ITç¯å¢ƒå’Œæ¶æ„ä½“ç³»ä¹Ÿé€æ¸å‘ç”Ÿå˜é©ï¼Œå…¶ä¸­æœ€å…¸å‹çš„å°±æ˜¯<code>è¿‡å»çš„å•ä½“åº”ç”¨æ¶æ„å‘å±•ä¸ºå½“ä»Šæµè¡Œçš„å¾®æœåŠ¡æ¶æ„</code>ã€‚å¾®æœåŠ¡æ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œå…¶ä¼˜åŠ¿æ˜¯ä¸ºè½¯ä»¶åº”ç”¨å¼€å‘å¸¦æ¥å¾ˆå¤§çš„ä¾¿åˆ©ï¼Œè®©æ•æ·å¼€å‘å’Œå¤æ‚çš„ä¼ä¸šåº”ç”¨å¿«é€ŸæŒç»­äº¤ä»˜æˆä¸ºå¯èƒ½ã€‚éšç€å¾®æœåŠ¡æ¶æ„çš„æµè¡Œï¼Œå¾ˆå¤šä¼ä¸šçº·çº·ä½¿ç”¨å¾®æœåŠ¡æ¶æ„æ¥æ­å»ºæ–°çš„ç³»ç»Ÿæˆ–è€…å¯¹å†å²ç³»ç»Ÿè¿›è¡Œé‡æ„ï¼Œä½†æ˜¯å¾®æœåŠ¡æ¶æ„çš„å®æ–½å’Œè½åœ°ä¼šé¢ä¸´å¾ˆå¤§çš„æŒ‘æˆ˜ã€‚<code>è™½ç„¶å¾®æœåŠ¡æ¶æ„çš„è§£å†³æ–¹æ¡ˆå¾ˆå¤šï¼Œä½†æ˜¯å¯¹äºå¦‚ä½•çœŸæ­£è½åœ°å¾®æœåŠ¡æ¶æ„ï¼Œç›®å‰è¿˜æ²¡æœ‰å…¬è®¤çš„æŠ€æœ¯æ ‡å‡†å’Œè§„èŒƒ</code>ã€‚å¹¸è¿çš„æ˜¯ï¼Œä¸šç•Œå·²ç»æœ‰ä¸€äº›å¾ˆæœ‰å½±å“åŠ›çš„å¼€æºå¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼Œ<code>æ¯”å¦‚2015å¹´å¹´åˆï¼ŒSpringå›¢é˜Ÿæ¨å‡ºçš„Spring Cloudï¼Œå…¶ç›®æ ‡æ˜¯æˆä¸ºJavaé¢†åŸŸå¾®æœåŠ¡æ¶æ„è½åœ°çš„æ ‡å‡†ã€‚Spring Cloudç»è¿‡é«˜é€Ÿè¿­ä»£å’Œå‘å±•ï¼Œè‡³ä»Šå·²ç»æˆä¸ºJavaé¢†åŸŸè½åœ°å¾®æœåŠ¡æ¶æ„çš„æ¨èè§£å†³æ–¹æ¡ˆï¼Œä¸ºä¼ä¸šITæ¶æ„å˜é©ä¿é©¾æŠ¤èˆª</code>ã€‚</p><p>   Spring Cloudæ˜¯ä¸€ä¸ª<code>ä¼˜è´¨çš„å¼€æºé¡¹ç›®</code>ï¼Œ<code>å®ƒçš„ç¨³å¥å‘å±•ç¦»ä¸å¼€ä¼—å¤šå¼€å‘äººå‘˜çš„å®è·µä¸åé¦ˆï¼Œå¼€å‘äººå‘˜é€šè¿‡ä¸€ä¸ªç¤¾åŒºåŒ–çš„å¹³å°å»äº¤æµå­¦ä¹ ä»è€Œä½¿Spring Cloudé€æ¸å®Œå–„</code>ã€‚Spring Cloudå‘å±•åˆ°2016å¹´ï¼Œå¾—åˆ°å›½å†…è¶Šæ¥è¶Šå¤šçš„äººçš„å…³æ³¨ï¼Œä½†æ˜¯ç›¸åº”çš„å­¦ä¹ äº¤æµå¹³å°å’Œææ–™æ¯”è¾ƒåˆ†æ•£ï¼Œè¿™é˜»ç¢äº†Spring Cloudåœ¨æˆ‘å›½çš„æ™®åŠå’Œå‘å±•ã€‚å› æ­¤Spring Cloudä¸­å›½ç¤¾åŒºåº”è¿è€Œç”Ÿã€‚Spring Cloudä¸­å›½ç¤¾åŒº (<a href="http://springcloud.cn" target="_blank" rel="noopener">http://springcloud.cn</a>) æ˜¯å›½å†…åŸºäºSpring Cloudå¾®æœåŠ¡ä½“ç³»åˆ›å»ºçš„éç›ˆåˆ©æŠ€æœ¯ç¤¾åŒºï¼Œæ˜¯ä¸“ä¸ºSpring Bootæˆ–Spring CloudæŠ€æœ¯äººå‘˜æä¾›åˆ†äº«å’Œäº¤æµæœåŠ¡çš„å¹³å°ï¼Œç›®çš„æ˜¯æ¨åŠ¨Spring Cloudåœ¨ä¸­å›½çš„æ™®åŠå’Œåº”ç”¨ã€‚</p><h2 id="2-èƒŒæ™¯æ¦‚è¿°"><a href="#2-èƒŒæ™¯æ¦‚è¿°" class="headerlink" title="2.èƒŒæ™¯æ¦‚è¿°"></a>2.èƒŒæ™¯æ¦‚è¿°</h2><p>   Spring Cloudä¸­å›½ç¤¾åŒº(<a href="http://springcloud.cn" target="_blank" rel="noopener">http://springcloud.cn</a>) æ˜¯å›½å†…åŸºäºSpring Cloudå¾®æœåŠ¡ä½“ç³»åˆ›å»ºçš„éç›ˆåˆ©æŠ€æœ¯ç¤¾åŒºã€‚è‡ª2016å¹´10æœˆä»½åˆ›å»ºä»¥æ¥ï¼Œåœ¨åŒ—äº¬ï¼Œä¸Šæµ·ï¼Œæ·±åœ³ï¼Œæˆéƒ½ç­‰åœ°ä¸¾åŠäº†å¤šæ¬¡æŠ€æœ¯æ²™é¾™ï¼Œæä¾›æŠ€æœ¯äº¤æµå¹³å°,å¸®åŠ©æ•°ä¸‡å¼€å‘è€…å¿«é€Ÿå­¦ä¹ Spring Cloudå¹¶ç”¨äºç”Ÿäº§ã€‚ä¸ºæ›´å¥½çš„æ¨åŠ¨Spring Cloudåœ¨ä¸­å›½çš„å‘å±•ï¼Œè®©æ›´å¤šçš„å¼€å‘è€…å—ç›Šã€‚ç¤¾åŒºé’ˆå¯¹Spring Cloudåœ¨å›½å†…çš„ä½¿ç”¨æƒ…å†µï¼Œç»“åˆå›½å†…ä¼ä¸šä½¿ç”¨Spring Cloudè½åœ°å¾®æœåŠ¡æ¶æ„é‡åˆ°çš„é—®é¢˜ç»™å‡ºå®æˆ˜è§£å†³æ–¹æ¡ˆï¼Œç‰¹æ¨å‡ºæ­¤ä¹¦ã€‚ã€Šé‡æ–°å®šä¹‰Spring Cloudå®æˆ˜ã€‹å°é¢å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="/images/re/fm.png" width="350px" height="450px"></p><p>   æœ¬ä¹¦åŸºäº<code>Spring Cloudçš„Finchley.RELEASEç‰ˆç¼–å†™</code>ï¼Œç”±7ä½ä½œè€…è‘—ï¼Œ<code>å…±25ç« ï¼Œå…±670é¡µ</code>ï¼Œæˆ‘ä»¬7ä½ä½œè€…å¹¶ä¸æ˜¯Spring Cloudå¾®æœåŠ¡è½åœ°çš„æ¶æ„ä¸“å®¶ï¼Œæˆ‘ä»¬åªæ˜¯Spring Cloudå¾®æœåŠ¡æ¶æ„çš„å®è·µè€…ï¼ŒæŠŠæˆ‘ä»¬è‡ªå·±çš„å®è·µç»éªŒåˆ†äº«ç»™å¤§å®¶ï¼Œå¸®åŠ©å¤§å®¶è§£å†³å­¦ä¹ å’Œå·¥ä½œä¸Šé‡åˆ°çš„é—®é¢˜ã€‚<code>ä¸‰äººè¡Œï¼Œå¿…æœ‰æˆ‘å¸ˆç„‰ï¼Œç”±äºæˆ‘ä»¬å­¦è¯†æœ‰é™ï¼Œéš¾å…ä¼šæœ‰ä¸è¶³ä¹‹å¤„ï¼Œè¿˜è¯·è¯»è€…å¤šå¤šåŒ…æ¶µï¼Œä¸€èµ·äº¤æµå­¦ä¹ ï¼Œå…±åŒè¿›æ­¥</code>ã€‚</p><p><img src="/images/re/gmqd.png" width="350px" height="450px"></p><h2 id="3-æœ¬ä¹¦ä»‹ç»"><a href="#3-æœ¬ä¹¦ä»‹ç»" class="headerlink" title="3.æœ¬ä¹¦ä»‹ç»"></a>3.æœ¬ä¹¦ä»‹ç»</h2><h3 id="3-1-å¡«å‘è®°å½•"><a href="#3-1-å¡«å‘è®°å½•" class="headerlink" title="3.1 å¡«å‘è®°å½•"></a>3.1 å¡«å‘è®°å½•</h3><p><img src="/images/re/tkjl.png"></p><h3 id="3-2-BATJéƒ¨åˆ†ä¹¦è¯„"><a href="#3-2-BATJéƒ¨åˆ†ä¹¦è¯„" class="headerlink" title="3.2 BATJéƒ¨åˆ†ä¹¦è¯„"></a>3.2 BATJéƒ¨åˆ†ä¹¦è¯„</h3><p>è¿‡å»åå‡ å¹´é‡Œï¼Œå¹¿ä¹‰çš„â€œå¾®æœåŠ¡â€æ¶æ„ä»¥å…¶å°å›¢é˜Ÿå¿«é€Ÿåˆ›å»ºå’Œè¿­ä»£æœåŠ¡å¸¦æ¥çš„æ¶æ„å¼¹æ€§ã€æ‰©å±•æ€§ã€æ•æ·æ€§ï¼Œå¤©ç„¶åŒ¹é…äº†äº’è”ç½‘ä¸šåŠ¡å¿«é€Ÿå‘å±•å’Œå˜åŒ–çš„ç‰¹ç‚¹ï¼Œåœ¨å„å¤§äº’è”ç½‘å…¬å¸å–å¾—äº†å·¨å¤§çš„æˆåŠŸã€‚æ—¶è‡³äº‘åŸç”Ÿåº”ç”¨æ—¶ä»£ï¼Œå·²ä¸å†æ˜¯æ˜¯å¦é‡‡ç”¨å¾®æœåŠ¡æ¶æ„çš„é—®é¢˜ï¼Œè€Œæ˜¯ä½•æ—¶é‡‡ç”¨ä»¥åŠå¦‚ä½•åœ¨ç”Ÿäº§ä¸Šå®æˆ˜çš„é—®é¢˜ã€‚æœ¬ä¹¦å°†å¦‚ä½•åŸºäºSpring Cloudç”Ÿæ€ä½“ç³»è¿›è¡Œå¾®æœåŠ¡å®æˆ˜çš„æ–¹æ–¹é¢é¢çš„ç»†èŠ‚éƒ½æ¶µç›–äº†ï¼Œï¼Œä»è¿™ä¸ªæ„ä¹‰ä¸Šæ¥è®²ï¼Œç¡®å®åšåˆ°äº†â€œé‡æ–°å®šä¹‰â€ã€‚</p><p><code>â€”â€” å¤å®‡ Nacoså¼€æºé¡¹ç›®åˆ›å§‹äºº/é˜¿é‡Œå·´å·´é«˜çº§æŠ€æœ¯ä¸“å®¶</code></p><p>å¾®æœåŠ¡ä»¥æ•æ·ä¸ºç›®æ ‡ï¼Œä»¥é™ä½å¤æ‚çš„ç³»ç»Ÿç»“æ„ä¸ºåŸºç¡€ï¼Œå¸¦ç»™æˆ‘ä»¬æ›´å¥½çš„ç³»ç»Ÿå¯ç”¨æ€§å’Œç¨³å®šæ€§ã€‚Spring Cloudä½œä¸ºä¸€å¥—å®Œå–„çš„å¾®æœåŠ¡æ²»ç†çš„å…¸å‹æ¡†æ¶ï¼Œæ¶µç›–äº†å¾®æœåŠ¡æ²»ç†çš„æ–¹æ–¹é¢é¢ã€‚æœ¬ä¹¦è¯¦ç»†ä»‹ç»äº†Spring Cloudçš„æ¯ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œä»¥ç†è®ºä¸å®é™…ç›¸ç»“åˆçš„æ–¹å¼ï¼Œé€å½»åœ°è®²è¿°äº†Spring Cloudçš„ç²¾é«“ï¼Œæ˜¯æ¯ä¸€ä½å¥‹æˆ˜åœ¨æœåŠ¡åŒ–é¢†åŸŸä¸€çº¿çš„å·¥ç¨‹å¸ˆã€æ¶æ„å¸ˆçš„*é€‰æŠ€æœ¯ä¹¦ç±ã€‚</p><p><code>â€”â€”æè‰³é¹ èš‚èšé‡‘æœé«˜çº§æŠ€æœ¯ä¸“å®¶/ã€Šåˆ†å¸ƒå¼æœåŠ¡æ¶æ„ã€‹ã€Šå¯ä¼¸ç¼©æœåŠ¡æ¶æ„ã€‹ä½œè€…</code></p><p>æœ¬ä¹¦å¯ä»¥è¯´æ˜¯åç«¯æ¶æ„å¸ˆçš„è¿›é˜¶å®å…¸ï¼Œå…¨é¢åœ°è®²è§£äº†å¦‚ä½•æ‰“é€ ä¸€å¥—å¼ºå¤§ã€å¥å£®çš„å¾®æœåŠ¡ä½“ç³»ï¼Œæ·±å…¥åˆ†æäº†æ¶‰åŠåˆ°çš„å„ä¸ªç»„ä»¶ã€‚*éš¾å¾—çš„æ˜¯ï¼Œä¹¦ä¸­ç»“åˆäº†ä½œè€…å¤šå¹´ç§¯ç´¯çš„æ¶æ„ç»éªŒï¼Œåˆ†æäº†å„ç§ç»„ä»¶é€‚ç”¨çš„åœºæ™¯ï¼Œå¹³å®åœ°è¯´æ˜äº†å®é™…ä½¿ç”¨ä¸­çš„å„ç§è€ƒé‡å’Œç»†èŠ‚ä¼˜åŒ–ï¼Œç®€ç›´æ˜¯å¥‹æ–—åœ¨ä¸€çº¿çš„å·¥ç¨‹å¸ˆçš„å¿ƒè¡€ç»“æ™¶ã€‚ä»»ä½•æƒ³æŒæ¡å¤§å‹åç«¯æ¶æ„çš„å·¥ç¨‹å¸ˆï¼Œæ— è®ºä½¿ç”¨ä»€ä¹ˆæŠ€æœ¯æ¡†æ¶ï¼Œéƒ½èƒ½ä»æœ¬ä¹¦è·ç›ŠåŒªæµ…ã€‚</p><p><code>â€”â€”æåŒæ¶› é¥¿äº†ä¹ˆä¸­é—´ä»¶èµ„æ·±æ¶æ„å¸ˆ</code></p><p>Spring Cloudå·²ç„¶æˆä¸ºJavaé¢†åŸŸåº”ç”¨å¾®æœåŠ¡åŒ–çš„*é€‰æ¡†æ¶ï¼Œä½†å›½å†…ä¸€ç›´ç¼ºå°‘å…¨é¢è®ºè¿°Spring Cloudå•†ç”¨å®è·µç›¸å…³çš„ä¹¦ç±ã€‚æœ¬ä¹¦å›´ç»•Spring Cloudæ¡†æ¶ä¸­çš„æœåŠ¡æ³¨å†Œå‘ç°ã€æœåŠ¡è·¯ç”±ã€æœåŠ¡ç½‘å…³ã€åˆ†å¸ƒå¼é…ç½®ã€æœåŠ¡æ²»ç†ã€å®¹å™¨åŒ–åŠå¾®æœåŠ¡è®¾è®¡ç­‰å…³é”®é¢†åŸŸè¿›è¡Œäº†æ·±å…¥æµ…å‡ºçš„è®²è§£ï¼Œå¹¶ç»™äºˆäº†å¤§é‡çš„çœŸå®åº”ç”¨æ¡ˆä¾‹ï¼Œæ–°æ‰‹å’Œè€æ‰‹éƒ½å¯ä»¥ä»ä¸­å—ç›Šè‰¯å¤šã€‚ä½œè€…ä½œä¸ºSpring Cloudä¸­å›½çš„èµ„æ·±ä¸“å®¶ï¼Œå¯¹äºSpring CloudåŠå¾®æœåŠ¡æœ‰ç€æ·±åˆ»çš„æ¶æ„å’Œå®æˆ˜ç»éªŒï¼Œå€¼å¾—ä¿¡èµ–ã€‚</p><p><code>â€”â€”å•å®¶éª è…¾è®¯ä¸­é—´ä»¶é«˜çº§å·¥ç¨‹å¸ˆ</code></p><p>åœ¨å¾®æœåŠ¡ä½“ç³»ä¸­ï¼ŒSpring Cloudæ˜¯ç›®å‰æœ€çƒ­é—¨çš„æ„å»ºå¾®æœåŠ¡ä½“ç³»çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒæä¾›äº†æ„å»ºå¾®æœåŠ¡æ¶æ„çš„ä¸€äº›åŸºç¡€è®¾æ–½ã€‚æœ¬ä¹¦å†…å®¹ä¸Šè¦†ç›–äº†Spring Cloudçš„ä¸€äº›ä¸»è¦ç»„ä»¶ï¼Œä¸ä»…åœ¨å¦‚ä½•ä½¿ç”¨ä¸Šåšäº†è¯¦ç»†çš„ä»‹ç»ï¼Œä¹Ÿä»åŸç†ä¸Šæ·±å…¥æµ…å‡ºåœ°å‰–æäº†å…¶ä¸­çš„æŠ€æœ¯è¦ç‚¹ï¼ŒåŒæ—¶éƒ¨åˆ†ç»„ä»¶ä¹Ÿè·Ÿå‘¨è¾¹çš„ä¸€äº›å¼€æºé¡¹ç›®è¿›è¡Œäº†å¯¹æ¯”ï¼Œä¸”æä¾›äº†ä¸€äº›åŸç†åˆ†æå’Œç›¸å…³çš„ç¤ºä¾‹ï¼Œæ˜¯ä¸€æœ¬ä¸å¯å¤šå¾—çš„Spring Cloudå®æˆ˜ä¹¦ç±ã€‚æ–°æ‰‹å’Œæœ‰å¾®æœåŠ¡å®è·µç»éªŒçš„è¯»è€…éƒ½èƒ½ä»ä¹¦ä¸­å¾—åˆ°ä¸€äº›ä¸ä¸€æ ·çš„æ”¶è·ã€‚<br>     <code>â€”â€”å¼ è‰ºè¾° è…¾è®¯é«˜çº§ç ”å‘å·¥ç¨‹å¸ˆ</code></p><p>æœ¬ä¹¦ä¸ä»…å¯¹Spring Cloudå„æ ¸å¿ƒç»„ä»¶è¿›è¡Œäº†ç»†è‡´å…¥å¾®çš„ä»‹ç»ï¼ŒåŒæ—¶ä¹Ÿè·³å‡ºäº†æ¡†æ¶æœ¬èº«ï¼Œä¸ºå¾®æœåŠ¡çš„å®æ–½å’Œåˆ†å¸ƒå¼æ¶æ„æ‰€é¢ä¸´çš„åŸºæœ¬é—®é¢˜äº¤å‡ºäº†Spring Cloudå¼ç­”å·ï¼Œæ˜¯å¼€å‘è€…å¿«é€ŸæŒæ¡Spring CloudæŠ€æœ¯æ ˆçš„ç¥å…µåˆ©å™¨ã€‚ä¸ä»…å¦‚æ­¤ï¼Œæœ¬ä¹¦è¿˜å‡èšç€Spring Cloudä¸­å›½ç¤¾åŒºçš„æ™ºæ…§ç»“æ™¶ï¼Œè®©æˆ‘ä»¬çœ‹åˆ°äº†å›½äººåœ¨å¼€æºé¢†åŸŸçš„ç ”å‘åŠ›é‡ï¼Œ å¯å–œå¯è´ºã€‚<br>     <code>â€”â€”ç‹é¸¿é£ ç™¾åº¦é«˜çº§ç ”å‘å·¥ç¨‹å¸ˆ</code></p><p>åœ¨å¾®æœåŠ¡å¦‚ç«å¦‚è¼çš„ä»Šå¤©ï¼Œå„ç§å¾®æœåŠ¡æ¡†æ¶å±‚å‡ºä¸ç©·ï¼Œè€ŒSpring Cloudæ— ç–‘æ˜¯é‚£é¢—æœ€é—ªäº®çš„æ˜Ÿã€‚ä»Spring Frameworkåˆ°Spring Bootï¼Œå†åˆ°å¦‚ä»Šçš„Spring Cloudï¼ŒSpringå…¨å®¶æ¡¶ç»™ä¼—å¤šç¨‹åºå‘˜å¸¦æ¥äº†çœŸæ­£çš„æ˜¥å¤©ã€‚ç”±äºåˆ†å¸ƒå¼å’ŒæœåŠ¡åŒ–æ˜¯æå…·æŒ‘æˆ˜çš„ä»»åŠ¡ï¼Œå› æ­¤Spring Cloudä¹Ÿä¸å¯é¿å…çš„æ„ˆåŠ å¤æ‚ã€‚Spring CLoudä¸­å›½ç¤¾åŒºä¸ºSpring Cloudçš„æ™®åŠåšå‡ºäº†å·¨å¤§çš„è´¡çŒ®ï¼Œå¹¶è¿…é€Ÿçš„é™ä½äº†è¯­è¨€é—®é¢˜æ‰€å¸¦æ¥çš„å­¦ä¹ é—¨æ§›ã€‚è¿™æœ¬ä¹¦ç”±Spring CLoudä¸­å›½ç¤¾åŒºå€¾åŠ›æ‰“é€ ï¼Œä¹¦ç±æ¶µç›–äº†Spring Cloudçš„æœåŠ¡å‘ç°ã€ç½‘å…³ã€ç†”æ–­å™¨ã€é…ç½®ã€å…¨é“¾è·¯ç›‘æ§ç­‰æœ€æ ¸å¿ƒç»„ä»¶ï¼Œå¹¶å¾ˆæ¥åœ°æ°”åœ°è¯¦è¿°äº†Dubboå‘Spring Cloudè¿ç§»ä»¥åŠSpring Cloudä¸åˆ†å¸ƒå¼äº‹åŠ¡ç›¸å…³å†…å®¹ï¼Œå€¼å¾—ä¸€çœ‹ã€‚<br><code>â€”â€”å¼ äº® äº¬ä¸œé‡‘èæ•°æ®ç ”å‘è´Ÿè´£äºº/åˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶Sharding-Sphereè´Ÿè´£äºº</code></p><p>Spring Cloudæä¾›äº†å®Œæ•´çš„å¾®æœåŠ¡æŠ€æœ¯ä½“ç³»ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿåœ°å®ç°æ¶æ„å‡çº§ã€‚ã€Šé‡æ–°å®šä¹‰Spring Cloudå®æˆ˜ã€‹ä¸€ä¹¦å®Œæ•´åœ°ä»‹ç»äº†Spring Cloudä¸­å„ä¸ªç»„ä»¶çš„ä½¿ç”¨æ–¹æ³•å¹¶æ·±åº¦å‰–æäº†å…¶ä¸­çš„åŸç†ï¼Œæ–‡ç« æ·±å…¥æµ…å‡ºå¸®åŠ©å¼€å‘è€…å¿«é€ŸæŒæ¡å’Œç†è§£Spring Cloudã€‚<br><code>â€”â€”æè‰ºæ’ è…¾è®¯ç ”å‘å·¥ç¨‹å¸ˆ</code></p><h3 id="3-3-è¯»è€…åé¦ˆ"><a href="#3-3-è¯»è€…åé¦ˆ" class="headerlink" title="3.3 è¯»è€…åé¦ˆ"></a>3.3 è¯»è€…åé¦ˆ</h3><p><a href="https://github.com/SpringCloud/spring-cloud-code/issues/1" target="_blank" rel="noopener">https://github.com/SpringCloud/spring-cloud-code/issues/1</a></p><h3 id="3-4-æºç ç›¸å…³"><a href="#3-4-æºç ç›¸å…³" class="headerlink" title="3.4 æºç ç›¸å…³"></a>3.4 æºç ç›¸å…³</h3><p>ä¹¦ç±ç›®å½•ï¼š<a href="https://github.com/SpringCloud/spring-cloud-catalog" target="_blank" rel="noopener">https://github.com/SpringCloud/spring-cloud-catalog</a></p><p>æºç åœ°å€:<a href="https://github.com/SpringCloud/spring-cloud-code" target="_blank" rel="noopener">https://github.com/SpringCloud/spring-cloud-code</a></p><h3 id="3-5-å†…å®¹ç®€ä»‹"><a href="#3-5-å†…å®¹ç®€ä»‹" class="headerlink" title="3.5 å†…å®¹ç®€ä»‹"></a>3.5 å†…å®¹ç®€ä»‹</h3><p>è¿™æ˜¯ä¸€æœ¬å®è·µä¸ç†è®ºå¹¶é‡ã€å¹¿åº¦ä¸æ·±åº¦å…¼é¡¾çš„Spring Cloudç”Ÿäº§å®è·µå¼€å‘æŒ‡å—ï¼Œç”±Spring Cloudä¸­å›½ç¤¾åŒºå€¾åŠ›æ‰“é€ ï¼Œä½œè€…æ¥è‡ªé˜¿é‡Œã€èš‚èšé‡‘æœã€äº¬ä¸œé‡‘èç­‰ä¼ä¸šï¼Œæœ¬ä¹¦é’ˆå¯¹Spring Cloudåœ¨å›½å†…çš„ä½¿ç”¨æƒ…å†µï¼Œç»“åˆå›½å†…ä¼ä¸šä½¿ç”¨Spring Cloudè½åœ°å¾®æœåŠ¡æ¶æ„é‡åˆ°çš„é—®é¢˜ï¼Œæå‡ºå¯è½åœ°çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>æœ¬ä¹¦å†…å®¹æœ‰3å¤§ç‰¹è‰²ï¼š</p><ul><li><p><code>è¶³å¤Ÿå¹¿</code>ï¼šè¯¦ç»†è®²è§£äº†Spring Cloudçš„æ ¸å¿ƒå¸¸ç”¨ç»„ä»¶ä»¥åŠSpring Cloudçš„å¢å¼ºç”Ÿæ€ï¼Œé’ˆå¯¹ç”Ÿäº§å®è·µä¸­å¸¸è§é—®é¢˜ç»™å‡ºå¯è½åœ°çš„æœ€ä½³å®è·µæ–¹æ¡ˆï¼Œæ— è®ºæ‚¨æ˜¯åˆå­¦è€…è¿˜æ˜¯å¼€å‘äººå‘˜ï¼Œè¿˜æ˜¯æ¶æ„å¸ˆï¼Œéƒ½èƒ½ä»æ­¤ä¹¦è·ç›Šã€‚</p></li><li><p><code>æœ‰æ·±åº¦</code>ï¼šæœ¬ä¹¦å¯¹æ¶‰åŠçš„Spring Cloudç»„ä»¶æŒ‰ç…§ä»å…¥é—¨ã€è¿›é˜¶ã€å®æˆ˜ã€æ‰©å±•å¢å¼ºçš„é¡ºåºå¾ªåºæ¸è¿›è¿›è¡Œå‰–æå’Œè®²è§£,å¸®åŠ©ä½œè€…çŸ¥å…¶ç„¶å¹¶çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œæˆä¹‹ä»¥æ¸”ã€‚</p></li><li><p><code>é‡å®è·µ</code>ï¼šæ³¨é‡ç”Ÿäº§å®è·µï¼Œé€šè¿‡æ¡ˆä¾‹é©±åŠ¨ï¼Œç»™å‡ºä¼˜ç§€çš„ç”Ÿäº§å®è·µæ–¹æ¡ˆå’Œä¼˜ç§€çš„ç”Ÿäº§é…ç½®ï¼Œå¸®åŠ©è¯»è€…å¿«é€Ÿè½åœ°ä¼ä¸šå¾®æœåŠ¡æ¶æ„ã€‚</p></li></ul><p>å…¨ä¹¦å…±25ç« ï¼Œåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ul><li><p>ç¬¬ä¸€éƒ¨åˆ† æ ¸å¿ƒç»„ä»¶ç¯‡ï¼ˆç¬¬1~10ç« ï¼‰<br>ä¸»è¦è®²è§£Spring Cloudçš„æ ¸å¿ƒç»„ä»¶ã€‚é¦–å…ˆä»åº”ç”¨æ¶æ„çš„å‘å±•å†ç¨‹è®²èµ·ï¼Œä»‹ç»äº†å¾®æœåŠ¡å‡ºç°çš„èƒŒæ™¯ï¼Œå¹¶å¯¹å¾®æœåŠ¡æ¶æ„çš„è½åœ°æå‡ºäº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼›ç„¶ååˆ†åˆ«è¯¦ç»†ä»‹ç»äº†Spring Cloudå¾®æœåŠ¡ä½“ç³»ä¸­çš„æ ¸å¿ƒå¸¸ç”¨ç»„ä»¶ï¼Œå¦‚Eurekaã€Feignã€Ribbonã€Hystrixã€Zuulç­‰ï¼›æœ€åé€šè¿‡ä¸€ä¸ªç»¼åˆæ¡ˆä¾‹å°†å‰é¢ä»‹ç»çš„ç»„ä»¶è¿æ¥èµ·æ¥ï¼Œå¸®åŠ©å¤§å®¶èä¼šè´¯é€šã€‚</p></li><li><p>ç¬¬äºŒéƒ¨åˆ† è¿›é˜¶å®æˆ˜ç¯‡ï¼ˆç¬¬11~18ç« ï¼‰<br>åœ¨æ ¸å¿ƒç»„ä»¶çš„åŸºç¡€ä¸Šï¼Œå¯¹Configã€Consulã€è®¤è¯å’Œé‰´æƒã€å…¨é“¾è·¯ç›‘æ§ä»¥åŠå¯¹Spring Cloudç”Ÿæ€åœˆä¸­ç¬¬äºŒä»£ç½‘å…³Spring Cloud Gatewayè¿›è¡Œäº†è¯¦ç»†é˜è¿°ï¼Œå¾ªåºæ¸è¿›ã€æ¡ˆä¾‹é©±åŠ¨ï¼Œå¸®åŠ©è¯»è€…åŠ æ·±å¯¹ç»„ä»¶çš„ç†è§£å’Œè¿ç”¨ï¼Œæ›´å¥½åœ°æŒæ¡ç›¸å…³å†…å®¹è¿ç”¨äºç”Ÿäº§å®è·µã€‚</p></li><li><p>ç¬¬ä¸‰éƒ¨åˆ† è§£å†³æ–¹æ¡ˆç¯‡ï¼ˆç¬¬19~25ç« ï¼‰<br> ä¸»è¦ä»è§£å†³æ–¹æ¡ˆç€æ‰‹ï¼Œå†…å®¹åŒ…æ‹¬Spring Cloudä¸gRPCçš„æ•´åˆæ–¹å¼ã€ç‰ˆæœ¬æ§åˆ¶ä¸ç°åº¦å‘å¸ƒã€Spring Cloudå®¹å™¨åŒ–ã€Dubboå‘Spring Cloudçš„è¿ç§»ã€åˆ†å¸ƒå¼äº‹åŠ¡ã€é¢†åŸŸé©±åŠ¨ç­‰ç”Ÿäº§çº§å®ç”¨è§£å†³æ–¹æ¡ˆï¼Œä¸ºä¼ä¸šITæ¶æ„å¾®æœåŠ¡åŒ–å’Œå˜é©ä¿é©¾æŠ¤èˆªã€‚</p></li></ul><h3 id="3-6-æ¨èç†ç”±"><a href="#3-6-æ¨èç†ç”±" class="headerlink" title="3.6 æ¨èç†ç”±"></a>3.6 æ¨èç†ç”±</h3><ul><li><p>æœ¬ä¹¦ç”±Spring Cloudç¤¾åŒºå®˜æ–¹æ’°å†™ï¼Œæ ¸å¿ƒæˆå‘˜æ¥è‡ªåŸé˜¿é‡Œã€èš‚èšé‡‘æœã€äº¬ä¸œé‡‘èç­‰äº’è”ç½‘ä¼ä¸šï¼Œç»éªŒä¸°å¯Œã€‚</p></li><li><p>æœ¬ä¹¦å†…å®¹æœ‰3å¤§ç‰¹è‰²ï¼šå®½åº¦è¶³å¤Ÿå¹¿ã€æ·±åº¦è¶³å¤Ÿæ·±ï¼Œè€Œä¸”ç«‹è¶³äºç”Ÿäº§å®è·µï¼Œç›´æ¥ä»ç”Ÿäº§å®è·µå‡ºå‘ï¼ŒåŒ…å«å¤§é‡ç”Ÿäº§å®è·µçš„é…ç½®</p></li><li><p>æœ¬ä¹¦å¾—åˆ°äº†æ¥è‡ªé˜¿é‡Œã€è…¾è®¯ã€ç™¾åº¦ã€äº¬ä¸œç­‰å¤§å‹äº’è”ç½‘ä¼ä¸šçš„è¿‘10ä½ä¸“å®¶çš„é¼åŠ›æ¨èã€‚</p></li></ul><h3 id="3-7-ä½œè€…ä»‹ç»"><a href="#3-7-ä½œè€…ä»‹ç»" class="headerlink" title="3.7 ä½œè€…ä»‹ç»"></a>3.7 ä½œè€…ä»‹ç»</h3><ol><li><p>è®¸è¿›:Spring Cloudä¸­å›½ç¤¾åŒºåˆ›å§‹äººï¼Œé˜¿é‡ŒåŸèµ„æ·±å·¥ç¨‹å¸ˆï¼ŒèŠ±åç¹éœ–ï¼Œä¸“æ³¨äºåŸºç¡€æ¶æ„ä¸ä¸­é—´ä»¶ç ”å‘ï¼Œæ›¾å°±èŒäºå”¯å“ä¼šå¹³å°æ¶æ„éƒ¨å’Œé¥¿äº†ä¹ˆã€‚ä¸ªäººç½‘ç«™ï¼š<a href="http://xujin.orgã€‚" target="_blank" rel="noopener">http://xujin.orgã€‚</a></p></li><li><p>é’Ÿå°Šå‘:Spring Cloudä¸­å›½ç¤¾åŒºè”åˆåˆ›å§‹äººï¼Œç°å°±èŒäºäº¬ä¸œé‡‘èï¼Œå¯¹å¾®æœåŠ¡æœ‰æ·±å…¥ç ”ç©¶ã€‚</p></li><li><p>å¶å¿—è¿œ:Spring Cloudä¸­å›½ç¤¾åŒºè”åˆåˆ›å§‹äººï¼Œç°å°±èŒäºèš‚èšé‡‘æœï¼ŒèŠ±åæ¢“å°§ã€‚CSDNåšå®¢ä¸“å®¶ï¼Œå¼€æºç¤¾åŒºæ´»è·ƒè€…ï¼Œå›½å†…Spring Cloudæ—©æœŸå®è·µè€…</p></li><li><p>æ–¹å¿—æœ‹:Spring Cloudä¸­å›½ç¤¾åŒºè”åˆåˆ›å§‹äººï¼Œç¡•å£«å­¦å†ï¼Œã€Šæ·±å…¥ç†è§£Spring Cloudä¸å¾®æœåŠ¡æ„å»ºã€‹ä½œè€…ï¼ŒCSDNåšå®¢ä¸“å®¶ï¼ˆé˜…è¯»é‡600ä¸‡+ï¼‰ï¼Œåœ¨ç¤¾åŒºå…·æœ‰è¾ƒé«˜æ´»è·ƒåº¦ä¸å½±å“åŠ›ã€‚</p></li><li><p>è”¡æ³¢æ–¯:æ‹¥æœ‰å¤šå¹´Javaå¼€å‘ç»éªŒï¼Œæ›¾å°±èŒäºç¾å›¢ã€è…¾è®¯ã€‚å›½å†…Spring Cloudé¢†åŸŸçš„æ—©æœŸå®è·µè€…ï¼Œç°åœ¨é‡‘èè¡Œä¸šä»äº‹FinTechç›¸å…³ç ”å‘</p></li><li><p>éƒ­èŠ³ç¢§:å¤šå¹´å¾®æœåŠ¡å®è·µç»éªŒï¼Œç°ä»»èŒäºæŸäº’è”ç½‘é‡‘èå…¬å¸ä¸­é—´ä»¶éƒ¨é—¨ã€‚</p></li><li><p>æœ±å¾·æ˜:æ‹¥æœ‰10å¹´Javaå¼€å‘ç»éªŒï¼Œå¤šå¹´æŠ€æœ¯æ¶æ„å’Œè§£å†³æ–¹æ¡ˆç»éªŒï¼Œç°ä»»çµé›€äº‘å¾®æœåŠ¡æ¶æ„å¸ˆï¼Œåœ¨å¾®æœåŠ¡é¢†åŸŸæœ‰ç€ä¸°å¯Œçš„è½åœ°ç»éªŒï¼Œæ›¾ä»»æŸåˆ›ä¸šå…¬å¸æŠ€æœ¯è´Ÿè´£äººã€‚</p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦:&lt;/strong&gt; ä»Šå¤©æ˜¯2018å¹´9æœˆ24å·ä¸­ç§‹èŠ‚ï¼Œç¥ç¦å¤§å®¶ä¸­ç§‹èŠ‚å¿«ä¹ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»ã€Šé‡æ–°å®šä¹‰Spring Cloudå®æˆ˜ã€‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é‡æ–°å®šä¹‰" scheme="http://xujin.org/categories/%E9%87%8D%E6%96%B0%E5%AE%9A%E4%B9%89/"/>
    
    
      <category term="é¡¹ç›®ç»éªŒ" scheme="http://xujin.org/tags/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"/>
    
      <category term="é‡æ–°å®šä¹‰" scheme="http://xujin.org/tags/%E9%87%8D%E6%96%B0%E5%AE%9A%E4%B9%89/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ªäººåšå®¢-æœ‰äº‰è®®æ–‡ç« ç‰ˆæƒé—®é¢˜å¤ç›˜å£°æ˜</title>
    <link href="http://xujin.org/ex/bqsm/"/>
    <id>http://xujin.org/ex/bqsm/</id>
    <published>2018-09-03T06:00:00.000Z</published>
    <updated>2019-01-13T05:17:07.943Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯è®¸è¿›æ²‰æ€å½•çš„åšä¸»è®¸è¿›ï¼Œæ„Ÿè°¢å¤§å®¶å¯¹æˆ‘çš„åšå®¢è¿›è¡Œé˜…è¯»ï¼Œä¹‹æ‰€ä»¥ç½‘ç«™<code>å–åä¸ºæ²‰æ€å½•</code>ä¸»è¦æƒ³ç”¨<code>åšå®¢çš„æ–¹å¼è®°å½•æˆ‘äººç”Ÿæ¯ä¸ªé˜¶æ®µçš„æŠ€æœ¯æ€è€ƒå’ŒæŠ€æœ¯å­¦ä¹ å¿«ç…§ï¼Œå’Œæ„Ÿæ‚Ÿ</code>ã€‚ç”±äºæœ€è¿‘æœ‰ç½‘å‹å¯¹æˆ‘åšå®¢ä¸Šçš„å†…å®¹çš„<code>ç‰ˆæƒé—®é¢˜äº§ç”Ÿäº‰è®®</code>ï¼Œå› æ­¤æœ¬æ–‡ä¸»è¦å¯¹æˆ‘ä¸ªäººåšå®¢å†…å®¹çš„ç‰ˆæƒé—®é¢˜äº‰è®®<code>è¿›è¡Œå¤ç›˜å£°æ˜</code>ã€‚</p><a id="more"></a><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ç¯‡æ–‡ç« ä¸ºä»€ä¹ˆä¼šå‡ºç°å‘¢ï¼Ÿ</p><ul><li>ç¬¬ä¸€,å› ä¸ºæœ€è¿‘å‘ç”Ÿäº†è®©æˆ‘åŒªå¤·æ‰€æ€çš„äº‹æƒ…ï¼Œè‡³äºä»€ä¹ˆäº‹æƒ…æˆ‘ä¸æƒ³åšè¿‡å¤šè§£é‡Šã€‚æˆ‘åªæƒ³<code>åšå¥½æˆ‘è‡ªå·±ï¼Œå°Šå¸ˆé‡é“ï¼Œæœ‰åˆ™æ”¹ä¹‹ï¼Œæ— è´£åŠ å‹‰</code>ã€‚</li><li>ç¬¬äºŒ,æœ€è¿‘æœ‰å¹¸å’Œå¦å¤–6ä½ä½œè€…å†™å®Œä¸€æœ¬åä¸ºã€Šé‡æ–°å®šä¹‰Spring Cloudå®æˆ˜ã€‹æŠ€æœ¯ä¹¦ï¼Œèµ·åˆè§„åˆ’äº†32ç« ï¼Œæœ€åå®åœ¨å†™ä¸åŠ¨äº†ï¼Œä¿ç•™äº†ç²¾åçš„25ç« ï¼Œç”±äºå·¥ä½œç‰¹åˆ«å¿™ï¼Œ7ä½ä½œè€…ç»è¿‡æ— æ•°ä¸ªå¤œæ™šç†¬å¤œï¼Œæœ€ç»ˆåˆç¨¿æ±‡æ€»ä¹‹å 1400é¡µï¼Œæˆ‘ç¬¬ä¸€æ„Ÿè§‰æˆ‘çš„å¤©å‘€ï¼Œçº¸å¼ è¿™ä¹ˆè´µã€‚è€Œä¸”æˆ‘ä»¬åœ¨å†™çš„è¿‡ç¨‹ä¸­ï¼Œç«™åœ¨è¯»è€…çš„è§’åº¦+é™ä½æˆæœ¬çš„è§’åº¦ï¼Œåšäº†å¾ˆå¤šæ€è€ƒã€‚æœ€åæˆ‘ä»¬7äººè¿›è¡Œç¼©å‡ï¼Œèƒ½ç”¨ä¸€å¥è¯è¯´æ˜ç™½çš„å°±ä¸è¦ç”¨ä¸¤å¥è¯ï¼Œç»è¿‡å¯¹æ•´æœ¬ä¹¦è¿›è¡Œè°ƒæ•´ï¼Œåœ¨ä¿æŒå†…å®¹ä¸å˜çš„æƒ…å†µä¸‹æœ€ååˆç¨¿ä¸º1187é¡µã€‚å¥½åƒè·‘é¢˜äº†ï¼Œè¨€å½’æ­£ä¼ ï¼Œæœ€è¿‘ç”µå­é²œè¯»ç‰ˆæœ¬å·²å…¬å¼€ã€‚å¥½å¤šæŠ€æœ¯æœ‹å‹çœ‹å®Œä¹‹åï¼Œæœ‰äººé—®æˆ‘:æˆ‘å¯ä»¥åœ¨æˆ‘åšå®¢ä¸Šå†™ä¸€ä¸‹å…³äºè¿™æœ¬ä¹¦çš„è¯»ä¹¦ç¬”è®°å—ï¼Ÿæˆ‘è¯´å¯ä»¥å‘€ï¼Œç„¶åä»–é—®äº†æˆ‘ç‰ˆæƒç½²åçš„é—®é¢˜ã€‚æˆ‘å›ç­”æ˜¯:æˆ‘ä¸å¤ªä»‹æ„è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åšå¥½è‡ªå·±å°±å¯ä»¥ã€‚ä½†æ˜¯ä¸ºäº†é¿å…å¼•èµ·ä¸å¿…è¦çš„éº»çƒ¦ï¼Œæˆ‘å»ºè®®ä»–å¯ä»¥å†™ä¸ºã€ŠæŸæŸæŸä¹¦çš„è¯»ä¹¦ç¬”è®°ã€‹</li></ul><blockquote><p>é’ˆå¯¹ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ï¼Œå’Œæœ€è¿‘å‘ç”Ÿçš„äº‹æƒ…ï¼ŒçœŸçš„æœ‰å¿…è¦è¿›è¡Œå¤ç›˜è¿›è¡Œå£°æ˜ã€‚</p></blockquote><h2 id="1-åšå®¢æ¦‚è¿°"><a href="#1-åšå®¢æ¦‚è¿°" class="headerlink" title="1.åšå®¢æ¦‚è¿°"></a>1.åšå®¢æ¦‚è¿°</h2><p>   æˆ‘å¼€å§‹æ¥è§¦å†™åšå®¢çš„æ—¶å€™æ˜¯ä»æ–°æµªåšå®¢å¼€å§‹ï¼Œåæ¥ç»è¿‡å¤šæ¬¡æŠ˜è…¾è¿›è¡Œè¿ç§»ã€‚åœ¨å†™è¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œæˆ‘æƒ³ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯<code>åšå®¢</code>ã€‚ç™¾åº¦ç™¾ç§‘å¯¹åšå®¢çš„æè¿°å¦‚ä¸‹å›¾ç‰‡æ‰€ç¤º:<br><img src="/images/csl/bkgs.png" width="650px" height="450px"></p><blockquote><p>ç®€å•çš„æ¥è¯´åšå®¢å°±æ˜¯å¯¹<code>å­¦ä¹ </code>ï¼Œ<code>ç”Ÿæ´»</code>ï¼Œ<code>æ„Ÿæ‚Ÿ</code>ï¼Œ<code>æ€è€ƒ</code>çš„ä¸€ç§è®°å½•æ–¹å¼ã€‚ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹ã€‚</p></blockquote><h2 id="2-åšå®¢ç‰ˆæƒå£°æ˜"><a href="#2-åšå®¢ç‰ˆæƒå£°æ˜" class="headerlink" title="2. åšå®¢ç‰ˆæƒå£°æ˜"></a>2. åšå®¢ç‰ˆæƒå£°æ˜</h2><p>  è¿‘å‡ å¹´éšç€çŸ¥è¯†äº§æƒå’Œç‰ˆæƒæ„è¯†çš„å¢å¼ºï¼Œå¾ˆå¤šäººå¼€å§‹å¯¹è‡ªå·±åœ¨ç½‘ä¸Šå‘è¡¨çš„åšå®¢ä¿¡æ¯æˆ–ç½‘ç»œæ—¥å¿—ï¼Œæˆ–è€…æƒ³æ³•å’Œæ„Ÿæ‚Ÿå¢åŠ ç‰ˆæƒä¿¡æ¯ã€‚</p><h3 id="2-1-Hexoåšå®¢ç‰ˆæƒå¢åŠ "><a href="#2-1-Hexoåšå®¢ç‰ˆæƒå¢åŠ " class="headerlink" title="2.1 Hexoåšå®¢ç‰ˆæƒå¢åŠ "></a>2.1 Hexoåšå®¢ç‰ˆæƒå¢åŠ </h3><p>ç”¨è¿‡Hexoæˆ–è€…Hugoçš„å¯ä»¥çŸ¥é“ï¼Œæœ‰æ—¶ä¸ºäº†åå¤æ·»åŠ é‡å¤å†…å®¹ï¼Œä¼šç»Ÿä¸€æ·»åŠ ç‰ˆæƒä¿¡æ¯ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;! -- æ·»åŠ ç‰ˆæƒä¿¡æ¯ --&gt;</span><br><span class="line">&lt;div class=&quot;article-footer-copyright&quot;&gt;</span><br><span class="line">&lt;i class=&quot;fa fa-lightbulb-o&quot;&gt;&lt;/i&gt;</span><br><span class="line">æœ¬æ–‡ç”±&lt;b&gt;&lt;a href=&quot;&lt;%= config.root %&gt;index.html&quot; target=&quot;_blank&quot; title=&quot;&lt;%= config.author %&gt;&quot;&gt;&lt;%= config.author %&gt;&lt;/a&gt;&lt;/b&gt;åˆ›ä½œå’Œå‘è¡¨,é‡‡ç”¨&lt;a href=&quot;http://creativecommons.org/licenses/by/3.0/cn&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CC BY 3.0 CNåè®®&lt;/a&gt; è¿›è¡Œè®¸å¯ã€‚è½¬è½½è¯·æ³¨æ˜ä½œè€…åŠå‡ºå¤„,æœ¬æ–‡ä½œè€…ä¸º&lt;b&gt;&lt;a href=&quot;&lt;%= config.root %&gt;index.html&quot; target=&quot;_blank&quot; title=&quot;&lt;%= config.author %&gt;&quot;&gt;&lt;%= config.author %&gt;&lt;/a&gt;&lt;/b&gt;,æœ¬æ–‡æ ‡é¢˜ä¸º&lt;b&gt;&lt;a href=&quot;&lt;%- config.root %&gt;&lt;%- post.path %&gt;&quot; target=&quot;_blank&quot; title=&quot;&lt;%= post.title %&gt;&quot;&gt;&lt;%= post.title %&gt;&lt;/a&gt;&lt;/b&gt;</span><br><span class="line">æœ¬æ–‡é“¾æ¥ä¸º&lt;b&gt;&lt;a href=&quot;&lt;%- config.root %&gt;&lt;%- post.path %&gt;&quot; target=&quot;_blank&quot; title=&quot;&lt;%= post.title %&gt;&quot;&gt;&lt;%- config.url %&gt;/&lt;%- post.path %&gt;&lt;/a&gt;&lt;/b&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;! -- æ·»åŠ ç‰ˆæƒä¿¡æ¯ --&gt;</span><br></pre></td></tr></table></figure><blockquote><p><code>ä¼˜ç‚¹</code>:ç»Ÿä¸€æ·»åŠ ç‰ˆæƒä¿¡æ¯<br><code>ç¼ºç‚¹</code>:å¦‚æœé—æ¼å®¹æ˜“äº§ç”Ÿè¯¯è§£</p><p>ç»Ÿä¸€æ·»åŠ çš„æ–¹å¼ï¼Œè™½ç„¶æ–¹ä¾¿ï¼Œå³ä¾¿ä½ æŒ‡æ˜äº†ä½œè€…æ˜¯è°ï¼Œä½†æ˜¯ä¹Ÿå®¹æ˜“å¼•èµ·è¯¯ä¼šï¼Œå¯èƒ½ä¼šç»™è‡ªå·±é€ æˆå›°æ‰°ã€‚æ¯”å¦‚ä¸‹é¢äº‰è®®çš„å‡ ç¯‡æ–‡ç« ã€‚</p></blockquote><h2 id="3-åšå®¢ç‰ˆæƒ-äº‰è®®é—®é¢˜å¤ç›˜è¯´æ˜"><a href="#3-åšå®¢ç‰ˆæƒ-äº‰è®®é—®é¢˜å¤ç›˜è¯´æ˜" class="headerlink" title="3.åšå®¢ç‰ˆæƒ-äº‰è®®é—®é¢˜å¤ç›˜è¯´æ˜"></a>3.åšå®¢ç‰ˆæƒ-äº‰è®®é—®é¢˜å¤ç›˜è¯´æ˜</h2><h3 id="3-1-åšå®¢ä¸»é¢˜ç‰ˆæƒå£°æ˜"><a href="#3-1-åšå®¢ä¸»é¢˜ç‰ˆæƒå£°æ˜" class="headerlink" title="3.1 åšå®¢ä¸»é¢˜ç‰ˆæƒå£°æ˜"></a>3.1 åšå®¢ä¸»é¢˜ç‰ˆæƒå£°æ˜</h3><p>  æˆ‘åšå®¢åŸºäºHexoæ„å»ºï¼Œä¸»é¢˜åŸºäº<a href="https://github.com/ppoffice/hexo-theme-icarusä¼˜åŒ–ç¾åŒ–è¿›è¡Œå®šåˆ¶DIYã€‚æ„Ÿè°¢åŸä½œè€…è´¡çŒ®äº†åˆ†äº«äº†è¯¥ä¸»é¢˜ã€‚" target="_blank" rel="noopener">https://github.com/ppoffice/hexo-theme-icarusä¼˜åŒ–ç¾åŒ–è¿›è¡Œå®šåˆ¶DIYã€‚æ„Ÿè°¢åŸä½œè€…è´¡çŒ®äº†åˆ†äº«äº†è¯¥ä¸»é¢˜ã€‚</a></p><h3 id="3-2-Spring-Cloud-Zuulå¼‚å¸¸å¤„ç†æ–‡ç« -ç‰ˆæƒè¯´æ˜"><a href="#3-2-Spring-Cloud-Zuulå¼‚å¸¸å¤„ç†æ–‡ç« -ç‰ˆæƒè¯´æ˜" class="headerlink" title="3.2 Spring Cloud Zuulå¼‚å¸¸å¤„ç†æ–‡ç« -ç‰ˆæƒè¯´æ˜"></a>3.2 Spring Cloud Zuulå¼‚å¸¸å¤„ç†æ–‡ç« -ç‰ˆæƒè¯´æ˜</h3><p>å¦‚ä¸‹å›¾æ‰€ç¤ºSpring Cloud Zuulå¼‚å¸¸å¤„ç†æ–‡ç« æ¥è‡ªäºSpring Cloudä¸­å›½ç¤¾åŒºåšå®¢æŠ•ç¨¿ï¼Œæ–‡ç¨¿ç½²åå¼ åŠ²ï¼Œä¸ºäº†è®©æ›´å¤šçš„äººå­¦ä¹ äº†è§£ã€‚æ”¾äº†ä¸€ä»½åˆ°æˆ‘åšå®¢å·²æ³¨æ˜ä½œè€…ã€‚</p><p><img src="/images/csl/zywz1.jpg" width="650px" height="850px"></p><p>è·Ÿ<code>ä½œè€…æ²Ÿé€šäº†è§£ä¹‹å</code>ï¼Œ<code>ä½œè€…æ²¡æœ‰å‚åŠ è¿‡ä¸Šæµ·æŠ€æœ¯æ²™é¾™ä¹Ÿæ²¡çœ‹è¿‡å¯¹åº”çš„PPT</code>ï¼Œ<br><img src="/images/csl/zjsm2.png" width="650px" height="850px"></p><h3 id="3-3-æ•°æ®åº“è¿æ€§æ± æ€§èƒ½æµ‹è¯•-æ–‡ç« ç‰ˆæƒå£°æ˜"><a href="#3-3-æ•°æ®åº“è¿æ€§æ± æ€§èƒ½æµ‹è¯•-æ–‡ç« ç‰ˆæƒå£°æ˜" class="headerlink" title="3.3 æ•°æ®åº“è¿æ€§æ± æ€§èƒ½æµ‹è¯•-æ–‡ç« ç‰ˆæƒå£°æ˜"></a>3.3 æ•°æ®åº“è¿æ€§æ± æ€§èƒ½æµ‹è¯•-æ–‡ç« ç‰ˆæƒå£°æ˜</h3><p> æœ¬ç¯‡æ–‡ç« é“¾æ¥åœ¨æˆ‘åšå®¢ä¸Šåœ°å€æ˜¯:<a href="http://xujin.org/mw/dcp-test/">http://xujin.org/mw/dcp-test/</a>ï¼Œ æ˜¯æˆ‘åœ¨å”¯å“ä¼šä¸­é—´ä»¶å›¢é˜Ÿæ—¶å­¦ä¹ ä¸­é—´ä»¶çš„è®°å½•ï¼Œæ”¶é›†æ•´ç†æˆMDæ–‡ç¨¿è€Œæ¥ã€‚</p><ul><li><p>é€šè¿‡ç™¾åº¦æœç´¢ç»“æœå¦‚ä¸‹ï¼Œæœ€ä¸‹é¢çš„ä¸¤ä¸ªæˆªå›¾ç±»ä¼¼çš„æ–‡ç« ã€‚<br><img src="/images/csl/zjzh1.png" width="650px" height="850px"></p></li><li><p>è·ŸåŸä½œè€…æ²Ÿé€šå£°æ˜ç‰ˆæƒä¸ºå”¯å“ä¼šä¸­é—´ä»¶å›¢é˜Ÿ<br>æ²Ÿé€šç»“æœå¦‚ä¸‹:<br><img src="/images/csl/htjl.jpg" width="650px" height="850px"></p></li></ul><p>å¤„ç†ç»“æœå¦‚ä¸‹:<br><img src="/images/csl/zhsh.jpg" width="650px" height="850px"></p><h2 id="4-æ€»ç»“å¤„ç†æ–¹å¼"><a href="#4-æ€»ç»“å¤„ç†æ–¹å¼" class="headerlink" title="4.æ€»ç»“å¤„ç†æ–¹å¼"></a>4.æ€»ç»“å¤„ç†æ–¹å¼</h2><p>åšå®¢åæœŸä¼˜åŒ–æ–¹å¼:<br>1.<code>ä¿®æ”¹ç»Ÿä¸€åŠ ç‰ˆæƒæ–¹å¼ä¸ºæ‰‹åŠ¨æ·»åŠ ï¼Œå‡å°‘ä¸å¿…è¦çš„è¯¯ä¼š</code>ã€‚<br>2.<code>å¢åŠ åé¦ˆæœºåˆ¶</code>ï¼Œç¬¬ä¸€æ—¶é—´<code>åé¦ˆå¤„ç†</code></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯è®¸è¿›æ²‰æ€å½•çš„åšä¸»è®¸è¿›ï¼Œæ„Ÿè°¢å¤§å®¶å¯¹æˆ‘çš„åšå®¢è¿›è¡Œé˜…è¯»ï¼Œä¹‹æ‰€ä»¥ç½‘ç«™&lt;code&gt;å–åä¸ºæ²‰æ€å½•&lt;/code&gt;ä¸»è¦æƒ³ç”¨&lt;code&gt;åšå®¢çš„æ–¹å¼è®°å½•æˆ‘äººç”Ÿæ¯ä¸ªé˜¶æ®µçš„æŠ€æœ¯æ€è€ƒå’ŒæŠ€æœ¯å­¦ä¹ å¿«ç…§ï¼Œå’Œæ„Ÿæ‚Ÿ&lt;/code&gt;ã€‚ç”±äºæœ€è¿‘æœ‰ç½‘å‹å¯¹æˆ‘åšå®¢ä¸Šçš„å†…å®¹çš„&lt;code&gt;ç‰ˆæƒé—®é¢˜äº§ç”Ÿäº‰è®®&lt;/code&gt;ï¼Œå› æ­¤æœ¬æ–‡ä¸»è¦å¯¹æˆ‘ä¸ªäººåšå®¢å†…å®¹çš„ç‰ˆæƒé—®é¢˜äº‰è®®&lt;code&gt;è¿›è¡Œå¤ç›˜å£°æ˜&lt;/code&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æ²‰æ€å½•" scheme="http://xujin.org/categories/%E6%B2%89%E6%80%9D%E5%BD%95/"/>
    
    
      <category term="æ²‰æ€å½•" scheme="http://xujin.org/tags/%E6%B2%89%E6%80%9D%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud Gatewayä¸­çš„æƒé‡è·¯ç”±</title>
    <link href="http://xujin.org/sc/gw/gw08/"/>
    <id>http://xujin.org/sc/gw/gw08/</id>
    <published>2018-06-09T06:00:00.000Z</published>
    <updated>2019-01-12T03:31:12.149Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬æ–‡ä¸»è¦é€šè¿‡è¿ç”¨Spring Cloud Gatewayçš„WeightRoutePredicateFactoryå¯¹URLè¿›è¡Œæƒé‡è·¯ç”±ã€‚</p><a id="more"></a><h2 id="1-æƒé‡è·¯ç”±"><a href="#1-æƒé‡è·¯ç”±" class="headerlink" title="1.æƒé‡è·¯ç”±"></a>1.æƒé‡è·¯ç”±</h2><h3 id="1-1-æƒé‡è·¯ç”±ä½¿ç”¨åœºæ™¯"><a href="#1-1-æƒé‡è·¯ç”±ä½¿ç”¨åœºæ™¯" class="headerlink" title="1.1 æƒé‡è·¯ç”±ä½¿ç”¨åœºæ™¯"></a>1.1 æƒé‡è·¯ç”±ä½¿ç”¨åœºæ™¯</h3><p>åœ¨å¼€å‘æˆ–è€…æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ–è€…çº¿ä¸Šå‘å¸ƒï¼Œçº¿ä¸ŠæœåŠ¡å¤šç‰ˆæœ¬æ§åˆ¶çš„æ—¶å€™ï¼Œéœ€è¦å¯¹æœåŠ¡æä¾›æƒé‡è·¯ç”±ï¼Œæœ€å¸¸è§çš„ä½¿ç”¨å°±æ˜¯ï¼Œä¸€ä¸ªæœåŠ¡æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œæ—§ç‰ˆæœ¬V1ï¼Œæ–°ç‰ˆæœ¬v2ã€‚åœ¨çº¿ä¸Šç°åº¦çš„æ—¶å€™ï¼Œéœ€è¦é€šè¿‡ç½‘å…³åŠ¨æ€å®æ—¶æ¨é€ï¼Œè·¯ç”±æƒé‡ä¿¡æ¯ã€‚æ¯”å¦‚95%çš„æµé‡èµ°æœåŠ¡v1ç‰ˆæœ¬ï¼Œ5%çš„æµé‡èµ°æœåŠ¡v2ç‰ˆæœ¬ã€‚</p><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/ce44017f07ce3a1b1d30e87995227ef4.jpg?Expires=1843884992&amp;OSSAccessKeyId=LTAI57F52hRuWq3h&amp;Signature=DBIQ%2BF%2BgIkpjik7x0CmmfaSrglU%3D" alt=""></p><blockquote><p>issue: The Spring Cloud Gateway issue of Allow Rolling Deployments <a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/67" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/67</a></p></blockquote><h3 id="1-2-Spring-Cloud-Gatewayæƒé‡è·¯ç”±åŸç†"><a href="#1-2-Spring-Cloud-Gatewayæƒé‡è·¯ç”±åŸç†" class="headerlink" title="1.2 Spring Cloud Gatewayæƒé‡è·¯ç”±åŸç†"></a>1.2 Spring Cloud Gatewayæƒé‡è·¯ç”±åŸç†</h3><p>Spring Cloud Gatewayä¸­æä¾›äº†<code>org.springframework.cloud.gateway.handler.predicate.WeightRoutePredicateFactory</code>å»å®ç°æ ¹æ®åˆ†ç»„è®¾ç½®æƒé‡è¿›è¡Œè·¯ç”±ï¼Œå› æ­¤ä½¿ç”¨èµ·æ¥ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œæœ‰å…´è¶£çš„å¯ä»¥debugé˜…è¯»æºç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeightRoutePredicateFactory</span> <span class="keyword">extends</span> <span class="title">AbstractRoutePredicateFactory</span>&lt;<span class="title">WeightConfig</span>&gt; <span class="keyword">implements</span> <span class="title">ApplicationEventPublisherAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Log log = LogFactory.getLog(WeightRoutePredicateFactory.class);</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String GROUP_KEY = WeightConfig.CONFIG_PREFIX + <span class="string">".group"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String WEIGHT_KEY = WeightConfig.CONFIG_PREFIX + <span class="string">".weight"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> ApplicationEventPublisher publisher;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">WeightRoutePredicateFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">super</span>(WeightConfig.class);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationEventPublisher</span><span class="params">(ApplicationEventPublisher publisher)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.publisher = publisher;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">shortcutFieldOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> Arrays.asList(GROUP_KEY, WEIGHT_KEY);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">shortcutFieldPrefix</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> WeightConfig.CONFIG_PREFIX;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeApply</span><span class="params">(WeightConfig config)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (publisher != <span class="keyword">null</span>) &#123;</span><br><span class="line">publisher.publishEvent(<span class="keyword">new</span> WeightDefinedEvent(<span class="keyword">this</span>, config));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Predicate&lt;ServerWebExchange&gt; <span class="title">apply</span><span class="params">(WeightConfig config)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> exchange -&gt; &#123;</span><br><span class="line">Map&lt;String, String&gt; weights = exchange.getAttributeOrDefault(WEIGHT_ATTR,</span><br><span class="line">Collections.emptyMap());</span><br><span class="line"></span><br><span class="line">String routeId = exchange.getAttribute(GATEWAY_PREDICATE_ROUTE_ATTR);</span><br><span class="line"></span><br><span class="line"><span class="comment">// all calculations and comparison against random num happened in</span></span><br><span class="line"><span class="comment">// WeightCalculatorWebFilter</span></span><br><span class="line">String group = config.getGroup();</span><br><span class="line"><span class="keyword">if</span> (weights.containsKey(group)) &#123;</span><br><span class="line"></span><br><span class="line">String chosenRoute = weights.get(group);</span><br><span class="line"><span class="keyword">if</span> (log.isTraceEnabled()) &#123;</span><br><span class="line">log.trace(<span class="string">"in group weight: "</span>+ group + <span class="string">", current route: "</span> + routeId +<span class="string">", chosen route: "</span> + chosenRoute);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> routeId.equals(chosenRoute);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-Spring-Cloud-Gatewayä¸­çš„æƒé‡è·¯ç”±æ¡ˆä¾‹"><a href="#2-Spring-Cloud-Gatewayä¸­çš„æƒé‡è·¯ç”±æ¡ˆä¾‹" class="headerlink" title="2.Spring Cloud Gatewayä¸­çš„æƒé‡è·¯ç”±æ¡ˆä¾‹"></a>2.Spring Cloud Gatewayä¸­çš„æƒé‡è·¯ç”±æ¡ˆä¾‹</h2><h3 id="2-1-æ¡ˆä¾‹ä»£ç åœ°å€"><a href="#2-1-æ¡ˆä¾‹ä»£ç åœ°å€" class="headerlink" title="2.1 æ¡ˆä¾‹ä»£ç åœ°å€"></a>2.1 æ¡ˆä¾‹ä»£ç åœ°å€</h3><p><a href="https://github.com/SoftwareKing/sc-gateway/tree/master/ch4" target="_blank" rel="noopener">https://github.com/SoftwareKing/sc-gateway/tree/master/ch4</a></p><h3 id="2-2-Spring-Cloud-Gateway-Serverè¯´æ˜"><a href="#2-2-Spring-Cloud-Gateway-Serverè¯´æ˜" class="headerlink" title="2.2 Spring Cloud Gateway Serverè¯´æ˜"></a>2.2 Spring Cloud Gateway Serverè¯´æ˜</h3><p>Spring Cloud Gateway will dispatch 95% of the requests to version 1 and 5% of the traffic to version 2 of a specified service, as shown by the following figure.</p><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/f8e439776d6bbff94993fafdfc02b98c.png?Expires=1843885017&amp;OSSAccessKeyId=LTAI57F52hRuWq3h&amp;Signature=a8ZhI5O5y7Gs7TP4eusGOT7qdoE%3D" alt=""></p><p>æˆ‘ä»¬é€šè¿‡åœ¨Spring Cloud Gatewayä¸­ä¼šé…ç½®ä¸åŒçš„æƒé‡ä¿¡æ¯åˆ°ä¸åŒURLä¸Šï¼ŒSpring Cloud Gatewayä¼šæ ¹æ®æˆ‘ä»¬é…ç½®çš„è·¯ç”±æƒé‡ä¿¡æ¯ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°ä¸åŒçš„æºæœåŠ¡ç»„ï¼Œæƒé‡ä¿¡æ¯å¦‚ch4/ch4-gatewayä¸­çš„application.ymlæ‰€ç¤ºï¼Œä¸»è¦é…ç½®ä¿¡æ¯å¦‚ä¸‹ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  application:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">ch4-gateway</span></span><br><span class="line"><span class="attr">  cloud:</span></span><br><span class="line"><span class="attr">    gateway:</span></span><br><span class="line"><span class="attr">      routes:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">      - id:</span> <span class="string">service1_v1</span></span><br><span class="line"><span class="attr">        uri:</span> <span class="attr">http://localhost:8081/v1</span></span><br><span class="line"><span class="attr">        predicates:</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">Path=/test</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">Weight=service1,</span> <span class="number">95</span></span><br><span class="line"></span><br><span class="line"><span class="attr">      - id:</span> <span class="string">service1_v2</span></span><br><span class="line"><span class="attr">        uri:</span> <span class="attr">http://localhost:8081/v2</span></span><br><span class="line"><span class="attr">        predicates:</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">Path=/test</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">Weight=service1,</span> <span class="number">5</span></span><br></pre></td></tr></table></figure><blockquote><p>Weight=service1, 95ï¼ŒWeight=service1, 5å°±æ˜¯è·¯ç”±çš„æƒé‡ä¿¡æ¯ã€‚</p></blockquote><h3 id="2-3-æºæœåŠ¡"><a href="#2-3-æºæœåŠ¡" class="headerlink" title="2.3 æºæœåŠ¡"></a>2.3 æºæœåŠ¡</h3><p>æºæœåŠ¡åœ¨æœ¬æ¡ˆä¾‹ä¸­æºæœåŠ¡å¦‚ch4-service-provideræ‰€ç¤ºï¼Œä¸»è¦ææä¾›Gateway Serveræƒé‡è·¯ç”±å¯¹åº”çš„åç«¯æºæœåŠ¡ã€‚å› ä¸ºæ¯”è¾ƒç®€å•å› æ­¤ä¸åšè¯¦ç»†è¯´æ˜ï¼Œä¸»è¦ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.xujin.sc.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/v1"</span>, produces = <span class="string">"text/plain;charset=UTF-8"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Mono&lt;String&gt; <span class="title">v1</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> Mono.just(<span class="string">"v1"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/v2"</span>, produces = <span class="string">"text/plain;charset=UTF-8"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Mono&lt;String&gt; <span class="title">v2</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> Mono.just(<span class="string">"v2"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-4-æµ‹è¯•"><a href="#2-4-æµ‹è¯•" class="headerlink" title="2.4 æµ‹è¯•"></a>2.4 æµ‹è¯•</h3><p>åˆ†åˆ«å¯åŠ¨ch4-gatewayï¼Œch4-service-providerè¿›è¡Œè®¿é—®:<a href="http://localhost:8080/test" target="_blank" rel="noopener">http://localhost:8080/test</a> æµ‹è¯•,å‘ç°ä¼šæ ¹æ®æ‰€è®¾æƒé‡è¿›è¡Œè·¯ç”±ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬æ–‡ä¸»è¦é€šè¿‡è¿ç”¨Spring Cloud Gatewayçš„WeightRoutePredicateFactoryå¯¹URLè¿›è¡Œæƒé‡è·¯ç”±ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/categories/Spring-Cloud-Gateway/"/>
    
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/tags/Spring-Cloud-Gateway/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud Gatewayä¸­çš„GatewayFilterå’ŒGlobalFilter</title>
    <link href="http://xujin.org/sc/gw/gw07/"/>
    <id>http://xujin.org/sc/gw/gw07/</id>
    <published>2018-05-26T06:00:00.000Z</published>
    <updated>2019-01-12T03:30:42.775Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬æ–‡ä¸»è¦ä»‹ç»äº†ä»€ä¹ˆæ˜¯GatewayFilterå’ŒGlobalFilterï¼Œä»¥åŠåŒºåˆ«å’Œè”ç³»ã€‚ç„¶åä»‹ç»å¦‚ä½•åœ¨Spring Cloud Gatewayä¸­è‡ªå®šä¹‰ä½¿ç”¨GatewayFilterå’ŒGlobalFilterã€‚</p><a id="more"></a><h2 id="1-Spring-Cloud-gatewayçš„Filter"><a href="#1-Spring-Cloud-gatewayçš„Filter" class="headerlink" title="1. Spring Cloud gatewayçš„Filter"></a>1. Spring Cloud gatewayçš„Filter</h2><p>Spring Cloud gatewayä¸­çš„Filterä»æ¥å£å®ç°ä¸Šåˆ†ä¸ºä¸¤ç§ä¸€ç§æ˜¯GatewayFilterï¼Œå¦å¤–ä¸€ç§æ˜¯GlobalFilterã€‚</p><h2 id="1-1-GatewayFilterä¸GlobalFilterçš„åŒºåˆ«"><a href="#1-1-GatewayFilterä¸GlobalFilterçš„åŒºåˆ«" class="headerlink" title="1.1 GatewayFilterä¸GlobalFilterçš„åŒºåˆ«"></a>1.1 GatewayFilterä¸GlobalFilterçš„åŒºåˆ«</h2><p>åŒºåˆ«ç”¨è‹±è¯­å¯ä»¥æ€»ç»“å¦‚ä¸‹:<br>At a high level global filters are applied to all routes, while a gateway filter will be applied to an individual route(s)</p><blockquote><p>åœ¨ä¸€ä¸ªé«˜çš„è§’åº¦æ¥çœ‹ï¼ŒGlobal filtersä¼šè¢«åº”ç”¨åˆ°æ‰€æœ‰çš„è·¯ç”±ä¸Šï¼Œè€ŒGateway filterå°†åº”ç”¨åˆ°<code>å•ä¸ªè·¯ç”±</code>ä¸Šæˆ–è€…<code>ä¸€ä¸ªåˆ†ç»„çš„è·¯ç”±</code>ä¸Šã€‚åœ¨ä¸‹é¢çš„æ¡ˆä¾‹ä¸­å°†ä¼šè¿›è¡Œè¯´æ˜ã€‚</p></blockquote><h2 id="1-2-æœ¬æ–‡ä»£ç åœ°å€"><a href="#1-2-æœ¬æ–‡ä»£ç åœ°å€" class="headerlink" title="1.2 æœ¬æ–‡ä»£ç åœ°å€"></a>1.2 æœ¬æ–‡ä»£ç åœ°å€</h2><blockquote><p><a href="https://github.com/SoftwareKing/sc-gateway/tree/master/ch2" target="_blank" rel="noopener">https://github.com/SoftwareKing/sc-gateway/tree/master/ch2</a></p></blockquote><h2 id="2-GatewayFilterå’ŒGlobalFilter"><a href="#2-GatewayFilterå’ŒGlobalFilter" class="headerlink" title="2. GatewayFilterå’ŒGlobalFilter"></a>2. GatewayFilterå’ŒGlobalFilter</h2><h3 id="2-1-GatewayFilter"><a href="#2-1-GatewayFilter" class="headerlink" title="2.1 GatewayFilter"></a>2.1 GatewayFilter</h3><h4 id="2-1-1-ä»€ä¹ˆæ˜¯GatewayFilter"><a href="#2-1-1-ä»€ä¹ˆæ˜¯GatewayFilter" class="headerlink" title="2.1.1 ä»€ä¹ˆæ˜¯GatewayFilter"></a>2.1.1 ä»€ä¹ˆæ˜¯GatewayFilter</h4><p>Contract for interception-style, chained processing of Web requests that may be used to implement cross-cutting, application-agnostic requirements such<br> as security, timeouts, and others. Specific to a Gateway Copied from WebFilter</p><blockquote><p>GatewayFilteræ˜¯ä»WebFilterä¸­Copyè¿‡æ¥çš„ï¼Œç›¸å½“äºä¸€ä¸ªFilterè¿‡æ»¤å™¨ï¼Œå¯ä»¥å¯¹è®¿é—®çš„URLè¿‡æ»¤æ¨ªåˆ‡å¤„ç†ï¼Œåº”ç”¨åœºæ™¯æ¯”å¦‚è¶…æ—¶ï¼Œå®‰å…¨ç­‰ã€‚</p></blockquote><p>ä»Spring Cloud Gatewayçš„æºç ä¸­å¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹å‡ºGatewayFilterçš„ä½¿ç”¨åœºæ™¯:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Contract for interception-style, chained processing of Web requests that may</span></span><br><span class="line"><span class="comment"> * be used to implement cross-cutting, application-agnostic requirements such</span></span><br><span class="line"><span class="comment"> * as security, timeouts, and others. Specific to a Gateway</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Copied from WebFilter</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Rossen Stoyanchev</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 5.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GatewayFilter</span> <span class="keyword">extends</span> <span class="title">ShortcutConfigurable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">String NAME_KEY = <span class="string">"name"</span>;</span><br><span class="line">String VALUE_KEY = <span class="string">"value"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Process the Web request and (optionally) delegate to the next</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> WebFilter&#125; through the given &#123;<span class="doctag">@link</span> GatewayFilterChain&#125;.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> exchange the current server exchange</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> chain provides a way to delegate to the next filter</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> Mono&lt;Void&gt;&#125; to indicate when request processing is complete</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Mono&lt;Void&gt; <span class="title">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GatewayFilterå’ŒGlobalFilterä¸¤ä¸ªæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ä¸€æ ·éƒ½æ˜¯Mono<void> filter(ServerWebExchange exchange, GatewayFilterChain chain)ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯GatewayFilterç»§æ‰¿äº†ShortcutConfigurableï¼ŒGlobalFilteræ²¡æœ‰ä»»ä½•ç»§æ‰¿ã€‚</void></p></blockquote><h5 id="2-1-2-è‡ªå®šä¹‰GatewayFilter-Custom-GatewayFilter"><a href="#2-1-2-è‡ªå®šä¹‰GatewayFilter-Custom-GatewayFilter" class="headerlink" title="2.1.2 è‡ªå®šä¹‰GatewayFilter(Custom GatewayFilter)"></a>2.1.2 è‡ªå®šä¹‰GatewayFilter(Custom GatewayFilter)</h5><p>å¦‚org.xujin.sc.filter.CustomFilterä»£ç æ‰€ç¤ºï¼Œé€šè¿‡è‡ªå®šä¹‰GatewayFilterå¯¹è·¯ç”±è½¬å‘çš„å¤„ç†æ—¶é•¿ç»Ÿè®¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.xujin.sc.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.logging.Log;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.logging.LogFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.filter.GatewayFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.filter.GatewayFilterChain;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.Ordered;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.server.ServerWebExchange;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»Ÿè®¡æŸä¸ªæˆ–è€…æŸç§è·¯ç”±çš„çš„å¤„ç†æ—¶é•¿</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> xujin</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomFilter</span> <span class="keyword">implements</span> <span class="title">GatewayFilter</span>, <span class="title">Ordered</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Log log = LogFactory.getLog(GatewayFilter.class);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String COUNT_Start_TIME = <span class="string">"countStartTime"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> </span>&#123;</span><br><span class="line">        exchange.getAttributes().put(COUNT_Start_TIME, System.currentTimeMillis());</span><br><span class="line">        <span class="keyword">return</span> chain.filter(exchange).then(</span><br><span class="line">                Mono.fromRunnable(() -&gt; &#123;</span><br><span class="line">                    Long startTime = exchange.getAttribute(COUNT_Start_TIME);</span><br><span class="line">                    Long endTime=(System.currentTimeMillis() - startTime);</span><br><span class="line">                    <span class="keyword">if</span> (startTime != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        log.info(exchange.getRequest().getURI().getRawPath() + <span class="string">": "</span> + endTime + <span class="string">"ms"</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Ordered.LOWEST_PRECEDENCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-1-3-Gateway-Filterä¸RouteLocatorç»‘å®šä½¿ç”¨"><a href="#2-1-3-Gateway-Filterä¸RouteLocatorç»‘å®šä½¿ç”¨" class="headerlink" title="2.1.3 Gateway Filterä¸RouteLocatorç»‘å®šä½¿ç”¨"></a>2.1.3 Gateway Filterä¸RouteLocatorç»‘å®šä½¿ç”¨</h4><p>åœ¨org.xujin.sc.GatewayServerApplicationä¸­customerRouteLocatorå¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayServerApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RouteLocator <span class="title">customerRouteLocator</span><span class="params">(RouteLocatorBuilder builder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> builder.routes()</span><br><span class="line">                .route(r -&gt; r.path(<span class="string">"/test/prefix/**"</span>)</span><br><span class="line">                        .filters(f -&gt; f.stripPrefix(<span class="number">2</span>)</span><br><span class="line">                                .filter(<span class="keyword">new</span> CustomFilter())</span><br><span class="line">                                .addResponseHeader(<span class="string">"X-Response-test"</span>, <span class="string">"test"</span>))</span><br><span class="line">                        .uri(<span class="string">"lb://SC-CONSUMER"</span>)</span><br><span class="line">                        .order(<span class="number">0</span>)</span><br><span class="line">                        .id(<span class="string">"test_consumer_service"</span>)</span><br><span class="line">                )</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(GatewayServerApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><p>r.path(â€œ/test/prefix/**â€)è¡¨ç¤ºè‡ªå®šä¹‰äº†è®¿é—®å‰ç¼€ï¼Œåœ¨çœŸæ­£çš„Gatewayè¿›è¡Œè·¯ç”±è½¬å‘çš„æ—¶å€™ï¼Œä¼šç”¨è¿‡f.stripPrefix(2)æŠŠå‰ç¼€å»æ‰ã€‚</p><blockquote><p>ä½¿ç”¨åœºæ™¯:å¯ä»¥æŠŠå¯¹å¤–æš´éœ²çš„URLé€šè¿‡åŠ å‰ç¼€åˆ†ç»„æ‰“æ ‡ã€‚</p></blockquote></li><li><p>filter(new CustomFilter()</p><blockquote><p>filter(new CustomFilter()ï¼Œè¡¨ç¤ºæŠŠè‡ªå®šä¹‰çš„FilteråŠ åˆ°Filteré“¾é‡Œé¢æ‰§è¡Œï¼Œæ³¨æ„ä¸€ç‚¹æ˜¯è‡ªå®šä¹‰GlobalFilterä¸éœ€è¦åŠ è¿›å»ã€‚</p></blockquote></li><li><p>uri(â€œlb://SC-CONSUMERâ€)</p><blockquote><p>uri(â€œlb://SC-CONSUMERâ€)è¡¨ç¤ºSpring Cloud Gatewayå¯¹spring.application.nameç­‰äºsc-consumeræºæœåŠ¡åº”ç”¨ä¸­çš„URLè¿›è¡Œåè®®é€‚é…è½¬å‘ã€‚</p></blockquote></li></ol><h4 id="2-1-4-æµ‹è¯•å¦‚ä¸‹"><a href="#2-1-4-æµ‹è¯•å¦‚ä¸‹" class="headerlink" title="2.1.4 æµ‹è¯•å¦‚ä¸‹:"></a>2.1.4 æµ‹è¯•å¦‚ä¸‹:</h4><p>1.è®¿é—®<a href="http://localhost:9000/SC-CONSUMER/hello/xujin" target="_blank" rel="noopener">http://localhost:9000/SC-CONSUMER/hello/xujin</a> èƒ½æ­£å¸¸è®¿é—®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DEBUG 31658 --- [ctor-http-nio-2] o.s.c.g.h.RoutePredicateHandlerMapping   : Route matched: CompositeDiscoveryClient_SC-CONSUMER</span><br><span class="line">2018-05-27 09:58:07.905 DEBUG 31658 --- [ctor-http-nio-2] o.s.c.g.h.RoutePredicateHandlerMapping   : Mapping [Exchange: GET http://localhost:9000/SC-CONSUMER/hello/xujin] to Route&#123;id='CompositeDiscoveryClient_SC-CONSUMER', uri=lb://SC-CONSUMER, order=0, predicate=org.springframework.cloud.gateway.handler.predicate.PathRoutePredicateFactory$$Lambda$337/1295338046@f2ff0c8, gatewayFilters=[OrderedGatewayFilter&#123;delegate=org.springframework.cloud.gateway.filter.factory.RewritePathGatewayFilterFactory$$Lambda$717/1168359877@1f74a2b, order=1&#125;]&#125;</span><br><span class="line">2018-05-27 09:58:07.905 DEBUG 31658 --- [ctor-http-nio-2] o.s.c.g.handler.FilteringWebHandler      : Sorted gatewayFilterFactories: [OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.NettyWriteResponseFilter@f5bf288&#125;, order=-1&#125;, OrderedGatewayFilter&#123;delegate=org.springframework.cloud.gateway.filter.factory.RewritePathGatewayFilterFactory$$Lambda$717/1168359877@1f74a2b, order=1&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.RouteToRequestUrlFilter@26c77f54&#125;, order=10000&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.LoadBalancerClientFilter@4c38cd16&#125;, order=10100&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.AdaptCachedBodyGlobalFilter@2c1d57bc&#125;, order=2147483637&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.WebsocketRoutingFilter@6e9a0bea&#125;, order=2147483646&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.NettyRoutingFilter@7ddcb0dc&#125;, order=2147483647&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.ForwardRoutingFilter@3e856100&#125;, order=2147483647&#125;]</span><br></pre></td></tr></table></figure><blockquote><p>ä»ä¸Šé¢çš„æ§åˆ¶å°æ‰“å°æ—¥å¿—å¯ä»¥çœ‹å‡ºï¼Œæ²¡æœ‰æ‰“å°å‡ºè¯¥URLå¯¹åº”çš„è€—æ—¶ã€‚</p></blockquote><p>2.åŠ ä¸ŠURLå‰ç¼€/test/prefix/è®¿é—®ï¼Œæµ‹è¯•URLä¸º<br><a href="http://localhost:9000/test/prefix/hello/testCustomFilter/xujin" target="_blank" rel="noopener">http://localhost:9000/test/prefix/hello/testCustomFilter/xujin</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2018-05-27 10:01:56.057 DEBUG 31658 --- [ctor-http-nio-2] o.s.c.g.h.RoutePredicateHandlerMapping   : Mapping [Exchange: GET http://localhost:9000/test/prefix/hello/testCustomFilter/xujin] to Route&#123;id='test_consumer_service', uri=lb://SC-CONSUMER, order=0, predicate=org.springframework.cloud.gateway.handler.predicate.PathRoutePredicateFactory$$Lambda$337/1295338046@6dbaa72e, gatewayFilters=[OrderedGatewayFilter&#123;delegate=org.springframework.cloud.gateway.filter.factory.StripPrefixGatewayFilterFactory$$Lambda$340/1149217113@41fb2078, order=0&#125;, org.xujin.sc.filter.CustomFilter@281885a3, OrderedGatewayFilter&#123;delegate=org.springframework.cloud.gateway.filter.factory.AddResponseHeaderGatewayFilterFactory$$Lambda$342/1099925775@4705cae6, order=0&#125;]&#125;</span><br><span class="line">2018-05-27 10:01:56.057 DEBUG 31658 --- [ctor-http-nio-2] o.s.c.g.handler.FilteringWebHandler      : Sorted gatewayFilterFactories: [OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.NettyWriteResponseFilter@f5bf288&#125;, order=-1&#125;, OrderedGatewayFilter&#123;delegate=org.springframework.cloud.gateway.filter.factory.StripPrefixGatewayFilterFactory$$Lambda$340/1149217113@41fb2078, order=0&#125;, OrderedGatewayFilter&#123;delegate=org.springframework.cloud.gateway.filter.factory.AddResponseHeaderGatewayFilterFactory$$Lambda$342/1099925775@4705cae6, order=0&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.RouteToRequestUrlFilter@26c77f54&#125;, order=10000&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.LoadBalancerClientFilter@4c38cd16&#125;, order=10100&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.AdaptCachedBodyGlobalFilter@2c1d57bc&#125;, order=2147483637&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.WebsocketRoutingFilter@6e9a0bea&#125;, order=2147483646&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.NettyRoutingFilter@7ddcb0dc&#125;, order=2147483647&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.ForwardRoutingFilter@3e856100&#125;, order=2147483647&#125;, org.xujin.sc.filter.CustomFilter@281885a3]</span><br><span class="line">2018-05-27 10:02:00.347  INFO 31658 --- [ctor-http-nio-8] o.s.cloud.gateway.filter.GatewayFilter   : /hello/testCustomFilter/xujin: 859ms</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚ä¸Šæ—¥å¿—å¯ä»¥çœ‹åˆ°/hello/testCustomFilter/xujin: 859msï¼ŒGatewayè½¬å‘çš„æ—¶å€™å»æ‰äº†å‰ç¼€ã€‚</p></blockquote><h3 id="2-2-GlobalFilter"><a href="#2-2-GlobalFilter" class="headerlink" title="2.2 GlobalFilter"></a>2.2 GlobalFilter</h3><h4 id="2-2-1-ä»€ä¹ˆæ˜¯GlobalFilter"><a href="#2-2-1-ä»€ä¹ˆæ˜¯GlobalFilter" class="headerlink" title="2.2.1 ä»€ä¹ˆæ˜¯GlobalFilter"></a>2.2.1 ä»€ä¹ˆæ˜¯GlobalFilter</h4><blockquote><p>The GlobalFilter interface has the same signature as GatewayFilter. These are special filters that are conditionally applied to all routes. (This interface and usage are subject to change in future milestones).</p></blockquote><p>Spring Cloud gatewayå®šä¹‰äº†GlobalFilterçš„æ¥å£è®©æˆ‘ä»¬å»è‡ªå®šä¹‰å®ç°è‡ªå·±çš„çš„GlobalFilterã€‚GlobalFilteræ˜¯ä¸€ä¸ªå…¨å±€çš„Filterï¼Œä½œç”¨äºæ‰€æœ‰çš„è·¯ç”±ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GlobalFilter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Process the Web request and (optionally) delegate to the next</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> WebFilter&#125; through the given &#123;<span class="doctag">@link</span> GatewayFilterChain&#125;.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> exchange the current server exchange</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> chain provides a way to delegate to the next filter</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> Mono&lt;Void&gt;&#125; to indicate when request processing is complete</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Mono&lt;Void&gt; <span class="title">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-2-2-è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨-Custom-GlobalFilter"><a href="#2-2-2-è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨-Custom-GlobalFilter" class="headerlink" title="2.2.2 è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨(Custom GlobalFilter)"></a>2.2.2 è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨(Custom GlobalFilter)</h4><p>åœ¨è¿™é‡Œç®€å•å®šä¹‰AuthSignatureFilterå®ç°<code>GlobalFilter</code>ï¼Œä½¿ç”¨åœºæ™¯å°±æ˜¯Gatewayå¯¹è¯·æ±‚çš„URLæ ¡éªŒæƒé™ï¼Œåˆ¤æ–­è¯·æ±‚çš„URLæ˜¯å¦æ˜¯åˆæ³•è¯·æ±‚ã€‚é€šè¿‡ä»ServerWebExchangeè·å–è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­authTokenå¯¹åº”çš„å€¼ï¼Œè¿›è¡Œåˆ¤nullå¤„ç†ï¼Œå…¶å®ƒçš„checké€»è¾‘å¯ä»¥è‡ªå®šå®šåˆ¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.xujin.sc.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.filter.GatewayFilterChain;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.filter.GlobalFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.Ordered;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpStatus;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.server.ServerWebExchange;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è°ƒç”¨é‰´æƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthSignatureFilter</span> <span class="keyword">implements</span> <span class="title">GlobalFilter</span>, <span class="title">Ordered</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> </span>&#123;</span><br><span class="line">        String token = exchange.getRequest().getQueryParams().getFirst(<span class="string">"authToken"</span>);</span><br><span class="line">        <span class="keyword">if</span> (token == <span class="keyword">null</span> || token.isEmpty()) &#123;</span><br><span class="line">            exchange.getResponse().setStatusCode(HttpStatus.UNAUTHORIZED);</span><br><span class="line">            <span class="keyword">return</span> exchange.getResponse().setComplete();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> chain.filter(exchange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">200</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>GlobalFilterå†™å®Œäº†ï¼Œé‚£é—®é¢˜æ¥äº†ï¼Ÿå¦‚ä½•è®©å…¶åœ¨Gatewayä¸­è¿è¡Œç”Ÿæ•ˆï¼Œæœ‰ä¸¤ç§æ–¹å¼ä¸€ç§ç›´æ¥åŠ <code>@Component</code>æ³¨è§£ï¼Œå¦å¤–ä¸€ç§å¯ä»¥åœ¨ Spring Config ä¸­é…ç½®è¿™ä¸ª Beanå¦‚ä¸‹æ‰€ç¤º:</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> AuthSignatureFilter <span class="title">authSignatureFilter</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> AuthSignatureFilter();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><p>1.è®¿é—®<a href="http://localhost:9000/test/prefix/hello/testCustomFilter/xujin" target="_blank" rel="noopener">http://localhost:9000/test/prefix/hello/testCustomFilter/xujin</a> å¦‚ä¸‹æ‰€ç¤ºç”±äºauthTokenä¸ºç©º401è¿”å›.</p><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/91ce199f4af8f4bd9576aace65940253.jpeg?Expires=1842749245&amp;OSSAccessKeyId=LTAI57F52hRuWq3h&amp;Signature=Is0KT0QAVXkPS20EdSPvDqmlxmc%3D" alt=""></p><p>2.è®¿é—®<a href="http://localhost:9000/test/prefix/hello/testCustomFilter/xujin?authToken=asdasdsddasadsadsadsdadsewew32rg" target="_blank" rel="noopener">http://localhost:9000/test/prefix/hello/testCustomFilter/xujin?authToken=asdasdsddasadsadsadsdadsewew32rg</a></p><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/86509f882391c3a20d2f32778dd1c2e9.jpeg?Expires=1842749511&amp;OSSAccessKeyId=LTAI57F52hRuWq3h&amp;Signature=lAd7U0lj4WZ0HMWF9SpbfKJ4aR8%3D" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬æ–‡ä¸»è¦ä»‹ç»äº†ä»€ä¹ˆæ˜¯GatewayFilterå’ŒGlobalFilterï¼Œä»¥åŠåŒºåˆ«å’Œè”ç³»ã€‚ç„¶åä»‹ç»å¦‚ä½•åœ¨Spring Cloud Gatewayä¸­è‡ªå®šä¹‰ä½¿ç”¨GatewayFilterå’ŒGlobalFilterã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/categories/Spring-Cloud-Gateway/"/>
    
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/tags/Spring-Cloud-Gateway/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud GatewayåŸºäºæœåŠ¡å‘ç°çš„é»˜è®¤è·¯ç”±è§„åˆ™</title>
    <link href="http://xujin.org/sc/gw/gw05/"/>
    <id>http://xujin.org/sc/gw/gw05/</id>
    <published>2018-05-21T06:00:00.000Z</published>
    <updated>2019-01-12T03:35:27.669Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†Spring Cloud Gatewayçš„åŸºäºæœåŠ¡å‘ç°çš„é»˜è®¤è·¯ç”±è§„åˆ™ï¼Œä»ä¸­å¯ä»¥çœ‹å‡ºGatewayçš„è·¯ç”±è§„åˆ™:<a href="http://Gateway_HOST:Gateway_PORT/å¤§å†™çš„serviceId/*" target="_blank" rel="noopener">http://Gateway_HOST:Gateway_PORT/å¤§å†™çš„serviceId/*</a> å’Œ zuulçš„é»˜è®¤è·¯ç”±è§„åˆ™<a href="http://ZUUL_HOST:ZUUL_PORT/å¾®æœåŠ¡åœ¨Eurekaä¸Šçš„serviceId/*å·®ä¸å¤šã€‚" target="_blank" rel="noopener">http://ZUUL_HOST:ZUUL_PORT/å¾®æœåŠ¡åœ¨Eurekaä¸Šçš„serviceId/*å·®ä¸å¤šã€‚</a></p><a id="more"></a><h2 id="1-Spring-Gatewayæ¦‚è¿°"><a href="#1-Spring-Gatewayæ¦‚è¿°" class="headerlink" title="1.Spring Gatewayæ¦‚è¿°"></a>1.Spring Gatewayæ¦‚è¿°</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯Spring-Cloud-Gateway"><a href="#1-1-ä»€ä¹ˆæ˜¯Spring-Cloud-Gateway" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯Spring Cloud Gateway"></a>1.1 ä»€ä¹ˆæ˜¯Spring Cloud Gateway</h3><p>   <code>Spring Cloud Gateway</code>æ˜¯Springå®˜æ–¹åŸºäºSpring 5.0ï¼ŒSpring Boot 2.0å’ŒProject Reactorç­‰æŠ€æœ¯å¼€å‘çš„ç½‘å…³ï¼ŒSpring Cloud Gatewayæ—¨åœ¨ä¸ºå¾®æœåŠ¡æ¶æ„æä¾›ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„ç»Ÿä¸€çš„APIè·¯ç”±ç®¡ç†æ–¹å¼ã€‚Spring Cloud Gatewayä½œä¸ºSpring Cloudç”Ÿæ€ç³»ä¸­çš„ç½‘å…³ï¼Œç›®æ ‡æ˜¯æ›¿ä»£Netflix ZUULï¼Œå…¶ä¸ä»…æä¾›ç»Ÿä¸€çš„è·¯ç”±æ–¹å¼ï¼Œå¹¶ä¸”åŸºäºFilteré“¾çš„æ–¹å¼æä¾›äº†ç½‘å…³åŸºæœ¬çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šå®‰å…¨ï¼Œç›‘æ§/åŸ‹ç‚¹ï¼Œå’Œé™æµç­‰ã€‚</p><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/3f25fcd95769a54eb391931449d5298f.jpg?Expires=1841935182&amp;OSSAccessKeyId=LTAI57F52hRuWq3h&amp;Signature=F%2BSKuTDpXoj5xCXwIIJ4u8D1C2A%3D" alt=""></p><h3 id="1-2-Spring-Cloud-Gatewayçš„åŠŸèƒ½"><a href="#1-2-Spring-Cloud-Gatewayçš„åŠŸèƒ½" class="headerlink" title="1.2 Spring Cloud Gatewayçš„åŠŸèƒ½"></a>1.2 Spring Cloud Gatewayçš„åŠŸèƒ½</h3><p>Spring Cloud Gateway çš„ç‰¹å¾ï¼š</p><ul><li>åŸºäº Spring Framework 5ï¼ŒProject Reactor å’Œ Spring Boot 2.0<br>åŠ¨æ€è·¯ç”±</li><li>Predicates å’Œ Filters ä½œç”¨äºç‰¹å®šè·¯ç”±</li><li>é›†æˆ Hystrix æ–­è·¯å™¨</li><li>é›†æˆ Spring Cloud DiscoveryClient</li><li>æ˜“äºç¼–å†™çš„ Predicates å’Œ Filters</li><li>é™æµ</li><li>è·¯å¾„é‡å†™</li></ul><h2 id="2-Spring-Cloud-Gatewayçš„å·¥ç¨‹æµç¨‹"><a href="#2-Spring-Cloud-Gatewayçš„å·¥ç¨‹æµç¨‹" class="headerlink" title="2. Spring Cloud Gatewayçš„å·¥ç¨‹æµç¨‹"></a>2. Spring Cloud Gatewayçš„å·¥ç¨‹æµç¨‹</h2><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/22e4eccf2cbe09332678c04b8de98ebe.jpg?Expires=1841935407&amp;OSSAccessKeyId=LTAI57F52hRuWq3h&amp;Signature=NHcssduqPTQry7HCmudjphw0qC4%3D" alt=""></p><p>   å®¢æˆ·ç«¯å‘ Spring Cloud Gateway å‘å‡ºè¯·æ±‚ã€‚ç„¶ååœ¨ Gateway Handler Mapping ä¸­æ‰¾åˆ°ä¸è¯·æ±‚ç›¸åŒ¹é…çš„è·¯ç”±ï¼Œå°†å…¶å‘é€åˆ° Gateway Web Handlerã€‚Handler å†é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨é“¾æ¥å°†è¯·æ±‚å‘é€åˆ°æˆ‘ä»¬å®é™…çš„æœåŠ¡æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œç„¶åè¿”å›ã€‚<br>è¿‡æ»¤å™¨ä¹‹é—´ç”¨è™šçº¿åˆ†å¼€æ˜¯å› ä¸ºè¿‡æ»¤å™¨å¯èƒ½ä¼šåœ¨å‘é€ä»£ç†è¯·æ±‚ä¹‹å‰ï¼ˆâ€œpreâ€ï¼‰æˆ–ä¹‹åï¼ˆâ€œpostâ€ï¼‰æ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€‚</p><h3 id="2-1-Preå’ŒPOSTä¸¤ç§ç±»å‹çš„è¿‡æ»¤å™¨"><a href="#2-1-Preå’ŒPOSTä¸¤ç§ç±»å‹çš„è¿‡æ»¤å™¨" class="headerlink" title="2.1 Preå’ŒPOSTä¸¤ç§ç±»å‹çš„è¿‡æ»¤å™¨"></a>2.1 Preå’ŒPOSTä¸¤ç§ç±»å‹çš„è¿‡æ»¤å™¨</h3><h2 id="3-åŸºäºæœåŠ¡å‘ç°çš„é»˜è®¤è·¯ç”±è§„åˆ™"><a href="#3-åŸºäºæœåŠ¡å‘ç°çš„é»˜è®¤è·¯ç”±è§„åˆ™" class="headerlink" title="3.åŸºäºæœåŠ¡å‘ç°çš„é»˜è®¤è·¯ç”±è§„åˆ™"></a>3.åŸºäºæœåŠ¡å‘ç°çš„é»˜è®¤è·¯ç”±è§„åˆ™</h2><h3 id="3-1-zuulå’Œgatewayçš„é»˜è®¤è·¯ç”±è§„åˆ™"><a href="#3-1-zuulå’Œgatewayçš„é»˜è®¤è·¯ç”±è§„åˆ™" class="headerlink" title="3.1 zuulå’Œgatewayçš„é»˜è®¤è·¯ç”±è§„åˆ™"></a>3.1 zuulå’Œgatewayçš„é»˜è®¤è·¯ç”±è§„åˆ™</h3><h4 id="3-1-1-zuulçš„é»˜è®¤è·¯ç”±è§„åˆ™"><a href="#3-1-1-zuulçš„é»˜è®¤è·¯ç”±è§„åˆ™" class="headerlink" title="3.1.1 zuulçš„é»˜è®¤è·¯ç”±è§„åˆ™"></a>3.1.1 zuulçš„é»˜è®¤è·¯ç”±è§„åˆ™</h4><p>è¯´æ˜é»˜è®¤æƒ…å†µä¸‹ï¼ŒZuulä¼šä»£ç†æ‰€æœ‰æ³¨å†Œåˆ°Eureka Serverçš„å¾®æœåŠ¡ï¼Œå¹¶ä¸”Zuulçš„è·¯ç”±è§„åˆ™å¦‚ä¸‹ï¼š<br>   <a href="http://ZUUL_HOST:ZUUL_PORT/å¾®æœåŠ¡åœ¨Eurekaä¸Šçš„serviceId/**" target="_blank" rel="noopener">http://ZUUL_HOST:ZUUL_PORT/å¾®æœåŠ¡åœ¨Eurekaä¸Šçš„serviceId/**</a> ä¼šè¢«è½¬å‘åˆ°serviceIdå¯¹åº”çš„å¾®æœåŠ¡ã€‚<br>   <a href="http://localhost:8040/sc-zuul-first-provider/sc/order/2" target="_blank" rel="noopener">http://localhost:8040/sc-zuul-first-provider/sc/order/2</a><br>   <img src="http://xujin.org/images/sc-study/sc-zuul-01-t1.png" alt="é»˜è®¤è·¯ç”±è§„åˆ™"></p><h4 id="3-1-2-gatewayçš„é»˜è®¤è·¯ç”±è§„åˆ™"><a href="#3-1-2-gatewayçš„é»˜è®¤è·¯ç”±è§„åˆ™" class="headerlink" title="3.1.2 gatewayçš„é»˜è®¤è·¯ç”±è§„åˆ™"></a>3.1.2 gatewayçš„é»˜è®¤è·¯ç”±è§„åˆ™</h4><p>ä¸‹é¢çš„æ¡ˆä¾‹ä¸­ä¼šæ¼”ç¤ºï¼š<a href="http://localhost:9000/SC-CONSUMER/hello/xujin" target="_blank" rel="noopener">http://localhost:9000/SC-CONSUMER/hello/xujin</a></p><blockquote><p><a href="http://Gateway_HOST:Gateway_PORT/å¤§å†™çš„serviceId/**ï¼Œå…¶ä¸­å¾®æœåŠ¡åº”ç”¨åé»˜è®¤å¤§å†™è®¿é—®ã€‚" target="_blank" rel="noopener">http://Gateway_HOST:Gateway_PORT/å¤§å†™çš„serviceId/**ï¼Œå…¶ä¸­å¾®æœåŠ¡åº”ç”¨åé»˜è®¤å¤§å†™è®¿é—®ã€‚</a></p></blockquote><h3 id="3-2-æ¡ˆä¾‹ç¤ºä¾‹ä»£ç "><a href="#3-2-æ¡ˆä¾‹ç¤ºä¾‹ä»£ç " class="headerlink" title="3.2  æ¡ˆä¾‹ç¤ºä¾‹ä»£ç "></a>3.2  æ¡ˆä¾‹ç¤ºä¾‹ä»£ç </h3><p><a href="https://github.com/SoftwareKing/sc-gateway/tree/master/ch1" target="_blank" rel="noopener">https://github.com/SoftwareKing/sc-gateway/tree/master/ch1</a></p><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/74473f8fa112dbf946452dd234be9783.jpeg?Expires=1841935730&OSSAccessKeyId=LTAI57F52hRuWq3h&Signature=8hk%2BcIs0lpEA3S01TQsu%2BVdome8%3D" width="450px" height="252px"></p><table><thead><tr><th>æ¨¡å—</th><th>è¯´æ˜</th><th>ç«¯å£</th></tr></thead><tbody><tr><td>ch1-sc-consumer</td><td>æœåŠ¡æ¶ˆè´¹è€…</td><td>8000</td></tr><tr><td>ch1-sc-eureka</td><td>Eureka Serveræ³¨å†Œä¸­å¿ƒ</td><td>8761</td></tr><tr><td>ch1-sc-gateway</td><td>Spring Cloud Gateway Sever</td><td>9000</td></tr><tr><td>ch1-sc-provider</td><td>æœåŠ¡æä¾›è€…</td><td>8001</td></tr></tbody></table><h4 id="3-2-1-ch1-sc-gatewayå·¥ç¨‹è¯´æ˜"><a href="#3-2-1-ch1-sc-gatewayå·¥ç¨‹è¯´æ˜" class="headerlink" title="3.2.1 ch1-sc-gatewayå·¥ç¨‹è¯´æ˜"></a>3.2.1 ch1-sc-gatewayå·¥ç¨‹è¯´æ˜</h4><h4 id="3-2-1-1-Mavenä¾èµ–"><a href="#3-2-1-1-Mavenä¾èµ–" class="headerlink" title="3.2.1.1  Mavenä¾èµ–"></a>3.2.1.1  Mavenä¾èµ–</h4><p>Spring Cloud Gateway severä¸»è¦çš„mavenä¾èµ–å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-1-2-ymlæ–‡ä»¶é…ç½®"><a href="#3-2-1-2-ymlæ–‡ä»¶é…ç½®" class="headerlink" title="3.2.1.2 ymlæ–‡ä»¶é…ç½®"></a>3.2.1.2 ymlæ–‡ä»¶é…ç½®</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  application:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">sc-gateway-server</span></span><br><span class="line"><span class="attr">  cloud:</span></span><br><span class="line"><span class="attr">    gateway:</span></span><br><span class="line"><span class="attr">      discovery:</span></span><br><span class="line"><span class="attr">        locator:</span></span><br><span class="line"><span class="attr">          enabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">9000</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line"><span class="attr">  client:</span></span><br><span class="line"><span class="attr">    service-url:</span></span><br><span class="line"><span class="attr">      defaultZone:</span> <span class="attr">http://localhost:8761/eureka/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="attr">  level:</span></span><br><span class="line">    <span class="string">org.springframework.cloud.gateway:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure><p>é…ç½®è¯´æ˜ï¼š</p><blockquote><p>spring.cloud.gateway.discovery.locator.enabledï¼šæ˜¯å¦ä¸æœåŠ¡å‘ç°ç»„ä»¶è¿›è¡Œç»“åˆï¼Œé€šè¿‡ serviceId è½¬å‘åˆ°å…·ä½“çš„æœåŠ¡å®ä¾‹ã€‚é»˜è®¤ä¸ºfalseï¼Œè®¾ä¸ºtrueä¾¿å¼€å¯é€šè¿‡æœåŠ¡ä¸­å¿ƒçš„è‡ªåŠ¨æ ¹æ® serviceId åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½ã€‚</p></blockquote><hr><blockquote><p>ä¿®æ”¹spring cloud gateway serverç›‘å¬çš„ç«¯å£ä¸º9000</p></blockquote><hr><blockquote><p>eureka.client.service-url.defaultZone: <a href="http://localhost:8761/eureka/,æŒ‡å®šæ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼ŒSpring" target="_blank" rel="noopener">http://localhost:8761/eureka/,æŒ‡å®šæ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼ŒSpring</a> Cloud Gatewayä»æ³¨å†Œä¸­å¿ƒè·å–å·²ç»æ³¨å†Œçš„æœåŠ¡åˆ—è¡¨ã€‚</p></blockquote><hr><blockquote><p>logging.level.org.springframework.cloud.gateway: debug,å¼€å¯spring-Cloud-gatewayçš„æ—¥å¿—çº§åˆ«ä¸ºdebugï¼Œæ–¹ä¾¿debugè°ƒè¯•ã€‚</p></blockquote><h3 id="3-3-å¯åŠ¨æµ‹è¯•"><a href="#3-3-å¯åŠ¨æµ‹è¯•" class="headerlink" title="3.3 å¯åŠ¨æµ‹è¯•"></a>3.3 å¯åŠ¨æµ‹è¯•</h3><h4 id="3-3-1-é”™è¯¯çš„è·¯ç”±è§„åˆ™è®¿é—®"><a href="#3-3-1-é”™è¯¯çš„è·¯ç”±è§„åˆ™è®¿é—®" class="headerlink" title="3.3.1 é”™è¯¯çš„è·¯ç”±è§„åˆ™è®¿é—®"></a>3.3.1 é”™è¯¯çš„è·¯ç”±è§„åˆ™è®¿é—®</h4><p>è®¿é—®Spring Cloud Gatewayå¯¹åº”çš„serverï¼Œå½“è®¿é—®<a href="http://localhost:9000/sc-consumer/hello/xujinçš„æ—¶å€™ï¼ŒæŠ¥é”™å¦‚ä¸‹æ‰€ç¤ºï¼Œæ­£ç¡®çš„Spring" target="_blank" rel="noopener">http://localhost:9000/sc-consumer/hello/xujinçš„æ—¶å€™ï¼ŒæŠ¥é”™å¦‚ä¸‹æ‰€ç¤ºï¼Œæ­£ç¡®çš„Spring</a> Cloud Gatewayçš„é»˜è®¤è·¯ç”±è§„åˆ™:<code>http://Gateway_HOST:Gateway_PORT/å¤§å†™çš„serviceId/**</code></p><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/d98d829455d0f1a180eb1b4561c7d530.jpeg?Expires=1842311197&amp;OSSAccessKeyId=LTAI57F52hRuWq3h&amp;Signature=bIbKneLe1y%2B32zADPV6uQP4B2QY%3D" alt=""></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2018-05-18 01:10:49.742 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-CONSUMER applying &#123;pattern=/SC-CONSUMER/**&#125; to Path</span><br><span class="line">2018-05-18 01:10:49.743 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-CONSUMER applying filter &#123;regexp=/SC-CONSUMER/(?&lt;remaining&gt;.*), replacement=/$&#123;remaining&#125;&#125; to RewritePath</span><br><span class="line">2018-05-18 01:10:49.743 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition matched: CompositeDiscoveryClient_SC-CONSUMER</span><br><span class="line">2018-05-18 01:10:49.744 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-PRODUCER applying &#123;pattern=/SC-PRODUCER/**&#125; to Path</span><br><span class="line">2018-05-18 01:10:49.744 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-PRODUCER applying filter &#123;regexp=/SC-PRODUCER/(?&lt;remaining&gt;.*), replacement=/$&#123;remaining&#125;&#125; to RewritePath</span><br><span class="line">2018-05-18 01:10:49.745 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition matched: CompositeDiscoveryClient_SC-PRODUCER</span><br><span class="line">2018-05-18 01:10:49.745 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-GATEWAY-SERVER applying &#123;pattern=/SC-GATEWAY-SERVER/**&#125; to Path</span><br><span class="line">2018-05-18 01:10:49.747 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-GATEWAY-SERVER applying filter &#123;regexp=/SC-GATEWAY-SERVER/(?&lt;remaining&gt;.*), replacement=/$&#123;remaining&#125;&#125; to RewritePath</span><br><span class="line">2018-05-18 01:10:49.748 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition matched: CompositeDiscoveryClient_SC-GATEWAY-SERVER</span><br><span class="line">2018-05-18 01:10:49.748 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.h.RoutePredicateHandlerMapping   : Route matched: CompositeDiscoveryClient_SC-CONSUMER</span><br><span class="line">2018-05-18 01:10:49.749 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.h.RoutePredicateHandlerMapping   : Mapping [Exchange: GET http://localhost:9000/SC-CONSUMER/hello/xujin] to Route&#123;id='CompositeDiscoveryClient_SC-CONSUMER', uri=lb://SC-CONSUMER, order=0, predicate=org.springframework.cloud.gateway.handler.predicate.PathRoutePredicateFactory$$Lambda$707/751096818@7f4c6373, gatewayFilters=[OrderedGatewayFilter&#123;delegate=org.springframework.cloud.gateway.filter.factory.RewritePathGatewayFilterFactory$$Lambda$709/672603106@293895d2, order=1&#125;]&#125;</span><br><span class="line">2018-05-18 01:10:49.749 DEBUG 6462 --- [ctor-http-nio-5] o.s.c.g.handler.FilteringWebHandler      : Sorted gatewayFilterFactories: [OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.NettyWriteResponseFilter@5e85c21b&#125;, order=-1&#125;, OrderedGatewayFilter&#123;delegate=org.springframework.cloud.gateway.filter.factory.RewritePathGatewayFilterFactory$$Lambda$709/672603106@293895d2, order=1&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.RouteToRequestUrlFilter@38e83838&#125;, order=10000&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.LoadBalancerClientFilter@6ef2f7ad&#125;, order=10100&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.AdaptCachedBodyGlobalFilter@41def031&#125;, order=2147483637&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.WebsocketRoutingFilter@4966bab1&#125;, order=2147483646&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.NettyRoutingFilter@22d477c2&#125;, order=2147483647&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.ForwardRoutingFilter@39832280&#125;, order=2147483647&#125;]</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„logï¼Œçœ‹åˆ°è¿”å›äº† 404 é”™è¯¯ï¼Œè¿›ä¸€æ­¥å¯ä»¥çœ‹åˆ° Spring Cloud Gateway å·²ç»ä¸ºæˆ‘ä»¬çš„ provider å’Œ consumer è‡ªåŠ¨åˆ›å»ºäº†å¯¹åº”çš„è·¯ç”±è½¬å‘è§„åˆ™ï¼Œä½†æ˜¯è¿™é‡Œçš„ pattern/regexp é‡Œéƒ½æ˜¯å¤§å†™çš„ï¼Œä¸‹é¢æ¢æˆå¤§å†™çš„æµ‹è¯•ä¸€ä¸‹ã€‚</p><h4 id="3-3-2-Gatewayæ­£ç¡®çš„è·¯ç”±è§„åˆ™æµ‹è¯•"><a href="#3-3-2-Gatewayæ­£ç¡®çš„è·¯ç”±è§„åˆ™æµ‹è¯•" class="headerlink" title="3.3.2 Gatewayæ­£ç¡®çš„è·¯ç”±è§„åˆ™æµ‹è¯•"></a>3.3.2 Gatewayæ­£ç¡®çš„è·¯ç”±è§„åˆ™æµ‹è¯•</h4><p>è®¿é—®æ­£ç¡®çš„<a href="http://localhost:9000/SC-CONSUMER/hello/xujinï¼Œå¯ä»¥æˆåŠŸè®¿é—®ã€‚" target="_blank" rel="noopener">http://localhost:9000/SC-CONSUMER/hello/xujinï¼Œå¯ä»¥æˆåŠŸè®¿é—®ã€‚</a></p><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/42059405c29359bcca90c14e3e1f34ca.jpeg?Expires=1842311310&amp;OSSAccessKeyId=LTAI57F52hRuWq3h&amp;Signature=eEHIkLTtbPzvhXI2OhoK0TUXwtE%3D" alt=""></p><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/ff700908c44140ec692956f4f1b526cc.jpeg?Expires=1842311231&amp;OSSAccessKeyId=LTAI57F52hRuWq3h&amp;Signature=ZPi13%2BGvvb2eEIHEqRIkzL3mwKw%3D" alt=""></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2018-05-22 09:04:21.204 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-CONSUMER applying &#123;pattern=/SC-CONSUMER/**&#125; to Path</span><br><span class="line">2018-05-22 09:04:21.205 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-CONSUMER applying filter &#123;regexp=/SC-CONSUMER/(?&lt;remaining&gt;.*), replacement=/$&#123;remaining&#125;&#125; to RewritePath</span><br><span class="line">2018-05-22 09:04:21.205 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition matched: CompositeDiscoveryClient_SC-CONSUMER</span><br><span class="line">2018-05-22 09:04:21.206 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-PRODUCER applying &#123;pattern=/SC-PRODUCER/**&#125; to Path</span><br><span class="line">2018-05-22 09:04:21.207 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-PRODUCER applying filter &#123;regexp=/SC-PRODUCER/(?&lt;remaining&gt;.*), replacement=/$&#123;remaining&#125;&#125; to RewritePath</span><br><span class="line">2018-05-22 09:04:21.207 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition matched: CompositeDiscoveryClient_SC-PRODUCER</span><br><span class="line">2018-05-22 09:04:21.208 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-GATEWAY-SERVER applying &#123;pattern=/SC-GATEWAY-SERVER/**&#125; to Path</span><br><span class="line">2018-05-22 09:04:21.208 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition CompositeDiscoveryClient_SC-GATEWAY-SERVER applying filter &#123;regexp=/SC-GATEWAY-SERVER/(?&lt;remaining&gt;.*), replacement=/$&#123;remaining&#125;&#125; to RewritePath</span><br><span class="line">2018-05-22 09:04:21.209 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.r.RouteDefinitionRouteLocator    : RouteDefinition matched: CompositeDiscoveryClient_SC-GATEWAY-SERVER</span><br><span class="line">2018-05-22 09:04:21.209 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.h.RoutePredicateHandlerMapping   : Route matched: CompositeDiscoveryClient_SC-CONSUMER</span><br><span class="line">2018-05-22 09:04:21.209 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.h.RoutePredicateHandlerMapping   : Mapping [Exchange: GET http://localhost:9000/SC-CONSUMER/hello/xujin] to Route&#123;id='CompositeDiscoveryClient_SC-CONSUMER', uri=lb://SC-CONSUMER, order=0, predicate=org.springframework.cloud.gateway.handler.predicate.PathRoutePredicateFactory$$Lambda$706/57023854@24f1a91e, gatewayFilters=[OrderedGatewayFilter&#123;delegate=org.springframework.cloud.gateway.filter.factory.RewritePathGatewayFilterFactory$$Lambda$708/2036079541@cbb7393, order=1&#125;]&#125;</span><br><span class="line">2018-05-22 09:04:21.209 DEBUG 1677 --- [ctor-http-nio-2] o.s.c.g.handler.FilteringWebHandler      : Sorted gatewayFilterFactories: [OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.NettyWriteResponseFilter@29a98d9f&#125;, order=-1&#125;, OrderedGatewayFilter&#123;delegate=org.springframework.cloud.gateway.filter.factory.RewritePathGatewayFilterFactory$$Lambda$708/2036079541@cbb7393, order=1&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.RouteToRequestUrlFilter@544e8149&#125;, order=10000&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.LoadBalancerClientFilter@55d58825&#125;, order=10100&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.AdaptCachedBodyGlobalFilter@2da3b078&#125;, order=2147483637&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.WebsocketRoutingFilter@1a96d94c&#125;, order=2147483646&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.NettyRoutingFilter@19a64eae&#125;, order=2147483647&#125;, OrderedGatewayFilter&#123;delegate=GatewayFilterAdapter&#123;delegate=org.springframework.cloud.gateway.filter.ForwardRoutingFilter@7fb66650&#125;, order=2147483647&#125;]</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼ŒSpring Cloud Gateway è‡ªåŠ¨çš„ä¸ºæˆ‘ä»¬çš„ consumer åˆ›å»ºäº†ä¸€ä¸ªè·¯ç”±ï¼Œç±»ä¼¼äºä¸‹è¾¹è¿™æ ·<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">routes:</span></span><br><span class="line"><span class="attr">    - id:</span> <span class="string">CompositeDiscoveryClient_SC-CONSUMER</span></span><br><span class="line"><span class="attr">      uri:</span> <span class="attr">lb://SC-CONSUMER</span></span><br><span class="line"><span class="attr">      order:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">      predicates:</span></span><br><span class="line"><span class="bullet">          -</span> <span class="string">Path=/SC-CONSUMER/**</span></span><br><span class="line"><span class="attr">      filters:</span></span><br><span class="line"><span class="bullet">          -</span> <span class="string">RewritePath=/SC-CONSUMER/(?&lt;segment&gt;.*),</span> <span class="string">/$\&#123;segment&#125;</span></span><br></pre></td></tr></table></figure></p><blockquote><p>æ‰€ä»¥ä»zuulè¿ç§»åˆ°gatewayçš„æ—¶å€™ï¼ŒæœåŠ¡è·¯ç”±è§„åˆ™ä¸­çš„å¾®æœåŠ¡åº”ç”¨Idé»˜è®¤ä»å°å†™å˜ä¸ºå¤§å†™ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†Spring Cloud Gatewayçš„åŸºäºæœåŠ¡å‘ç°çš„é»˜è®¤è·¯ç”±è§„åˆ™ï¼Œä»ä¸­å¯ä»¥çœ‹å‡ºGatewayçš„è·¯ç”±è§„åˆ™:&lt;a href=&quot;http://Gateway_HOST:Gateway_PORT/å¤§å†™çš„serviceId/*&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://Gateway_HOST:Gateway_PORT/å¤§å†™çš„serviceId/*&lt;/a&gt; å’Œ zuulçš„é»˜è®¤è·¯ç”±è§„åˆ™&lt;a href=&quot;http://ZUUL_HOST:ZUUL_PORT/å¾®æœåŠ¡åœ¨Eurekaä¸Šçš„serviceId/*å·®ä¸å¤šã€‚&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://ZUUL_HOST:ZUUL_PORT/å¾®æœåŠ¡åœ¨Eurekaä¸Šçš„serviceId/*å·®ä¸å¤šã€‚&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/categories/Spring-Cloud-Gateway/"/>
    
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/tags/Spring-Cloud-Gateway/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud Gatewayåªæœ‰Preå’ŒPOSTä¸¤ç§ç±»å‹çš„Filter</title>
    <link href="http://xujin.org/sc/gw/gw06/"/>
    <id>http://xujin.org/sc/gw/gw06/</id>
    <published>2018-05-21T06:00:00.000Z</published>
    <updated>2019-01-12T03:30:08.378Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:Spring Cloud Gatewayåªæœ‰ä¸¤ç§ç±»å‹çš„Filterï¼Œæœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨Spring Cloud Gatewayä¸­åˆ›å»ºä¸€ä¸ªPreæˆ–Postç±»å‹çš„Filterã€‚</p><a id="more"></a><h2 id="zuulçš„Filterç±»å‹"><a href="#zuulçš„Filterç±»å‹" class="headerlink" title="zuulçš„Filterç±»å‹"></a>zuulçš„Filterç±»å‹</h2><p>Zuul çš„ Filter æ˜¯é€šè¿‡filterType()æ–¹æ³•æ¥æŒ‡å®šï¼Œä¸€ä¸ª Filter åªèƒ½å¯¹åº”ä¸€ç§ç±»å‹ï¼Œè¦ä¹ˆæ˜¯ â€œpreâ€ è¦ä¹ˆæ˜¯â€œpostâ€</p><h3 id="Spring-Cloud-Gatewayçš„Filterç±»å‹"><a href="#Spring-Cloud-Gatewayçš„Filterç±»å‹" class="headerlink" title="Spring Cloud Gatewayçš„Filterç±»å‹"></a>Spring Cloud Gatewayçš„Filterç±»å‹</h3><p>Spring Cloud Gateway åŸºäº Project Reactor å’Œ WebFluxï¼Œé‡‡ç”¨å“åº”å¼ç¼–ç¨‹é£æ ¼ï¼Œæ‰“å¼€å®ƒçš„ Filter çš„æ¥å£GatewayFilterä½ ä¼šå‘ç°å®ƒåªæœ‰ä¸€ä¸ªæ–¹æ³•filter</p><h2 id="Preç±»å‹çš„Filter"><a href="#Preç±»å‹çš„Filter" class="headerlink" title="Preç±»å‹çš„Filter"></a>Preç±»å‹çš„Filter</h2><p>åœ¨Spring Cloud Gatewayæºç ä¸­å®šä¹‰äº†ä¸€ä¸ªPreç±»å‹çš„Filterï¼Œcodeå°†ä¼šåœ¨chain.filter() ä¹‹å‰è¢«æ‰§è¡Œ,ä»£ç :<a href="https://github.com/spring-cloud/spring-cloud-gateway/blob/master/spring-cloud-gateway-core/src/main/java/org/springframework/cloud/gateway/filter/factory/AddRequestHeaderGatewayFilterFactory.java" target="_blank" rel="noopener">AddRequestHeader</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.cloud.gateway.filter.factory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.filter.GatewayFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.server.reactive.ServerHttpRequest;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Spencer Gibb</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AddRequestHeaderGatewayFilterFactory</span> <span class="keyword">extends</span> <span class="title">AbstractNameValueGatewayFilterFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> GatewayFilter <span class="title">apply</span><span class="params">(NameValueConfig config)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (exchange, chain) -&gt; &#123;</span><br><span class="line">ServerHttpRequest request = exchange.getRequest().mutate()</span><br><span class="line">.header(config.getName(), config.getValue())</span><br><span class="line">.build();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> chain.filter(exchange.mutate().request(request).build());</span><br><span class="line">&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Postç±»å‹çš„Filter"><a href="#Postç±»å‹çš„Filter" class="headerlink" title="Postç±»å‹çš„Filter"></a>Postç±»å‹çš„Filter</h2><p>å¯¹äºPostç±»å‹çš„Filterï¼Œ<a href="https://github.com/spring-cloud/spring-cloud-gateway/blob/master/spring-cloud-gateway-core/src/main/java/org/springframework/cloud/gateway/filter/factory/SetStatusGatewayFilterFactory.java" target="_blank" rel="noopener">SetStatus</a><br>ä»£ç å°†ä¼šåœ¨chain.filter(exchange).then()é‡Œé¢çš„ä»£ç è¿è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SetStatusGatewayFilterFactory</span> <span class="keyword">extends</span> <span class="title">AbstractGatewayFilterFactory</span>&lt;<span class="title">SetStatusGatewayFilterFactory</span>.<span class="title">Config</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> GatewayFilter <span class="title">apply</span><span class="params">(Config config)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> HttpStatus status = ServerWebExchangeUtils.parse(config.status);</span><br><span class="line">        <span class="keyword">return</span> (exchange, chain) -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> chain.filter(exchange).then(Mono.fromRunnable(() -&gt; &#123;</span><br><span class="line">                <span class="comment">// check not really needed, since it is guarded in setStatusCode,</span></span><br><span class="line">                <span class="comment">// but it's a good example</span></span><br><span class="line">                <span class="keyword">if</span> (!exchange.getResponse().isCommitted()) &#123;</span><br><span class="line">                    setResponseStatus(exchange, status);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;));</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:Spring Cloud Gatewayåªæœ‰ä¸¤ç§ç±»å‹çš„Filterï¼Œæœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨Spring Cloud Gatewayä¸­åˆ›å»ºä¸€ä¸ªPreæˆ–Postç±»å‹çš„Filterã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/categories/Spring-Cloud-Gateway/"/>
    
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/tags/Spring-Cloud-Gateway/"/>
    
  </entry>
  
  <entry>
    <title>å…¬ç›ŠEureka Serverä¸å®šåˆ¶æ–¹æ³•</title>
    <link href="http://xujin.org/sc/sc-diy-eureka/"/>
    <id>http://xujin.org/sc/sc-diy-eureka/</id>
    <published>2018-05-14T06:00:00.000Z</published>
    <updated>2019-01-12T03:46:24.845Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>: æœ¬æ–‡ä¸»è¦ç®€å•ä»‹ç»å¦‚ä½•å®šåˆ¶ä¸€ä¸ªeureka serverï¼Œå¹¶ç›´æ¥æŒ‡å‡ºæœ€ä¼˜çš„å®šåˆ¶æ–¹å¼ã€‚</p><a id="more"></a><h2 id="1-Spring-Cloudä¸­å›½å…¬ç›ŠEureka-Server"><a href="#1-Spring-Cloudä¸­å›½å…¬ç›ŠEureka-Server" class="headerlink" title="1. Spring Cloudä¸­å›½å…¬ç›ŠEureka Server"></a>1. Spring Cloudä¸­å›½å…¬ç›ŠEureka Server</h2><p>Eureka Serverä¸ºä½œä¸ºSpring Cloudå¼€å‘è¿‡ç¨‹ä¸­å¸¸ç”¨çš„æ³¨å†Œä¸­å¿ƒç»„ä»¶ï¼Œä½œä¸ºåŸºç¡€è®¾æ–½ç»„ä»¶ï¼Œå¼€å‘å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œç»å¸¸éœ€è¦è‡ªå·±åˆ›å»ºEureka Serveråº”ç”¨å’Œé‡å¯ã€‚ä¸ºäº†å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå­¦ä¹ å…¥é—¨ã€‚Spring Cloudä¸­å›½ç¤¾åŒºç‰¹æ­å»ºä¸€ä¸ªå…¬ç›Šæ³¨å†Œä¸­å¿ƒï¼Œä»…ä½œä¸ºå¸®åŠ©Spring Cloudçš„å¼€å‘è€…è¿›è¡Œå­¦ä¹ å’Œè°ƒè¯•ã€‚ä¸ºäº†æ›´å¥½æœåŠ¡å¤§å®¶ï¼Œè¯·å‹¿å¯¹æœ¬æ³¨å†Œä¸­å¿ƒè¿›è¡Œå‹æµ‹ã€‚å®šåˆ¶çš„Eureka Serveræ³¨å†Œä¸­å¿ƒUIå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="http://springcloud-new.oss-cn-shenzhen.aliyuncs.com/1966ed6f184d06c2ab793dcaf2c41c8b.jpeg?Expires=1841654009&amp;OSSAccessKeyId=LTAI57F52hRuWq3h&amp;Signature=OeNSoXly3WYi9wfNq3guMPq%2Bt48%3D" alt=""></p><h3 id="1-1-è®¿é—®åœ°å€"><a href="#1-1-è®¿é—®åœ°å€" class="headerlink" title="1.1 è®¿é—®åœ°å€"></a>1.1 è®¿é—®åœ°å€</h3><p> <a href="http://eureka.springcloud.cn" title="http://eureka.springcloud.cn" target="_blank" rel="noopener">http://eureka.springcloud.cn</a></p><h2 id="2-å®šåˆ¶Eureka-Serrverçš„UI"><a href="#2-å®šåˆ¶Eureka-Serrverçš„UI" class="headerlink" title="2.å®šåˆ¶Eureka Serrverçš„UI"></a>2.å®šåˆ¶Eureka Serrverçš„UI</h2><h3 id="2-1-ä¸ºä»€ä¹ˆè¦å®šåˆ¶Eureka-Server"><a href="#2-1-ä¸ºä»€ä¹ˆè¦å®šåˆ¶Eureka-Server" class="headerlink" title="2.1 ä¸ºä»€ä¹ˆè¦å®šåˆ¶Eureka Server"></a>2.1 ä¸ºä»€ä¹ˆè¦å®šåˆ¶Eureka Server</h3><p> åŸå› ä¸¤ç‚¹:</p><ul><li>1.è§‰å¾—é»˜è®¤çš„UIæ¯”è¾ƒä¸‘  </li><li>2.Eureka Serveræƒ³å®¢åˆ¶åŒ–ä¸€ä¸‹</li></ul><blockquote><p>è‡³äºSpring Cloud Eurekaçš„UIå®¢åˆ¶åŒ–æˆä»€ä¹ˆæ ·å­ç”±ä½ è€Œå®šï¼</p></blockquote><h2 id="3-ä¸¤ç§æ–¹æ³•å®šåˆ¶Eureka-Server"><a href="#3-ä¸¤ç§æ–¹æ³•å®šåˆ¶Eureka-Server" class="headerlink" title="3. ä¸¤ç§æ–¹æ³•å®šåˆ¶Eureka Server"></a>3. ä¸¤ç§æ–¹æ³•å®šåˆ¶Eureka Server</h2><h3 id="3-1-ç›´æ¥ä¿®æ”¹eureka-serverçš„æºä»£ç "><a href="#3-1-ç›´æ¥ä¿®æ”¹eureka-serverçš„æºä»£ç " class="headerlink" title="3.1 ç›´æ¥ä¿®æ”¹eureka serverçš„æºä»£ç "></a>3.1 ç›´æ¥ä¿®æ”¹eureka serverçš„æºä»£ç </h3><p>   ç›´æ¥ä¿®æ”¹eureka serverçš„æºä»£ç ï¼Œè¯¥æ–¹æ³•æ˜¯æœ€çº¯çš„æ–¹å¼ï¼Œè€Œä¸”æ¯æ¬¡æœ‰ä¸€ä¸ªEureka Serverçš„ç‰ˆæœ¬éƒ½éœ€è¦å»ä¿®æ”¹ã€‚</p><h3 id="3-2-åªä¿®æ”¹Eureka-Serverçš„UI"><a href="#3-2-åªä¿®æ”¹Eureka-Serverçš„UI" class="headerlink" title="3.2 åªä¿®æ”¹Eureka Serverçš„UI"></a>3.2 åªä¿®æ”¹Eureka Serverçš„UI</h3><p>åªéœ€è¦ä¿®æ”¹å¯¹åº”çš„html+css+æ–‡æ¡ˆå³å¯ï¼Œå®Œå…¨ä¸ç”¨å»ä¿®æ”¹Eureka Serverçš„æºç ,å¼ºçƒˆæ¨èã€‚</p><blockquote><p>æºç å‚è€ƒåœ°å€:<a href="https://github.com/SpringCloud/spring-cloud-eureka" target="_blank" rel="noopener">https://github.com/SpringCloud/spring-cloud-eureka</a></p></blockquote><h3 id="3-3-ä¸ºä»€ä¹ˆæˆ‘å®šåˆ¶è‡ªå·±çš„UIåŠ è¿›å»"><a href="#3-3-ä¸ºä»€ä¹ˆæˆ‘å®šåˆ¶è‡ªå·±çš„UIåŠ è¿›å»" class="headerlink" title="3.3 ä¸ºä»€ä¹ˆæˆ‘å®šåˆ¶è‡ªå·±çš„UIåŠ è¿›å»"></a>3.3 ä¸ºä»€ä¹ˆæˆ‘å®šåˆ¶è‡ªå·±çš„UIåŠ è¿›å»</h3><p> ä¸ºä»€ä¹ˆæˆ‘å®šåˆ¶è‡ªå·±çš„UIåŠ è¿›å»ï¼Œå°±å¯ä»¥ç›´æ¥Runï¼Œé‚£æºç ä»£ç ä¸­çš„UIæ˜¯ä¸æ˜¯è¢«è¦†ç›–äº†ï¼Ÿ<br> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.springcloud.eureka<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>eureka-server-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><blockquote><p>å¦‚ä¸Šmavené…ç½®æ‰€ç¤ºï¼Œå®˜æ–¹çš„spring-cloud-starter-netflix-eureka-serverä¾èµ–ä¿¡æ¯é…ç½®åœ¨ä¸‹é¢ï¼Œç”±mavençš„ä¾èµ–åŠ è½½é¡ºåºå†³å®šï¼Œå®šåˆ¶çš„UIä¼˜å…ˆåŠ è½½æ˜¾ç¤ºã€‚</p></blockquote><h2 id="4-å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨DIYçš„Eureka-Server"><a href="#4-å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨DIYçš„Eureka-Server" class="headerlink" title="4. å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨DIYçš„Eureka Server"></a>4. å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨DIYçš„Eureka Server</h2><p>åªéœ€è¦é…ç½®mavenä¾èµ–å³å¯:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.springcloud.eureka<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>eureka-server-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;: æœ¬æ–‡ä¸»è¦ç®€å•ä»‹ç»å¦‚ä½•å®šåˆ¶ä¸€ä¸ªeureka serverï¼Œå¹¶ç›´æ¥æŒ‡å‡ºæœ€ä¼˜çš„å®šåˆ¶æ–¹å¼ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Eureka Server" scheme="http://xujin.org/categories/Eureka-Server/"/>
    
    
      <category term="Eureka Server" scheme="http://xujin.org/tags/Eureka-Server/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud Gatewayçš„Beforeè·¯ç”±æ–­è¨€å·¥å‚</title>
    <link href="http://xujin.org/sc/gw/gw04/"/>
    <id>http://xujin.org/sc/gw/gw04/</id>
    <published>2018-03-28T06:00:00.000Z</published>
    <updated>2019-01-12T03:35:55.349Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:åœ¨ä¸Šæœ¬ç¯‡æ–‡ç« Spring Cloud Gatewayçš„Afterè·¯ç”±æ–­è¨€å·¥å‚ä»‹ç»äº†Spring Cloud Gatewayæ ¸å¿ƒæ¦‚å¿µå’ŒAfterè·¯ç”±æ–­è¨€ï¼Œæœ¬æ–‡ç®€å•ä»‹ç»Beforeè·¯ç”±æ–­è¨€å·¥å‚ã€‚å› ä¸ºæ¯”è¾ƒç®€å•æ‰€ä»¥å°±<code>æŠ›ç –å¼•ç‰ï¼Œæ—¨åœ¨å¸®åŠ©å¤§å®¶å¿«é€Ÿå…¥é—¨Spring Cloud Gateway</code>ï¼Œæ¬¢è¿å¤§å®¶<code>åŠ æˆ‘å¾®ä¿¡Software_King</code>ï¼Œè¿›å…¥Spring Cloudä¸­å›½ç¤¾åŒºå¾®ä¿¡ç¾¤äº¤æµã€‚</p><a id="more"></a><h2 id="1-Spring-Cloud-Gatewayæ ¸å¿ƒæ¦‚å¿µ"><a href="#1-Spring-Cloud-Gatewayæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="1. Spring Cloud Gatewayæ ¸å¿ƒæ¦‚å¿µ"></a>1. Spring Cloud Gatewayæ ¸å¿ƒæ¦‚å¿µ</h2><p>   ç½‘å…³ç®€å•çš„è¯´å°±æ˜¯æä¾›ä¸€ä¸ªå¯¹å¤–ç»Ÿä¸€çš„APIå…¥å£å’Œå‡ºå£ï¼Œç»Ÿç®¡ä¼ä¸šå¯¹å¤–çš„æ‰€æœ‰APIå‡ºå£ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç½‘å…³å¯¹å¤–æš´éœ²çš„URLæˆ–è€…æ¥å£ä¿¡æ¯ï¼Œæˆ‘ä»¬ç»Ÿç§°ä¹‹ä¸ºè·¯ç”±ä¿¡æ¯ã€‚å¦‚æœç ”å‘è¿‡ç½‘å…³ä¸­é—´ä»¶ï¼Œæˆ–è€…ä½¿ç”¨æˆ–äº†è§£è¿‡ZUULçš„ï¼Œç½‘å…³çš„æ ¸å¿ƒè‚¯å®šæ˜¯Filterä»¥åŠFilter Chain(Filterè´£ä»»é“¾)ã€‚Spring Cloud Gatewayä¹Ÿå…·æœ‰è·¯ç”±ä¿¡æ¯å’ŒFilterã€‚ä¸‹é¢ä»‹ç»ä¸€ä¸‹Spring Cloud gatewayä¸­æœ€é‡è¦çš„å‡ ä¸ªæ¦‚å¿µ:</p><ul><li><code>è·¯ç”±(route)</code>:è·¯ç”±æ˜¯ç½‘å…³æœ€åŸºç¡€çš„éƒ¨åˆ†ï¼Œè·¯ç”±ä¿¡æ¯ç”±ä¸€ä¸ªIDã€ä¸€ä¸ªç›®çš„urlã€ä¸€ç»„æ–­è¨€å·¥å‚å’Œä¸€ç»„Filterç»„æˆã€‚å¦‚æœè·¯ç”±æ–­è¨€å·¥å‚ä¸ºçœŸï¼Œåˆ™è¯´æ˜è¯·æ±‚çš„Urlå’Œé…ç½®çš„è·¯ç”±åŒ¹é…ã€‚</li><li><code>æ–­è¨€(Predicate)</code>: java 8ä¸­çš„æ–­è¨€å‡½æ•°ã€‚Spring Cloud Gatewayä¸­çš„æ–­è¨€å‡½æ•°è¾“å…¥ç±»å‹æ˜¯Spring 5.0æ¡†æ¶ä¸­çš„ServerWebExchangeã€‚Spring Cloud Gatewayä¸­çš„æ–­è¨€å‡½æ•°å…è®¸å¼€å‘è€…å»å®šä¹‰åŒ¹é…æ¥è‡ªäºhttp requestä¸­çš„ä»»ä½•ä¿¡æ¯ï¼Œæ¯”å¦‚è¯·æ±‚å¤´å’Œå‚æ•°ç­‰ã€‚</li><li><code>è¿‡æ»¤å™¨(filter)</code>:ä¸€ä¸ªæ ‡å‡†çš„Spring webFilterã€‚Spring Cloud Gatewayä¸­çš„Filteråˆ†ä¸ºä¸¤ç§ç±»å‹çš„Filterï¼Œåˆ†åˆ«æ˜¯Gateway Filterå’ŒGlobal Filter.ç½‘å…³ Filterå®ä¾‹æ˜¯ç”±Spring æ¡†æ¶ä¸­çš„ç½‘å…³Filterçš„ç‰¹æ®Šå·¥å‚æ„é€ ã€‚requeståœ¨è½¬å‘åˆ°ç›®å‰æœåŠ¡ä¹‹å‰ï¼Œresponseåœ¨è¿”å›åˆ°è°ƒç”¨ç«¯ä¹‹å‰éƒ½å¯ä»¥è¢«ä¿®æ”¹æˆ–è€…è‡ªå®šä¹‰ã€‚</li></ul><h2 id="2-ä»€ä¹ˆæ˜¯Beforeè·¯ç”±æ–­è¨€"><a href="#2-ä»€ä¹ˆæ˜¯Beforeè·¯ç”±æ–­è¨€" class="headerlink" title="2. ä»€ä¹ˆæ˜¯Beforeè·¯ç”±æ–­è¨€"></a>2. ä»€ä¹ˆæ˜¯Beforeè·¯ç”±æ–­è¨€</h2><p>  <code>Beforeè·¯ç”±æ–­è¨€å·¥å‚</code>å¸¦æœ‰ä¸€ä¸ª<code>UTCæ—¶é—´æ ¼å¼</code>çš„æ—¶é—´å‚æ•°ï¼Œå½“è¯·æ±‚è¿›æ¥çš„<code>å½“å‰æ—¶é—´åœ¨è·¯ç”±æ–­è¨€å·¥å‚ä¹‹å‰</code>ä¼šæˆåŠŸåŒ¹é…ï¼Œå¦åˆ™ä¸èƒ½æˆåŠŸåŒ¹é…ã€‚</p><h2 id="3-Beforeè·¯ç”±æ–­è¨€å·¥å‚çš„æ¡ˆä¾‹"><a href="#3-Beforeè·¯ç”±æ–­è¨€å·¥å‚çš„æ¡ˆä¾‹" class="headerlink" title="3. Beforeè·¯ç”±æ–­è¨€å·¥å‚çš„æ¡ˆä¾‹"></a>3. Beforeè·¯ç”±æ–­è¨€å·¥å‚çš„æ¡ˆä¾‹</h2><h3 id="3-1-å¼•å…¥pomä¾èµ–"><a href="#3-1-å¼•å…¥pomä¾èµ–" class="headerlink" title="3.1 å¼•å…¥pomä¾èµ–"></a>3.1 å¼•å…¥pomä¾èµ–</h3><p>pom.xmlä¾èµ–é…ç½®å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Finchley.M9<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/snapshot<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-milestones<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Milestones<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/milestone<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginRepositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/snapshot<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-milestones<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Milestones<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/milestone<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pluginRepositories</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-2-application-ymlæ–‡ä»¶é…ç½®"><a href="#3-2-application-ymlæ–‡ä»¶é…ç½®" class="headerlink" title="3.2 application.ymlæ–‡ä»¶é…ç½®:"></a>3.2 application.ymlæ–‡ä»¶é…ç½®:</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8082</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  cloud:</span></span><br><span class="line"><span class="attr">    gateway:</span></span><br><span class="line"><span class="attr">      routes:</span></span><br><span class="line"><span class="attr">      - id:</span> <span class="string">before_route</span></span><br><span class="line"><span class="attr">        uri:</span> <span class="attr">http://xujin.org</span></span><br><span class="line"><span class="attr">        predicates:</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">Before=2022-03-13T00:54:30.877+08:00[Asia/Shanghai]</span></span><br><span class="line"></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="attr">  level:</span></span><br><span class="line">    <span class="string">org.springframework.cloud.gateway:</span> <span class="string">TRACE</span></span><br><span class="line">    <span class="string">org.springframework.http.server.reactive:</span> <span class="string">DEBUG</span></span><br><span class="line">    <span class="string">org.springframework.web.reactive:</span> <span class="string">DEBUG</span></span><br><span class="line">    <span class="string">reactor.ipc.netty:</span> <span class="string">DEBUG</span></span><br><span class="line"></span><br><span class="line"><span class="string">management.endpoints.web.exposure.include:</span> <span class="string">'*'</span></span><br></pre></td></tr></table></figure><blockquote><p>Spring Cloud Gatewayæä¾›ä¸¤ç§æ–¹å¼å»é…ç½®Beforeè·¯ç”±æ–­è¨€å·¥å‚ï¼Œè¿™é‡Œä»‹ç»çš„æ˜¯ymlæ–‡ä»¶çš„é…ç½®æ–¹å¼ã€‚</p></blockquote><h3 id="3-3-ç­‰ä»·çš„-Beané…ç½®"><a href="#3-3-ç­‰ä»·çš„-Beané…ç½®" class="headerlink" title="3.3 ç­‰ä»·çš„@Beané…ç½®"></a>3.3 ç­‰ä»·çš„@Beané…ç½®</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> RouteLocator <span class="title">customRouteLocator</span><span class="params">(RouteLocatorBuilder builder)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">ZonedDateTime datetime = LocalDateTime.now().plusDays(<span class="number">1</span>).atZone(ZoneId.systemDefault());</span><br><span class="line"></span><br><span class="line"><span class="comment">//@formatter:off</span></span><br><span class="line"><span class="keyword">return</span> builder.routes()</span><br><span class="line">.route(<span class="string">"before_route"</span>, r -&gt; r.before(datetime)</span><br><span class="line">.uri(<span class="string">"http://xujin.org"</span>))</span><br><span class="line"></span><br><span class="line">.build();</span><br><span class="line"><span class="comment">//@formatter:on</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Spring Cloud Gatewayæä¾›ä¸¤ç§æ–¹å¼å»é…ç½®Afterè·¯ç”±æ–­è¨€å·¥å‚ï¼Œè¿™é‡Œä»‹ç»çš„æ˜¯@Beançš„é…ç½®æ–¹å¼ã€‚ä¸ç®¡é€šè¿‡<code>ymlæ–‡ä»¶é…ç½®æˆ–è€…é€šè¿‡@Bean</code>çš„æ–¹å¼é…ç½®æ˜¯ç­‰ä»·çš„ã€‚</p></blockquote><h3 id="3-4-æµ‹è¯•å¦‚ä¸‹"><a href="#3-4-æµ‹è¯•å¦‚ä¸‹" class="headerlink" title="3.4 æµ‹è¯•å¦‚ä¸‹:"></a>3.4 æµ‹è¯•å¦‚ä¸‹:</h3><p>è®¿é—®<a href="http://localhost:8082/" target="_blank" rel="noopener">http://localhost:8082/</a> æˆåŠŸè½¬å‘åˆ°<a href="http://xujin.orgã€‚" target="_blank" rel="noopener">http://xujin.orgã€‚</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:åœ¨ä¸Šæœ¬ç¯‡æ–‡ç« Spring Cloud Gatewayçš„Afterè·¯ç”±æ–­è¨€å·¥å‚ä»‹ç»äº†Spring Cloud Gatewayæ ¸å¿ƒæ¦‚å¿µå’ŒAfterè·¯ç”±æ–­è¨€ï¼Œæœ¬æ–‡ç®€å•ä»‹ç»Beforeè·¯ç”±æ–­è¨€å·¥å‚ã€‚å› ä¸ºæ¯”è¾ƒç®€å•æ‰€ä»¥å°±&lt;code&gt;æŠ›ç –å¼•ç‰ï¼Œæ—¨åœ¨å¸®åŠ©å¤§å®¶å¿«é€Ÿå…¥é—¨Spring Cloud Gateway&lt;/code&gt;ï¼Œæ¬¢è¿å¤§å®¶&lt;code&gt;åŠ æˆ‘å¾®ä¿¡Software_King&lt;/code&gt;ï¼Œè¿›å…¥Spring Cloudä¸­å›½ç¤¾åŒºå¾®ä¿¡ç¾¤äº¤æµã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/categories/Spring-Cloud-Gateway/"/>
    
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/tags/Spring-Cloud-Gateway/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud Gatewayçš„Afterè·¯ç”±æ–­è¨€å·¥å‚</title>
    <link href="http://xujin.org/sc/gw/gw03/"/>
    <id>http://xujin.org/sc/gw/gw03/</id>
    <published>2018-03-25T06:00:00.000Z</published>
    <updated>2019-01-12T03:24:23.992Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†Spring Cloud Gatewayæ ¸å¿ƒæ¦‚å¿µå’ŒAfterè·¯ç”±æ–­è¨€ï¼Œå› ä¸ºæ¯”è¾ƒç®€å•æ‰€ä»¥å°±<code>æŠ›ç –å¼•ç‰ï¼Œæ—¨åœ¨å¸®åŠ©å¤§å®¶å¿«é€Ÿå…¥é—¨Spring Cloud Gateway</code>ï¼Œæ¬¢è¿å¤§å®¶<code>åŠ æˆ‘å¾®ä¿¡Software_King</code>ï¼Œè¿›å…¥Spring Cloudä¸­å›½ç¤¾åŒºå¾®ä¿¡ç¾¤äº¤æµã€‚<br><a id="more"></a></p><h2 id="1-Spring-Cloud-Gatewayæ ¸å¿ƒæ¦‚å¿µ"><a href="#1-Spring-Cloud-Gatewayæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="1.Spring Cloud Gatewayæ ¸å¿ƒæ¦‚å¿µ"></a>1.Spring Cloud Gatewayæ ¸å¿ƒæ¦‚å¿µ</h2><p>   ç½‘å…³ç®€å•çš„è¯´å°±æ˜¯æä¾›ä¸€ä¸ªå¯¹å¤–ç»Ÿä¸€çš„APIå…¥å£å’Œå‡ºå£ï¼Œç»Ÿç®¡ä¼ä¸šå¯¹å¤–çš„æ‰€æœ‰APIå‡ºå£ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç½‘å…³å¯¹å¤–æš´éœ²çš„URLæˆ–è€…æ¥å£ä¿¡æ¯ï¼Œæˆ‘ä»¬ç»Ÿç§°ä¹‹ä¸ºè·¯ç”±ä¿¡æ¯ã€‚å¦‚æœç ”å‘è¿‡ç½‘å…³ä¸­é—´ä»¶ï¼Œæˆ–è€…ä½¿ç”¨æˆ–äº†è§£è¿‡ZUULçš„ï¼Œç½‘å…³çš„æ ¸å¿ƒè‚¯å®šæ˜¯Filterä»¥åŠFilter Chain(Filterè´£ä»»é“¾)ã€‚Spring Cloud Gatewayä¹Ÿå…·æœ‰è·¯ç”±ä¿¡æ¯å’ŒFilterã€‚ä¸‹é¢ä»‹ç»ä¸€ä¸‹Spring Cloud gatewayä¸­æœ€é‡è¦çš„å‡ ä¸ªæ¦‚å¿µ:</p><ul><li><code>è·¯ç”±(route)</code>:è·¯ç”±æ˜¯ç½‘å…³æœ€åŸºç¡€çš„éƒ¨åˆ†ï¼Œè·¯ç”±ä¿¡æ¯ç”±ä¸€ä¸ªIDã€ä¸€ä¸ªç›®çš„urlã€ä¸€ç»„æ–­è¨€å·¥å‚å’Œä¸€ç»„Filterç»„æˆã€‚å¦‚æœè·¯ç”±æ–­è¨€å·¥å‚ä¸ºçœŸï¼Œåˆ™è¯´æ˜è¯·æ±‚çš„Urlå’Œé…ç½®çš„è·¯ç”±åŒ¹é…ã€‚</li><li><code>æ–­è¨€(Predicate)</code>: java 8ä¸­çš„æ–­è¨€å‡½æ•°ã€‚Spring Cloud Gatewayä¸­çš„æ–­è¨€å‡½æ•°è¾“å…¥ç±»å‹æ˜¯Spring 5.0æ¡†æ¶ä¸­çš„ServerWebExchangeã€‚Spring Cloud Gatewayä¸­çš„æ–­è¨€å‡½æ•°å…è®¸å¼€å‘è€…å»å®šä¹‰åŒ¹é…æ¥è‡ªäºhttp requestä¸­çš„ä»»ä½•ä¿¡æ¯ï¼Œæ¯”å¦‚è¯·æ±‚å¤´å’Œå‚æ•°ç­‰ã€‚</li><li><code>è¿‡æ»¤å™¨(filter)</code>:ä¸€ä¸ªæ ‡å‡†çš„Spring webFilterã€‚Spring Cloud Gatewayä¸­çš„Filteråˆ†ä¸ºä¸¤ç§ç±»å‹çš„Filterï¼Œåˆ†åˆ«æ˜¯Gateway Filterå’ŒGlobal Filter.ç½‘å…³ Filterå®ä¾‹æ˜¯ç”±Spring æ¡†æ¶ä¸­çš„ç½‘å…³Filterçš„ç‰¹æ®Šå·¥å‚æ„é€ ã€‚requeståœ¨è½¬å‘åˆ°ç›®å‰æœåŠ¡ä¹‹å‰ï¼Œresponseåœ¨è¿”å›åˆ°è°ƒç”¨ç«¯ä¹‹å‰éƒ½å¯ä»¥è¢«ä¿®æ”¹æˆ–è€…è‡ªå®šä¹‰ã€‚</li></ul><h2 id="2-ä»€ä¹ˆæ˜¯Afterè·¯ç”±æ–­è¨€"><a href="#2-ä»€ä¹ˆæ˜¯Afterè·¯ç”±æ–­è¨€" class="headerlink" title="2.ä»€ä¹ˆæ˜¯Afterè·¯ç”±æ–­è¨€"></a>2.ä»€ä¹ˆæ˜¯Afterè·¯ç”±æ–­è¨€</h2><p>   After Route Predicate Factoryå¸¦æœ‰ä¸€ä¸ªUTCæ—¶é—´æ ¼å¼çš„æ—¶é—´å‚æ•°ï¼Œå½“è¯·æ±‚è¿›æ¥çš„å½“å‰æ—¶é—´åœ¨è·¯ç”±æ–­è¨€å·¥å‚ä¹‹åä¼šæˆåŠŸåŒ¹é…ï¼Œå¦åˆ™ä¸èƒ½æˆåŠŸåŒ¹é…ã€‚</p><h2 id="3-Afterè·¯ç”±æ–­è¨€å·¥å‚çš„æ¡ˆä¾‹"><a href="#3-Afterè·¯ç”±æ–­è¨€å·¥å‚çš„æ¡ˆä¾‹" class="headerlink" title="3.Afterè·¯ç”±æ–­è¨€å·¥å‚çš„æ¡ˆä¾‹"></a>3.Afterè·¯ç”±æ–­è¨€å·¥å‚çš„æ¡ˆä¾‹</h2><h3 id="3-1-å¼•å…¥pomä¾èµ–"><a href="#3-1-å¼•å…¥pomä¾èµ–" class="headerlink" title="3.1 å¼•å…¥pomä¾èµ–"></a>3.1 å¼•å…¥pomä¾èµ–</h3><p>pom.xmlä¾èµ–é…ç½®å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Finchley.M9<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/snapshot<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-milestones<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Milestones<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/milestone<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginRepositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/snapshot<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-milestones<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Milestones<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/milestone<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pluginRepositories</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-2-application-ymlæ–‡ä»¶é…ç½®"><a href="#3-2-application-ymlæ–‡ä»¶é…ç½®" class="headerlink" title="3.2  application.ymlæ–‡ä»¶é…ç½®:"></a>3.2  application.ymlæ–‡ä»¶é…ç½®:</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8081</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  cloud:</span></span><br><span class="line"><span class="attr">    gateway:</span></span><br><span class="line"><span class="attr">      routes:</span></span><br><span class="line"><span class="attr">      - id:</span> <span class="string">after_route</span></span><br><span class="line"><span class="attr">        uri:</span> <span class="attr">http://xujin.org</span></span><br><span class="line"><span class="attr">        predicates:</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">After=2018-03-18T17:32:58.129+08:00[Asia/Shanghai]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="attr">  level:</span></span><br><span class="line">    <span class="string">org.springframework.cloud.gateway:</span> <span class="string">TRACE</span></span><br><span class="line">    <span class="string">org.springframework.http.server.reactive:</span> <span class="string">DEBUG</span></span><br><span class="line">    <span class="string">org.springframework.web.reactive:</span> <span class="string">DEBUG</span></span><br><span class="line">    <span class="string">reactor.ipc.netty:</span> <span class="string">DEBUG</span></span><br><span class="line"></span><br><span class="line"><span class="string">management.endpoints.web.exposure.include:</span> <span class="string">'*'</span></span><br></pre></td></tr></table></figure><blockquote><p>Spring Cloud Gatewayæä¾›ä¸¤ç§æ–¹å¼å»é…ç½®Afterè·¯ç”±æ–­è¨€å·¥å‚ï¼Œè¿™é‡Œä»‹ç»çš„æ˜¯ymlæ–‡ä»¶çš„é…ç½®æ–¹å¼ã€‚</p></blockquote><h3 id="3-3-ç­‰ä»·çš„-Beané…ç½®"><a href="#3-3-ç­‰ä»·çš„-Beané…ç½®" class="headerlink" title="3.3 ç­‰ä»·çš„@Beané…ç½®"></a>3.3 ç­‰ä»·çš„@Beané…ç½®</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> RouteLocator <span class="title">customRouteLocator</span><span class="params">(RouteLocatorBuilder builder)</span> </span>&#123;</span><br><span class="line">ZonedDateTime minusTime = LocalDateTime.now().minusDays(<span class="number">1</span>).atZone(ZoneId.systemDefault());</span><br><span class="line"><span class="keyword">return</span> builder.routes()</span><br><span class="line">.route(<span class="string">"after_route"</span>, r -&gt; r.after(minusTime)</span><br><span class="line">.uri(<span class="string">"http://xujin.org"</span>))</span><br><span class="line"></span><br><span class="line">.build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Spring Cloud Gatewayæä¾›ä¸¤ç§æ–¹å¼å»é…ç½®Afterè·¯ç”±æ–­è¨€å·¥å‚ï¼Œè¿™é‡Œä»‹ç»çš„æ˜¯@Beançš„é…ç½®æ–¹å¼ã€‚ä¸ç®¡é€šè¿‡ymlæ–‡ä»¶é…ç½®æˆ–è€…é€šè¿‡@Beançš„æ–¹å¼é…ç½®æ˜¯ç­‰ä»·çš„ã€‚</p></blockquote><h3 id="3-4-æµ‹è¯•å¦‚ä¸‹"><a href="#3-4-æµ‹è¯•å¦‚ä¸‹" class="headerlink" title="3.4 æµ‹è¯•å¦‚ä¸‹:"></a>3.4 æµ‹è¯•å¦‚ä¸‹:</h3><p>è®¿é—®<a href="http://localhost:8081/æˆåŠŸè½¬å‘åˆ°http://xujin.org" target="_blank" rel="noopener">http://localhost:8081/æˆåŠŸè½¬å‘åˆ°http://xujin.org</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†Spring Cloud Gatewayæ ¸å¿ƒæ¦‚å¿µå’ŒAfterè·¯ç”±æ–­è¨€ï¼Œå› ä¸ºæ¯”è¾ƒç®€å•æ‰€ä»¥å°±&lt;code&gt;æŠ›ç –å¼•ç‰ï¼Œæ—¨åœ¨å¸®åŠ©å¤§å®¶å¿«é€Ÿå…¥é—¨Spring Cloud Gateway&lt;/code&gt;ï¼Œæ¬¢è¿å¤§å®¶&lt;code&gt;åŠ æˆ‘å¾®ä¿¡Software_King&lt;/code&gt;ï¼Œè¿›å…¥Spring Cloudä¸­å›½ç¤¾åŒºå¾®ä¿¡ç¾¤äº¤æµã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/categories/Spring-Cloud-Gateway/"/>
    
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/tags/Spring-Cloud-Gateway/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud Gatewayæ­ç§˜ä¹‹å¤„ç†è¯·æ±‚æµç¨‹</title>
    <link href="http://xujin.org/sc/gw/gw02/"/>
    <id>http://xujin.org/sc/gw/gw02/</id>
    <published>2018-03-17T06:00:00.000Z</published>
    <updated>2019-01-12T03:20:23.909Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»æºç çš„è§’åº¦æ­ç§˜Spring Cloud Gatewayçš„æ€ä¹ˆå¤„ç†è¯·æ±‚æµç¨‹ã€‚</p><a id="more"></a><h2 id="1-Spring-Gatewayæ¦‚è¿°"><a href="#1-Spring-Gatewayæ¦‚è¿°" class="headerlink" title="1.Spring Gatewayæ¦‚è¿°"></a>1.Spring Gatewayæ¦‚è¿°</h2><p>   <code>Spring Cloud Gateway</code>æ˜¯Springå®˜æ–¹åŸºäºSpring 5.0ï¼ŒSpring Boot 2.0å’ŒProject Reactorç­‰æŠ€æœ¯å¼€å‘çš„ç½‘å…³ï¼ŒSpring Cloud Gatewayæ—¨åœ¨ä¸ºå¾®æœåŠ¡æ¶æ„æä¾›ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„ç»Ÿä¸€çš„APIè·¯ç”±ç®¡ç†æ–¹å¼ã€‚Spring Cloud Gatewayä½œä¸ºSpring Cloudç”Ÿæ€ç³»ä¸­çš„ç½‘å…³ï¼Œç›®æ ‡æ˜¯æ›¿ä»£Netflix ZUULï¼Œå…¶ä¸ä»…æä¾›ç»Ÿä¸€çš„è·¯ç”±æ–¹å¼ï¼Œå¹¶ä¸”åŸºäºFilteré“¾çš„æ–¹å¼æä¾›äº†ç½‘å…³åŸºæœ¬çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šå®‰å…¨ï¼Œç›‘æ§/åŸ‹ç‚¹ï¼Œå’Œé™æµç­‰ã€‚</p><h2 id="2-Spring-Cloud-gatewayè¯·æ±‚å…¥å£åˆ†æ"><a href="#2-Spring-Cloud-gatewayè¯·æ±‚å…¥å£åˆ†æ" class="headerlink" title="2. Spring Cloud gatewayè¯·æ±‚å…¥å£åˆ†æ"></a>2. Spring Cloud gatewayè¯·æ±‚å…¥å£åˆ†æ</h2><p>  ä¸ç®¡æ˜¯Zuulï¼Œè¿˜æ˜¯Spring Cloud Gatewayè¿˜æ˜¯åŸºäºNettyçš„è‡ªç ”ç½‘å…³ï¼Œéƒ½ä¼šæŠŠè¯·æ±‚è¿›æ¥çš„Requestï¼Œæˆ–è€…è¿”å›çš„Responseè¿›è¡ŒåŒ…è£…ï¼Œè½¬æ¢æå–ä¸ºç½‘å…³è¿è¡Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè€Œåœ¨Spring Cloud gatewayä¸­ç½‘å…³çš„ä¸Šä¸‹æ–‡ä¸ºServerWebExchangeã€‚</p><h3 id="2-1-å…¥å£HttpServerRequestå’ŒHttpServerResponseè½¬æ¢"><a href="#2-1-å…¥å£HttpServerRequestå’ŒHttpServerResponseè½¬æ¢" class="headerlink" title="2.1 å…¥å£HttpServerRequestå’ŒHttpServerResponseè½¬æ¢"></a>2.1 å…¥å£HttpServerRequestå’ŒHttpServerResponseè½¬æ¢</h3><p>Spring Cloud Gatewayçš„è¯·æ±‚å…¥å£ï¼Œorg.springframework.http.server.reactive.ReactorHttpHandlerAdapter#applyæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">apply</span><span class="params">(HttpServerRequest request, HttpServerResponse response)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">NettyDataBufferFactory bufferFactory = <span class="keyword">new</span> NettyDataBufferFactory(response.alloc());</span><br><span class="line">ServerHttpRequest adaptedRequest;</span><br><span class="line">ServerHttpResponse adaptedResponse;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">adaptedRequest = <span class="keyword">new</span> ReactorServerHttpRequest(request, bufferFactory);</span><br><span class="line">adaptedResponse = <span class="keyword">new</span> ReactorServerHttpResponse(response, bufferFactory);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (URISyntaxException ex) &#123;</span><br><span class="line">logger.error(<span class="string">"Invalid URL "</span> + ex.getMessage(), ex);</span><br><span class="line">response.status(HttpResponseStatus.BAD_REQUEST);</span><br><span class="line"><span class="keyword">return</span> Mono.empty();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (adaptedRequest.getMethod() == HttpMethod.HEAD) &#123;</span><br><span class="line">adaptedResponse = <span class="keyword">new</span> HttpHeadResponseDecorator(adaptedResponse);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.httpHandler.handle(adaptedRequest, adaptedResponse)</span><br><span class="line">.doOnError(ex -&gt; logger.error(<span class="string">"Handling completed with error"</span>, ex))</span><br><span class="line">.doOnSuccess(aVoid -&gt; logger.debug(<span class="string">"Handling completed with success"</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>PSï¼Œä»£ç æ¥æºäºspring-web-5.0.4.RELEASE.jar<br>æ­¤æ–¹æ³•ä¸ºSpring Cloud Gatewayçš„è¯·æ±‚å…¥å£æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„ä½œç”¨å°±æ˜¯æŠŠæ¥æ”¶åˆ°çš„HttpServerRequestæˆ–è€…æœ€ç»ˆéœ€è¦è¿”å›çš„HttpServerResponseï¼ŒåŒ…è£…è½¬æ¢ä¸ºReactorServerHttpRequestå’ŒReactorServerHttpResponseã€‚</p></blockquote><h3 id="2-2-æ„é€ Spring-Cloud-gatewayçš„ä¸Šä¸‹æ–‡ServerWebExchange"><a href="#2-2-æ„é€ Spring-Cloud-gatewayçš„ä¸Šä¸‹æ–‡ServerWebExchange" class="headerlink" title="2.2 æ„é€ Spring Cloud gatewayçš„ä¸Šä¸‹æ–‡ServerWebExchange"></a>2.2 æ„é€ Spring Cloud gatewayçš„ä¸Šä¸‹æ–‡ServerWebExchange</h3><p>åœ¨org.springframework.web.server.adapter.HttpWebHandlerAdapterçš„182è¡Œï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">handle</span><span class="params">(ServerHttpRequest request, ServerHttpResponse response)</span> </span>&#123;</span><br><span class="line">ServerWebExchange exchange = createExchange(request, response);</span><br><span class="line"><span class="keyword">return</span> getDelegate().handle(exchange)</span><br><span class="line">.onErrorResume(ex -&gt; handleFailure(request, response, ex))</span><br><span class="line">.then(Mono.defer(response::setComplete));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>createExchange()å°†ServerHttpRequest ServerHttpResponseæ„å»ºç½‘å…³ä¸Šä¸‹æ–‡ServerWebExchangeã€‚</p></blockquote><hr><blockquote><p>PS:å…¶ä¸­org.springframework.web.server.handler.WebHandlerDecorator.getDelegate()é€šè¿‡å§”æ‰˜çš„æ–¹å¼è·å–ä¸€ç³»åˆ—éœ€è¦å¤„ç†çš„WebHandler.</p></blockquote><h3 id="2-3-è¿›å…¥Filteré“¾"><a href="#2-3-è¿›å…¥Filteré“¾" class="headerlink" title="2.3 è¿›å…¥Filteré“¾"></a>2.3 è¿›å…¥Filteré“¾</h3><p>org.springframework.cloud.gateway.handler.FilteringWebHandler#handleæ–¹æ³•ï¼Œå³77è¡Œï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">handle</span><span class="params">(ServerWebExchange exchange)</span> </span>&#123;</span><br><span class="line">    Route route = exchange.getRequiredAttribute(GATEWAY_ROUTE_ATTR);</span><br><span class="line">    List&lt;GatewayFilter&gt; gatewayFilters = route.getFilters();</span><br><span class="line"></span><br><span class="line">    List&lt;GatewayFilter&gt; combined = <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="keyword">this</span>.globalFilters);</span><br><span class="line">    combined.addAll(gatewayFilters);</span><br><span class="line">    <span class="comment">//<span class="doctag">TODO:</span> needed or cached?</span></span><br><span class="line">    AnnotationAwareOrderComparator.sort(combined);</span><br><span class="line"></span><br><span class="line">    logger.debug(<span class="string">"Sorted gatewayFilterFactories: "</span>+ combined);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DefaultGatewayFilterChain(combined).filter(exchange);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-4-æ‰§è¡ŒFilteré“¾"><a href="#2-4-æ‰§è¡ŒFilteré“¾" class="headerlink" title="2.4 æ‰§è¡ŒFilteré“¾"></a>2.4 æ‰§è¡ŒFilteré“¾</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DefaultGatewayFilterChain</span> <span class="keyword">implements</span> <span class="title">GatewayFilterChain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> index;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> List&lt;GatewayFilter&gt; filters;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">DefaultGatewayFilterChain</span><span class="params">(List&lt;GatewayFilter&gt; filters)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.filters = filters;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">filter</span><span class="params">(ServerWebExchange exchange)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.index &lt; filters.size()) &#123;</span><br><span class="line">GatewayFilter filter = filters.get(<span class="keyword">this</span>.index++);</span><br><span class="line"><span class="keyword">return</span> filter.filter(exchange, <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> Mono.empty(); <span class="comment">// complete</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-5-Gateway-Filterå§”æ‰˜ä¸ºGloable-Filteræ‰§è¡Œ"><a href="#2-5-Gateway-Filterå§”æ‰˜ä¸ºGloable-Filteræ‰§è¡Œ" class="headerlink" title="2.5 Gateway Filterå§”æ‰˜ä¸ºGloable Filteræ‰§è¡Œ"></a>2.5 Gateway Filterå§”æ‰˜ä¸ºGloable Filteræ‰§è¡Œ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayFilterAdapter</span> <span class="keyword">implements</span> <span class="title">GatewayFilter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> GlobalFilter delegate;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">GatewayFilterAdapter</span><span class="params">(GlobalFilter delegate)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.delegate = delegate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.delegate.filter(exchange, chain);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">final</span> StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">"GatewayFilterAdapter&#123;"</span>);</span><br><span class="line">sb.append(<span class="string">"delegate="</span>).append(delegate);</span><br><span class="line">sb.append(<span class="string">'&#125;'</span>);</span><br><span class="line"><span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-6-é¢„å‘Šå¾…ç»­"><a href="#2-6-é¢„å‘Šå¾…ç»­" class="headerlink" title="2.6 é¢„å‘Šå¾…ç»­"></a>2.6 é¢„å‘Šå¾…ç»­</h3><p>åœ¨ä¹‹åçš„æ–‡ç« ä¸­ï¼Œå°†ä¼šæ­ç§˜Spring Cloud Gatewayçš„æ¶æ„è®¾è®¡ï¼ŒFilteré“¾è®¾è®¡ï¼Œä»¥åŠå¯åŠ¨è£…åœ¨æµç¨‹ç­‰ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»æºç çš„è§’åº¦æ­ç§˜Spring Cloud Gatewayçš„æ€ä¹ˆå¤„ç†è¯·æ±‚æµç¨‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/categories/Spring-Cloud-Gateway/"/>
    
    
      <category term="Spring Cloud æºç åˆ†æ" scheme="http://xujin.org/tags/Spring-Cloud-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/tags/Spring-Cloud-Gateway/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud Gatewayå…¥é—¨æ¡ˆä¾‹</title>
    <link href="http://xujin.org/sc/gw/gw-01/"/>
    <id>http://xujin.org/sc/gw/gw-01/</id>
    <published>2018-03-15T06:00:00.000Z</published>
    <updated>2019-01-12T03:21:16.579Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†ä»€ä¹ˆæ˜¯<code>Spring Cloud Gateway</code>ï¼Œå¹¶åŸºäºSpring Cloud Gatewayçš„Finchley.M8ç‰ˆæœ¬ç¼–å†™ä¸€ä¸ªSpring Cloud Gatewayçš„å…¥é—¨æ¡ˆä¾‹ï¼Œå³åŸºæœ¬ä»£ç†çš„è·¯ç”±è½¬å‘é…ç½®ã€‚</p><a id="more"></a><h2 id="1-Spring-Gatewayæ¦‚è¿°"><a href="#1-Spring-Gatewayæ¦‚è¿°" class="headerlink" title="1.Spring Gatewayæ¦‚è¿°"></a>1.Spring Gatewayæ¦‚è¿°</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯Spring-Cloud-Gateway"><a href="#1-1-ä»€ä¹ˆæ˜¯Spring-Cloud-Gateway" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯Spring Cloud Gateway"></a>1.1 ä»€ä¹ˆæ˜¯Spring Cloud Gateway</h3><p>   <code>Spring Cloud Gateway</code>æ˜¯Springå®˜æ–¹åŸºäºSpring 5.0ï¼ŒSpring Boot 2.0å’ŒProject Reactorç­‰æŠ€æœ¯å¼€å‘çš„ç½‘å…³ï¼ŒSpring Cloud Gatewayæ—¨åœ¨ä¸ºå¾®æœåŠ¡æ¶æ„æä¾›ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„ç»Ÿä¸€çš„APIè·¯ç”±ç®¡ç†æ–¹å¼ã€‚Spring Cloud Gatewayä½œä¸ºSpring Cloudç”Ÿæ€ç³»ä¸­çš„ç½‘å…³ï¼Œç›®æ ‡æ˜¯æ›¿ä»£Netflix ZUULï¼Œå…¶ä¸ä»…æä¾›ç»Ÿä¸€çš„è·¯ç”±æ–¹å¼ï¼Œå¹¶ä¸”åŸºäºFilteré“¾çš„æ–¹å¼æä¾›äº†ç½‘å…³åŸºæœ¬çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šå®‰å…¨ï¼Œç›‘æ§/åŸ‹ç‚¹ï¼Œå’Œé™æµç­‰ã€‚</p><h2 id="2-Spring-Cloud-Gatewayå…¥é—¨æ¡ˆä¾‹"><a href="#2-Spring-Cloud-Gatewayå…¥é—¨æ¡ˆä¾‹" class="headerlink" title="2. Spring Cloud Gatewayå…¥é—¨æ¡ˆä¾‹"></a>2. Spring Cloud Gatewayå…¥é—¨æ¡ˆä¾‹</h2><h3 id="2-1-åˆ›å»ºmavenå·¥ç¨‹"><a href="#2-1-åˆ›å»ºmavenå·¥ç¨‹" class="headerlink" title="2.1 åˆ›å»ºmavenå·¥ç¨‹"></a>2.1 åˆ›å»ºmavenå·¥ç¨‹</h3><p>é…ç½®Spring  Cloud Gatewayçš„ç›¸å…³Mavenä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ch18-1<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.springcloud.book<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ch18-1-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>ch18-1-gateway<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://springcloud.cn<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Finchley.M8<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/snapshot<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-milestones<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Milestones<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/milestone<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginRepositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/snapshot<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-milestones<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Milestones<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/milestone<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">pluginRepository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pluginRepositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-2-Spring-Cloud-Gatewayä¸»ç¨‹åº"><a href="#2-2-Spring-Cloud-Gatewayä¸»ç¨‹åº" class="headerlink" title="2.2  Spring Cloud Gatewayä¸»ç¨‹åº"></a>2.2  Spring Cloud Gatewayä¸»ç¨‹åº</h3><p>SpringCloudGatewayApplication.javaï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.springcloud.book.gateway;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.route.RouteLocator;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringCloudGatewayApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> RouteLocator <span class="title">customRouteLocator</span><span class="params">(RouteLocatorBuilder builder)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> builder.routes()</span><br><span class="line"><span class="comment">//basic proxy</span></span><br><span class="line">.route(r -&gt; r.path(<span class="string">"/baidu"</span>)</span><br><span class="line">.uri(<span class="string">"http://baidu.com:80/"</span>)</span><br><span class="line">).build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">SpringApplication.run(SpringCloudGatewayApplication.class, args);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-ç¼–å†™application-ymlæ–‡ä»¶"><a href="#2-3-ç¼–å†™application-ymlæ–‡ä»¶" class="headerlink" title="2.3 ç¼–å†™application.ymlæ–‡ä»¶"></a>2.3 ç¼–å†™application.ymlæ–‡ä»¶</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  application:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">spring-cloud-gateway</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  cloud:</span></span><br><span class="line"><span class="attr">    gateway:</span></span><br><span class="line"><span class="attr">      routes:</span></span><br><span class="line"><span class="attr">      - id:</span> <span class="string">xujin_route</span></span><br><span class="line"><span class="attr">        uri:</span> <span class="attr">http://www.xujin.org:80/</span></span><br><span class="line"><span class="attr">        predicates:</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">Path=/xujin</span></span><br><span class="line"></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="attr">  level:</span></span><br><span class="line">    <span class="string">org.springframework.cloud.gateway:</span> <span class="string">TRACE</span></span><br><span class="line">    <span class="string">org.springframework.http.server.reactive:</span> <span class="string">DEBUG</span></span><br><span class="line">    <span class="string">org.springframework.web.reactive:</span> <span class="string">DEBUG</span></span><br><span class="line">    <span class="string">reactor.ipc.netty:</span> <span class="string">DEBUG</span></span><br></pre></td></tr></table></figure><h3 id="2-4-åŸºæœ¬ä»£ç†è·¯ç”±é…ç½®ç­‰åŒå†™æ³•"><a href="#2-4-åŸºæœ¬ä»£ç†è·¯ç”±é…ç½®ç­‰åŒå†™æ³•" class="headerlink" title="2.4 åŸºæœ¬ä»£ç†è·¯ç”±é…ç½®ç­‰åŒå†™æ³•"></a>2.4 åŸºæœ¬ä»£ç†è·¯ç”±é…ç½®ç­‰åŒå†™æ³•</h3><p>Spring Cloud Gatewayæä¾›äº†ä¸¤ç§é…ç½®è·¯ç”±è§„åˆ™çš„æ–¹æ³•</p><ul><li>ç¬¬ä¸€:é€šè¿‡@Beanè‡ªå®šä¹‰RouteLocator<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> RouteLocator <span class="title">customRouteLocator</span><span class="params">(RouteLocatorBuilder builder)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> builder.routes()</span><br><span class="line"><span class="comment">//basic proxy</span></span><br><span class="line">.route(r -&gt; r.path(<span class="string">"/baidu"</span>)</span><br><span class="line">.uri(<span class="string">"http://baidu.com:80/"</span>)</span><br><span class="line">).build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><hr><ul><li>ç¬¬äºŒ:é€šè¿‡å±äºæ–‡ä»¶æˆ–è€…ymlæ–‡ä»¶é…ç½®</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  cloud:</span></span><br><span class="line"><span class="attr">    gateway:</span></span><br><span class="line"><span class="attr">      routes:</span></span><br><span class="line"><span class="attr">      - id:</span> <span class="string">xujin_route</span></span><br><span class="line"><span class="attr">        uri:</span> <span class="attr">http://www.xujin.org:80/</span></span><br><span class="line"><span class="attr">        predicates:</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">Path=/xujin</span></span><br></pre></td></tr></table></figure><blockquote><p>PS,ä»¥ä¸Šä¸¤ç§æ–¹å¼ç­‰åŒã€‚</p></blockquote><h3 id="2-5-é”™è¯¯çš„ç¤ºèŒƒä»£ç å¦‚ä¸‹"><a href="#2-5-é”™è¯¯çš„ç¤ºèŒƒä»£ç å¦‚ä¸‹" class="headerlink" title="2.5 é”™è¯¯çš„ç¤ºèŒƒä»£ç å¦‚ä¸‹:"></a>2.5 é”™è¯¯çš„ç¤ºèŒƒä»£ç å¦‚ä¸‹:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> RouteLocator <span class="title">routingConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Routes.locator()</span><br><span class="line">      .route(<span class="string">"xujin_route"</span>)</span><br><span class="line">      .uri(<span class="string">"http://xujin.org"</span>)</span><br><span class="line">      .predicate(host(<span class="string">"**.xujin.org"</span>))</span><br><span class="line">      .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¸©é¦¨æç¤ºï¼Œä¸Šé¢è¿™ç§å†™æ³•æ˜¯åŸºäºSpring Cloud Gateway FM4çš„ç‰ˆæœ¬ï¼Œç›¸å…³ä»£ç å·²åºŸå¼ƒï¼Œç›®å‰Spring Cloud Gatewayå°†ä¼šåœ¨FM9ä¹‹åRealeseã€‚</p></blockquote><h3 id="2-6-è¿è¡Œæµ‹è¯•"><a href="#2-6-è¿è¡Œæµ‹è¯•" class="headerlink" title="2.6 è¿è¡Œæµ‹è¯•"></a>2.6 è¿è¡Œæµ‹è¯•</h3><ol><li>è®¿é—®<a href="http://localhost:8080/baidu" target="_blank" rel="noopener">http://localhost:8080/baidu</a>,è·¯ç”±è½¬å‘åˆ°<a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a></li><li>è®¿é—®<a href="http://localhost:8080/xujin" target="_blank" rel="noopener">http://localhost:8080/xujin</a>,è·¯ç”±è½¬å‘åˆ°<a href="http://xujin.org">http://xujin.orgyml</a></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> RouteLocator <span class="title">customRouteLocator</span><span class="params">(RouteLocatorBuilder builder)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> builder.routes()</span><br><span class="line"><span class="comment">//basic proxy</span></span><br><span class="line">.route(r -&gt; r.path(<span class="string">"/baidu"</span>)</span><br><span class="line">.uri(<span class="string">"http://baidu.com:80/"</span>)</span><br><span class="line">).build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  cloud:</span></span><br><span class="line"><span class="attr">    gateway:</span></span><br><span class="line"><span class="attr">      routes:</span></span><br><span class="line"><span class="attr">      - id:</span> <span class="string">xujin_route</span></span><br><span class="line"><span class="attr">        uri:</span> <span class="attr">http://www.xujin.org:80/</span></span><br><span class="line"><span class="attr">        predicates:</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">Path=/xujin</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†ä»€ä¹ˆæ˜¯&lt;code&gt;Spring Cloud Gateway&lt;/code&gt;ï¼Œå¹¶åŸºäºSpring Cloud Gatewayçš„Finchley.M8ç‰ˆæœ¬ç¼–å†™ä¸€ä¸ªSpring Cloud Gatewayçš„å…¥é—¨æ¡ˆä¾‹ï¼Œå³åŸºæœ¬ä»£ç†çš„è·¯ç”±è½¬å‘é…ç½®ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/categories/Spring-Cloud-Gateway/"/>
    
    
      <category term="Spring Cloud æºç åˆ†æ" scheme="http://xujin.org/tags/Spring-Cloud-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    
      <category term="Spring Cloud Gateway" scheme="http://xujin.org/tags/Spring-Cloud-Gateway/"/>
    
  </entry>
  
  <entry>
    <title>Mysqlæ‰¹é‡æ‰§è¡Œæ›´æ–°shellè„šæœ¬</title>
    <link href="http://xujin.org/ex/mysql-batch-update/"/>
    <id>http://xujin.org/ex/mysql-batch-update/</id>
    <published>2018-02-17T06:00:00.000Z</published>
    <updated>2019-01-13T05:17:47.596Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:åœ¨ç”Ÿäº§ä¸Šæ‰§è¡Œæ›´æ–°sqlï¼Œå½“æ›´æ–°çš„æ•°æ®è¶…è¿‡ä¸Š100ä¸‡çš„æ—¶å€™ï¼Œæ‰§è¡Œæ›´æ–°æ“ä½œä¼šé€ æˆå¡è¡¨æˆ–è€…é”è¡¨ã€‚æœ¬æ–‡ä¸»è¦è®°å½•ä¸€ä¸ªäº†æ‰¹é‡æ›´æ–°MysqlæŸå¼ è¡¨çš„æ•°æ®çš„è„šæœ¬ä»£ç ç‰‡ã€‚</p><a id="more"></a><h3 id="mysqlçš„æ‰¹é‡æ‰§è¡Œæ›´æ–°"><a href="#mysqlçš„æ‰¹é‡æ‰§è¡Œæ›´æ–°" class="headerlink" title="mysqlçš„æ‰¹é‡æ‰§è¡Œæ›´æ–°"></a>mysqlçš„æ‰¹é‡æ‰§è¡Œæ›´æ–°</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line">. ~/.bash_profile</span><br><span class="line"></span><br><span class="line">log=/home/apps/update/update_log_1_$(date +%F).log</span><br><span class="line">vstart=1</span><br><span class="line">step=10000</span><br><span class="line">vstop=$(($&#123;vstart&#125;+$&#123;step&#125;))</span><br><span class="line">max=14800000</span><br><span class="line"></span><br><span class="line">echo "stop value is $vstop"</span><br><span class="line"></span><br><span class="line">while [ $&#123;vstart&#125; -lt $(($&#123;max&#125;+1)) ] </span><br><span class="line">do</span><br><span class="line">        echo "`date +%F-%T`; mysql -uusername -ppwd --default-character-set=utf8 -S /tmp/mysql3306.sock vip_dbname -e\"UPDATE tbname set limit_days=3, update_time=now() where pid between $&#123;vstart&#125;  and $&#123;vstop&#125;\"" &gt;&gt; $&#123;log&#125;</span><br><span class="line">        /apps/svr/mysql5/bin/mysql -uusername -ppwd --default-character-set=utf8 -S /tmp/mysql3306.sock vip_dbname -e"UPDATE  tbname set limit_days=3, update_time=now() where pid between $&#123;vstart&#125;  and $&#123;vstop&#125; "</span><br><span class="line"></span><br><span class="line">        vstart=$(($&#123;vstop&#125;+1))</span><br><span class="line">        vstop=$(($&#123;vstop&#125;+$&#123;step&#125;))</span><br><span class="line"></span><br><span class="line">        if [ $&#123;vstop&#125; -gt $&#123;max&#125; ]; then</span><br><span class="line">                vstop=$&#123;max&#125;</span><br><span class="line">        fi</span><br><span class="line"></span><br><span class="line">        sleep 1</span><br><span class="line">        #echo "start at $&#123;vstart&#125;, stop at $&#123;vstop&#125;"</span><br><span class="line">done</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:åœ¨ç”Ÿäº§ä¸Šæ‰§è¡Œæ›´æ–°sqlï¼Œå½“æ›´æ–°çš„æ•°æ®è¶…è¿‡ä¸Š100ä¸‡çš„æ—¶å€™ï¼Œæ‰§è¡Œæ›´æ–°æ“ä½œä¼šé€ æˆå¡è¡¨æˆ–è€…é”è¡¨ã€‚æœ¬æ–‡ä¸»è¦è®°å½•ä¸€ä¸ªäº†æ‰¹é‡æ›´æ–°MysqlæŸå¼ è¡¨çš„æ•°æ®çš„è„šæœ¬ä»£ç ç‰‡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¡¹ç›®ç»éªŒ" scheme="http://xujin.org/categories/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="é¡¹ç›®ç»éªŒ" scheme="http://xujin.org/tags/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"/>
    
      <category term="mysql" scheme="http://xujin.org/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloudä¸­åŸºäºSleuthçš„å‚æ•°é€ä¼ åŠŸèƒ½æ¢ç´¢</title>
    <link href="http://xujin.org/sc/sq/sc-gfb/"/>
    <id>http://xujin.org/sc/sq/sc-gfb/</id>
    <published>2018-01-16T06:00:00.000Z</published>
    <updated>2019-01-13T05:09:04.581Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬æ–‡ç”±<code>éƒ­èŠ³ç¢§</code>æŠ•ç¨¿åˆ†äº«ã€‚æŠ•<code>ç¨¿è¯·åŠ å¾®ä¿¡Software_King</code>,æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»Spring Cloudä¸­åŸºäºSleuthçš„å‚æ•°é€ä¼ åŠŸèƒ½æ¢ç´¢çš„ç»å†å’Œç›¸å…³è§£å†³æ–¹æ¡ˆã€‚</p><a id="more"></a><h2 id="ä¸€-éœ€æ±‚"><a href="#ä¸€-éœ€æ±‚" class="headerlink" title="ä¸€.éœ€æ±‚"></a>ä¸€.éœ€æ±‚</h2><p>å¾®æœåŠ¡ç¯å¢ƒï¼Œæœ‰Aï¼ŒBï¼ŒCï¼ŒDå››ä¸ªæœåŠ¡ï¼Œè°ƒç”¨å…³ç³»ä¸ºï¼šA-&gt;B-&gt;C-&gt;Dã€‚ç”¨æˆ·åœ¨Açš„é¡µé¢é€‰æ‹©å½“å‰â€œè¯­è¨€â€ç¯å¢ƒä¸ºâ€œè‹±æ–‡â€,åœ¨æŸäº›ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œå…¶å®ƒå‡ ä¸ªæœåŠ¡éœ€è·å–åˆ°è¿™ä¸ªâ€œè¯­è¨€â€ä¿¡æ¯ã€‚</p><h2 id="äºŒ-åˆ†æ"><a href="#äºŒ-åˆ†æ" class="headerlink" title="äºŒ.åˆ†æ"></a>äºŒ.åˆ†æ</h2><p>è¿™ä¸ªéœ€æ±‚è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œç±»ä¼¼äºâ€œå‡»é¼“ä¼ èŠ±â€ï¼šå½“å‰æœåŠ¡ä»ä¸Šä¸€ä¸ªæœåŠ¡ä¸­è·å–å‚æ•°ï¼Œå¹¶ä¼ ç»™ä¸‹ä¸€ä¸ªæœåŠ¡ã€‚ä¸ªäººæ„Ÿè§‰åŸºæœ¬ä¸Šæ‰€æœ‰çš„RPCæ¡†æ¶éƒ½ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œåªæ˜¯ä»¥å‰SOAæ¶æ„ä¸‹ï¼ŒæœåŠ¡å±‚çº§æ¯”è¾ƒå°‘ï¼Œå°†â€œè¯­è¨€â€ã€â€œç™»é™†â€ç­‰é™„åŠ ä¿¡æ¯æ”¾åœ¨å‚æ•°åˆ—è¡¨ä¸­å¹¶ä¸ä¼šå¸¦æ¥å¤ªå¤šå·¥ä½œé‡ï¼Œæ‰€ä»¥è¿™ä¸ªé—®é¢˜å¹¶ä¸æ˜¯å¤ªçªå‡ºã€‚è€Œå¼•å…¥äº†å¾®æœåŠ¡æ¶æ„æ€æƒ³åï¼ŒæœåŠ¡è°ƒç”¨å±‚çº§æ€¥å‰§å¢é•¿ï¼Œè¿™å°±éœ€è¦ä¸€ä¸ªæ›´åŠ ä¼˜é›…çš„æ–¹å¼æ¥è§£å†³é™„åŠ ä¿¡æ¯çš„ä¼ é€’é—®é¢˜ã€‚</p><h2 id="ä¸‰-æ–¹æ¡ˆæ¢ç´¢"><a href="#ä¸‰-æ–¹æ¡ˆæ¢ç´¢" class="headerlink" title="ä¸‰.æ–¹æ¡ˆæ¢ç´¢"></a>ä¸‰.æ–¹æ¡ˆæ¢ç´¢</h2><h3 id="3-1-æ–¹æ¡ˆä¸€ï¼šå‚æ•°æ”¾åœ¨æ¥å£å‚æ•°åˆ—è¡¨ä¸­"><a href="#3-1-æ–¹æ¡ˆä¸€ï¼šå‚æ•°æ”¾åœ¨æ¥å£å‚æ•°åˆ—è¡¨ä¸­" class="headerlink" title="3.1 æ–¹æ¡ˆä¸€ï¼šå‚æ•°æ”¾åœ¨æ¥å£å‚æ•°åˆ—è¡¨ä¸­"></a>3.1 æ–¹æ¡ˆä¸€ï¼šå‚æ•°æ”¾åœ¨æ¥å£å‚æ•°åˆ—è¡¨ä¸­</h3><p><strong>ä¼˜ç‚¹</strong>ï¼šæ€è·¯ç®€å•ï¼Œå¼€å‘æ²¡æœ‰å­¦ä¹ æˆæœ¬</p><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>ä»£ç é«˜åº¦è€¦åˆï¼šé™„åŠ ä¿¡æ¯å´è¦æ¯ä¸ªæ¥å£éƒ½æ˜¾å¼ç»´æŠ¤</li><li>å‡çº§å›°éš¾ï¼šå¦‚æœå°†æ¥å†åŠ ä¸€ä¸ªå‚æ•°ï¼Œæ‰€æœ‰å±‚çº§çš„æ¥éƒ½è¦æ”¹åŠ¨</li><li>å¼•èµ·è¿·æƒ‘ï¼šå¦‚æœBæœåŠ¡çš„é€»è¾‘ä¸éœ€è¦â€œè¯­è¨€â€œå‚æ•°ï¼Œä½†æ˜¯å› ä¸ºDéœ€è¦ï¼Œå®ƒä¹Ÿå¿…é¡»ç»´æŠ¤</li><li>å¤ªå‚»äº†ï¼ŒBigä¸å¤Ÿ</li></ul><blockquote><p>æ€è€ƒï¼šå¾®æœåŠ¡ä¹‹é—´ç»å¤§å¤šæ•°æƒ…å†µæ˜¯é€šè¿‡HTTPè°ƒç”¨çš„ï¼ŒHTTPçš„headerä¸­ä¹Ÿå¯ä»¥æ”¾å‚æ•°ä¿¡æ¯ã€‚è¿™æ ·ï¼Œæ¥å£å‚æ•°ä¸­å°±ä¸ç”¨ç»´æŠ¤è¿™äº›é™„åŠ ä¿¡äº†ã€‚</p></blockquote><hr><h3 id="3-2-æ–¹æ¡ˆäºŒï¼šå‚æ•°æ”¾åœ¨httpRequestçš„headerä¸­"><a href="#3-2-æ–¹æ¡ˆäºŒï¼šå‚æ•°æ”¾åœ¨httpRequestçš„headerä¸­" class="headerlink" title="3.2 æ–¹æ¡ˆäºŒï¼šå‚æ•°æ”¾åœ¨httpRequestçš„headerä¸­"></a>3.2 æ–¹æ¡ˆäºŒï¼šå‚æ•°æ”¾åœ¨httpRequestçš„headerä¸­</h3><p><strong>å®ç°</strong>ï¼š<br> 1.è‡ªå®šä¹‰ä¸€ä¸ªFilterï¼Œè·å–Requestä¸­è‡ªå·±éœ€è¦çš„é™„åŠ ä¿¡æ¯ï¼Œ<br> 2.å°†è¿™äº›ä¿¡æ¯æ”¾å…¥ThreadLocalä¸­,<br> 3.å®ç°feign.Client(è¿™é‡Œå…ˆå¿½ç•¥RestTemplate)çš„execute()æ–¹æ³•ï¼Œå°†é™„ä»¶ä¿¡æ¯åœ¨è°ƒç”¨ä¸‹ä¸€å±‚æœåŠ¡å‰å¡å…¥requestçš„headerä¸­</p><p><strong>ä¼˜ç‚¹</strong>ï¼šå‚æ•°è§£è€¦</p><p><strong>ç¼ºç‚¹</strong>ï¼šå¦‚æœBåœ¨è·å–åˆ°é™„åŠ ä¿¡æ¯åï¼Œæ–°èµ·äº†ä¸€ä¸ªçº¿ç¨‹â€T1â€œæ¥è°ƒç”¨æœåŠ¡Cï¼Œè¿™æ—¶T1å°±æ— æ³•ä»HhreaLocalæ‹¿åˆ°é™„åŠ ä¿¡æ¯äº†</p><blockquote><p>æ€è€ƒï¼š</p><ol><li>å¦‚æœæˆ‘çŸ¥é“æ€ä¹ˆç”¨æ— ä¾µå…¥çš„æ–¹å¼ï¼Œåœ¨å½“å‰çº¿ç¨‹â€Tâ€åˆ›å»ºå­å­™çº¿ç¨‹â€T1â€ã€â€T1-1â€æ—¶ï¼Œå°†æ•°æ®ä¼ ç»™åä»£ï¼Œå°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜äº†</li><li>å¾®æœåŠ¡è°ƒç”¨é“¾æ¡†æ¶<a href="https://github.com/spring-cloud/spring-cloud-sleuth.git" target="_blank" rel="noopener">Sleuth</a>çš„æ ¸å¿ƒåŠŸèƒ½å³æ˜¯è·Ÿè¸ªä¸€æ¬¡è¯·æ±‚ä»Aåˆ°Dçš„å…¨è¿‡ç¨‹ï¼Œå®ƒè‚¯å®šæ”¯æŒå¤šçº¿ç¨‹è°ƒç”¨ä¸‹çš„traceIdçš„ä¼ é€’ã€‚å› æ­¤ï¼Œæˆ‘å¯ä»¥å¤ç”¨Sleuthçš„ç›¸å…³åŠŸèƒ½å¤¹å¸¦ç§è´§</li></ol></blockquote><hr><h3 id="3-3-æ–¹æ¡ˆä¸‰ï¼šä¿®æ”¹Sleuthæºç ï¼Œå°†é™„åŠ ä¿¡æ¯è·Ÿç€TraceIdä¸€èµ·å¾€åä¼ é€’"><a href="#3-3-æ–¹æ¡ˆä¸‰ï¼šä¿®æ”¹Sleuthæºç ï¼Œå°†é™„åŠ ä¿¡æ¯è·Ÿç€TraceIdä¸€èµ·å¾€åä¼ é€’" class="headerlink" title="3.3 æ–¹æ¡ˆä¸‰ï¼šä¿®æ”¹Sleuthæºç ï¼Œå°†é™„åŠ ä¿¡æ¯è·Ÿç€TraceIdä¸€èµ·å¾€åä¼ é€’"></a>3.3 æ–¹æ¡ˆä¸‰ï¼šä¿®æ”¹Sleuthæºç ï¼Œå°†é™„åŠ ä¿¡æ¯è·Ÿç€TraceIdä¸€èµ·å¾€åä¼ é€’</h3><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>åŸç†ç®€å•ï¼Œä¸ç”¨è€ƒè™‘åº•å±‚å®ç°</li><li>ä¸ç”¨è€ƒè™‘å…¼å®¹æ€§ç­‰é—®é¢˜ï¼ŒSleuthéƒ½å·²ç»å®ç°å¥½</li><li>å¿«(å¯¹ï¼Œå°±æ˜¯è¿™ä¸€ä¸ªå­—)<br><strong>ç¼ºç‚¹</strong>ï¼š</li><li>ç»´æŠ¤å›°éš¾ï¼Œå¾ˆå®¹æ˜“å¿˜è®°ä»¥å‰ä¿®æ”¹äº†å“ªäº›åœ°æ–¹ï¼Œæ›´åˆ«æç§»äº¤ç»™åˆ«äººç»´æŠ¤äº†</li><li>å‡çº§å›°éš¾ï¼Œä»¥åæ¯æ¬¡Springæˆ–è€…Sleuthå‡çº§ï¼Œéƒ½è¦é‡æ–°ä¸‹è½½æºç ä¿®æ”¹</li></ul><blockquote><p>æ€è€ƒï¼š<br> ç›®å‰è·å–å‚æ•°çš„é—®é¢˜è§£å†³äº†ï¼Œç”¨Filterï¼Œåªå‰©ä¸‹ä¿å­˜å¹¶ä¼ ç»™ä¸‹ä¸€å±‚çš„é—®é¢˜<br> æ—¢ç„¶Sleuthå·²ç»è§£å†³äº†å¤šçº¿ç¨‹ä¸‹traceIdçš„ä¼ é€’é—®é¢˜ï¼Œé‚£æˆ‘å°±ç›´æ¥ç”¨traceIdæ¥è§£å†³æˆ‘çš„é—®é¢˜</p></blockquote><h3 id="3-4-æ–¹æ¡ˆå››ï¼šå……åˆ†åˆ©ç”¨traceId"><a href="#3-4-æ–¹æ¡ˆå››ï¼šå……åˆ†åˆ©ç”¨traceId" class="headerlink" title="3.4 æ–¹æ¡ˆå››ï¼šå……åˆ†åˆ©ç”¨traceId"></a>3.4 æ–¹æ¡ˆå››ï¼šå……åˆ†åˆ©ç”¨traceId</h3><p><strong>å®ç°</strong>ï¼š</p><ul><li>è‡ªå®šä¹‰Filter(ä¼˜å…ˆçº§è¦ä½äºTraceFilter,å› ä¸ºä½ è¦è·å–TraceFilteré‡Œçš„traceId)ï¼Œæ‹¿åˆ°traceIdå’Œé™„åŠ ä¿¡æ¯åï¼Œå°†å®ƒä»¬å­˜åœ¨æœ¬åœ°ç¼“å­˜ä¸­ï¼ŒtraceIdä¸ºkeyï¼Œé™„åŠ ä¿¡æ¯ä¸ºvalue</li><li>å‚è€ƒæ–¹æ¡ˆäºŒçš„å®ç°3ã€‚é‡å†™execute()æ–¹æ³•ï¼Œè·å–å½“å‰çº¿ç¨‹çš„traceId(è¿™ä¸ªSleuthæœ‰æ¥å£ï¼Œä¸å†ä»‹ç»)ï¼Œç„¶åå†é€šè¿‡traceIdå»æœ¬åœ°ç¼“å­˜ä¸­æ‹¿åˆ°é™„åŠ ä¿¡æ¯ï¼Œæ”¾è¿›Requestçš„headerä¸­</li></ul><p><strong>ä¼˜ç‚¹</strong>ï¼šæ‹¥æœ‰ä¸Šè¿°æ–¹æ¡ˆæ‰€æœ‰çš„ä¼˜ç‚¹,è§£å†³ä¸Šè¿°æ–¹æ¡ˆæ‰€æœ‰ç¼ºç‚¹</p><p><strong>ç¼ºç‚¹</strong>ï¼šçœ‹ç€å¾ˆå®Œç¾ï¼Œä½†æ˜¯ä½ å¿½ç•¥äº†ä¸€ä»¶äº‹ï¼šSleuthè¦æƒ³ä¼ é€’è‡ªå·±çš„traceIdï¼Œæƒ³å¿…å®ƒå·²ç»é‡å†™äº†execute()æ–¹æ³•(è‚¯å®šçš„ï¼Œé‚£å°±æ˜¯TraceFeignClient)ï¼Œä½ è¦æƒ³ç”¨ï¼Œé‚£å°±è¦æƒ³åŠæ³•åœ¨å¤ç”¨TraceFeignClient.execute()çš„åŒæ—¶ï¼Œå°†è‡ªå·±çš„ç§è´§å¸¦è¿›å»</p><h3 id="3-5-æ–¹æ¡ˆäº”ï¼šé‡å†™TraceFeignClient"><a href="#3-5-æ–¹æ¡ˆäº”ï¼šé‡å†™TraceFeignClient" class="headerlink" title="3.5 æ–¹æ¡ˆäº”ï¼šé‡å†™TraceFeignClient"></a>3.5 æ–¹æ¡ˆäº”ï¼šé‡å†™TraceFeignClient</h3><p><strong>å®ç°</strong>ï¼šæœ‰æ—¶å€™ï¼Œæ”¹åŠ¨æºç å¹¶ä¸éœ€è¦ç›´æ¥åœ¨åŸæœ‰åŒ…é‡Œä¿®æ”¹ã€‚æ¯”å¦‚ï¼šA-&gt;B-&gt;C-&gt;Dï¼Œå¦‚æœä½ è¦ä¿®æ”¹Cçš„æºç ï¼Œé‚£å°±å°†ABæºç ä¹Ÿcopyå‡ºï¼Œä½œä¸ºA1,B1,C#ï¼Œç„¶åé‡å†™ç»„ä»¶çš„å…¥å£ï¼Œå°†ç»„ä»¶åŠ è½½é¡ºåºå˜ä¸ºï¼šA1-&gt;B1-&gt;C#-&gt;Dï¼Œå³å¯è¾¾åˆ°é‡å†™æºç çš„ç›®çš„ã€‚è¿™æ—¶å€™æ³¨æ„çš„æ˜¯ï¼ŒåŠ è½½A1çš„æ¡ä»¶å¿…é¡»è·ŸåŠ è½½Açš„ç›¸åã€‚å…·ä½“å¯å‚è€ƒæˆ‘ä¹‹å‰é‡å†™Consulçš„å…¥å£ä¾‹å­ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConditionalOnExpression</span>(<span class="string">"$&#123;spring.cloud.consul.ribbon.enabled:true&#125;==false"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRibbonConsulAutoConfiguration</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸæœ‰å…¥å£ï¼š</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty</span>(value = <span class="string">"spring.cloud.consul.ribbon.enabled"</span>, matchIfMissing = <span class="keyword">true</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RibbonConsulAutoConfiguration</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»¼ä¸Šï¼Œå¯ä»¥é‡å†™TraceFeigClientçš„å…¥å£ TraceFeignClientAutoConfiguration-&gt;TraceFeignObjectWrapper&gt;TraceFeignClient,å³å¯è¾¾åˆ°è‡ªå·±çš„ç›®çš„.</p></blockquote><p><strong>ä¼˜ç‚¹</strong>ï¼šæ„Ÿè§‰äº‹å„¿åŸºæœ¬å°±æˆäº†</p><p><strong>ç¼ºç‚¹</strong>ï¼šé…ç½®ä¸ºfalseç”Ÿæ•ˆï¼Œä½¿ç”¨è€…ä¼šè§‰å¾—æ¯”è¾ƒæ€ª,Sleuthä»¿ä½›çŸ¥é“åˆ«äººä¼šè¿™ä¹ˆå¹²ä¼¼çš„ï¼Œå®ƒçš„ç±»çš„è®¿é—®æƒé™åŸºæœ¬éƒ½æ˜¯defaultï¼Œä¸ºäº†copyè¿‡æ¥çš„å‡ ä¸ªç±»èƒ½æ­£å¸¸ç¼–è¯‘é€šè¿‡ï¼Œä½ è¿˜è¦å†copyä¹ä¸ªå®ƒä»¬çš„ä¾èµ–ç±»,ç¨‹åºå¤ªä¸‘</p><blockquote><p>æ€è€ƒ:çªç„¶æƒ³èµ·æ¥ï¼Œè¿˜æœ‰ä¸€ç§æ”¹ä»£ç çš„æ–¹å¼å«å­—èŠ‚ç æ›¿æ¢ï¼Œå¦‚æœæˆ‘èƒ½åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶ï¼Œå°†æˆ‘çš„execute()ç›´æ¥æ›¿æ¢æ‰Sleuthçš„execute(),å°±ä¸€åŠ³æ°¸é€¸äº†</p></blockquote><h3 id="3-6-æ–¹æ¡ˆå…­ï¼šå­—èŠ‚ç æ›¿æ¢ä»£æºç ä¿®æ”¹"><a href="#3-6-æ–¹æ¡ˆå…­ï¼šå­—èŠ‚ç æ›¿æ¢ä»£æºç ä¿®æ”¹" class="headerlink" title="3.6 æ–¹æ¡ˆå…­ï¼šå­—èŠ‚ç æ›¿æ¢ä»£æºç ä¿®æ”¹"></a>3.6 æ–¹æ¡ˆå…­ï¼šå­—èŠ‚ç æ›¿æ¢ä»£æºç ä¿®æ”¹</h3><p><strong>ä¼˜ç‚¹</strong>ï¼šé«˜å¤§ä¸Š,ä¸åœ¨æºç çº§æ›¿æ¢ï¼Œå´åœ¨å­—èŠ‚ç çº§æ›¿æ¢ï¼Œè™šè™šå®å®</p><p><strong>ç¼ºç‚¹</strong>ï¼šæ²¡è¿™ä¹ˆå¹²è¿‡ï¼Œæ€»è§‰å¾—è¯´ç€å®¹æ˜“åšç€éš¾</p><blockquote><p>æ€è€ƒï¼šåŸºæœ¬ä¸Šè§‰å¾—æ–¹æ¡ˆäº”å·²ç»èƒ½è§£å†³é—®é¢˜äº†ã€‚æœ¬ç€ç²¾ç›Šæ±‚ç²¾çš„æ€åº¦ï¼Œå»æŠ€æœ¯ç¾¤é‡Œé—®äº†ä¸‹ï¼Œå¾ˆå¿«æœ‰<a href="https://github.com/saleson" target="_blank" rel="noopener">å¤§ç¥</a>å‘æ¥<a href="https://github.com/saleson/fm-cloud.git" target="_blank" rel="noopener">Demo</a>,çœ‹è¿‡ä»£ç åé¡¿è§‰æƒ­æ„§ï¼šæˆ‘ä¸€ç›´åœ¨æƒ³æ€ä¹ˆé‡å†™TraceFeignClientçš„execute()ï¼Œå…¶å®è¿™ä¸ªexecute()çœŸæ­£åšhttpè¯·æ±‚æ—¶ï¼Œè°ƒç”¨çš„æ˜¯feign.Clientçš„å¦å¤–ä¸€ä¸ªå®ç°ç±»,æ³¨æ„é‚£å¥â€this.delegate.executeâ€ï¼Œåªè¦æƒ³åŠæ³•ç”¨è‡ªå·±çš„Clientæ›¿æ¢æ‰delegateå³å¯</p></blockquote><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Log log = LogFactory.getLog(MethodHandles.lookup().lookupClass());</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Client delegate;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Response <span class="title">execute</span><span class="params">(Request request, Request.Options options)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">String spanName = getSpanName(request);</span><br><span class="line">Span span = getTracer().createSpan(spanName);</span><br><span class="line"><span class="keyword">if</span> (log.isDebugEnabled()) &#123;</span><br><span class="line">log.debug(<span class="string">"Created new Feign span "</span> + span);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">AtomicReference&lt;Request&gt; feignRequest = <span class="keyword">new</span> AtomicReference&lt;&gt;(request);</span><br><span class="line">spanInjector().inject(span, <span class="keyword">new</span> FeignRequestTextMap(feignRequest));</span><br><span class="line">span.logEvent(Span.CLIENT_SEND);</span><br><span class="line">addRequestTags(request);</span><br><span class="line">Request modifiedRequest = feignRequest.get();</span><br><span class="line"><span class="keyword">if</span> (log.isDebugEnabled()) &#123;</span><br><span class="line">log.debug(<span class="string">"The modified request equals "</span> + modifiedRequest);</span><br><span class="line">&#125;</span><br><span class="line">Response response = <span class="keyword">this</span>.delegate.execute(modifiedRequest, options);</span><br><span class="line">logCr();</span><br><span class="line"><span class="keyword">return</span> response;</span><br><span class="line">&#125; <span class="keyword">catch</span> (RuntimeException | IOException e) &#123;</span><br><span class="line">logCr();</span><br><span class="line">logError(e);</span><br><span class="line"><span class="keyword">throw</span> e;</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">closeSpan(span);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-7-æ–¹æ¡ˆä¸ƒï¼šæ›¿æ¢æ‰TraceFeigClientçš„delegateå³å¯"><a href="#3-7-æ–¹æ¡ˆä¸ƒï¼šæ›¿æ¢æ‰TraceFeigClientçš„delegateå³å¯" class="headerlink" title="3.7 æ–¹æ¡ˆä¸ƒï¼šæ›¿æ¢æ‰TraceFeigClientçš„delegateå³å¯"></a>3.7 æ–¹æ¡ˆä¸ƒï¼šæ›¿æ¢æ‰TraceFeigClientçš„delegateå³å¯</h3><p> <strong>å®ç°</strong>:é€šè¿‡<strong>å†æ¬¡è®¤çœŸ</strong>Debugæºç çŸ¥é“ï¼ŒTraceFeignClienté»˜è®¤ä¼šåŠ è½½ä½ çš„Clientå®ç°ç±»ä½œä¸ºdelegate(æ±—ï¼)ï¼Œå› æ­¤ä½ åªè¦ç›´æ¥å®ç°feign.Clientæ¥å£å³å¯ã€‚æˆ‘å·æ‡’äº†ä¸€æŠŠï¼Œè‡ªå·±å†™ä¸ªå®ç°ç±»ï¼Œç›´æ¥å¤ç”¨äº†LoadBalancerFeignClient.execute()<br> <strong>ä¼˜ç‚¹</strong>:åŸºæœ¬ä»€ä¹ˆéƒ½æœ‰äº†å§<br> <strong>ç¼ºç‚¹</strong>:å¦‚æœä½ ä»¥ä¸ºåªæ˜¯ç®€å•åœ°é‡å†™ä¸ªexecute()å°±è¡Œï¼Œé‚£å°±å¤§é”™ç‰¹äº†ã€‚å› ä¸ºTraceFeignClientç›´æ¥ç”¨äº†ä½ çš„æ–¹æ³•postè¿‡å»ï¼Œå› æ­¤ä½ è¦æƒ³åŠæ³•æŠŠribbonæ‰‹åŠ¨é›†æˆè¿›æ¥ã€‚å¦‚æœä¸è§‰å¾—éº»çƒ¦çš„è¯ï¼Œå¯ä»¥å¥½å¥½çœ‹ä¸‹TraceFeignClientæ€ä¹ˆç”ŸæˆClientçš„å®ä¾‹ï¼šTraceFeignObjectWrapper.wrap(Object bean)</p><blockquote><p>æ€è€ƒ:æ—¢ç„¶ä½ å¯ä»¥åœ¨ç¨‹åºé‡Œè·å–åˆ°traceå’Œspanï¼Œé‚£ä¸ºä½•ä¸å°†ä½ çš„ä¿¡æ¯æ”¾åˆ°spané‡Œå‘¢ã€‚å¦‚æœspanä¸­èƒ½æ”¾ç‚¹é¢å¤–ä¿¡æ¯å°±å¥½äº†ï¼Œå°±ä¸ç”¨è‡ªå·±å†™è¿™ä¹ˆå¤šä¸œè¥¿ã€‚ç»<a href="https://github.com/huanglc1988" target="_blank" rel="noopener">å¤§ç¥</a>æé†’ï¼ŒSleuthä¸­æœ‰ä¸ªbaggageå¯ä»¥è¯•è¯•</p></blockquote><h3 id="3-8-æ–¹æ¡ˆå…«ï¼šä½¿ç”¨baggage"><a href="#3-8-æ–¹æ¡ˆå…«ï¼šä½¿ç”¨baggage" class="headerlink" title="3.8 æ–¹æ¡ˆå…«ï¼šä½¿ç”¨baggage"></a>3.8 æ–¹æ¡ˆå…«ï¼šä½¿ç”¨baggage</h3><p> <strong>å®ç°:</strong>è·å–å‚æ•°çš„æ–¹å¼ä¸å˜ï¼Œå–å¾—çš„å‚æ•°æ”¾åœ¨baggageä¸­</p><p> <strong>ä¼˜ç‚¹:</strong>ç®€å•,æ”¯æŒRestTemplateè°ƒç”¨çš„æƒ…å†µ,è·Ÿå…¶ä»–ç»„ä»¶å…¼å®¹æ€§å¥½</p><p> <strong>ç¼ºç‚¹:</strong>Sleuthçš„ç¼ºç‚¹</p><h2 id="å››-é¡¹ç›®æºç "><a href="#å››-é¡¹ç›®æºç " class="headerlink" title="å››.é¡¹ç›®æºç "></a>å››.é¡¹ç›®æºç </h2><h3 id="4-1-åŸºäºsluethçš„å‚æ•°é€ä¼ æ’ä»¶"><a href="#4-1-åŸºäºsluethçš„å‚æ•°é€ä¼ æ’ä»¶" class="headerlink" title="4.1 åŸºäºsluethçš„å‚æ•°é€ä¼ æ’ä»¶"></a>4.1 åŸºäºsluethçš„å‚æ•°é€ä¼ æ’ä»¶</h3><p>Githubåœ°å€:<a href="https://github.com/bishion/sleuth-plugin" target="_blank" rel="noopener">https://github.com/bishion/sleuth-plugin</a></p><p><strong>ç®€ä»‹</strong>:å¾®æœåŠ¡ä¸‹ä½¿ç”¨,è°ƒç”¨è¿‡ç¨‹ä¸­ç”¨æˆ·ä¿¡æ¯ï¼Œé¡µé¢è¯­è¨€ä¿¡æ¯çš„é€ä¼ <br><strong>ä½¿ç”¨æ–¹å¼</strong></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bizi:</span></span><br><span class="line"><span class="attr">  sleuth:</span> </span><br><span class="line"><span class="attr">    config:</span></span><br><span class="line"><span class="attr">      headers:</span> <span class="string">lang_info</span> <span class="comment">#å¦‚æœç”±å¤šä¸ªï¼Œé€—å·éš”å¼€.è¿™é‡Œé…ç½®ä»filteré‡Œéœ€è¦è·å–çš„headerName</span></span><br></pre></td></tr></table></figure><p><strong>è°ƒç”¨æ–¹å¼</strong></p><figure class="highlight java"><figcaption><span>first_line:22   </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SessionInfoService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SessionInfoOperator sessionInfoOperator;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getLangInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sessionInfoOperator.getSessionInfo(<span class="string">"lang_info"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserId</span><span class="params">()</span></span>&#123;</span><br><span class="line">        sessionInfoOperator.setSessionInfo(<span class="string">"user_id"</span>,<span class="string">"bishion"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äº”-ç•™ä¸‹çš„å‘"><a href="#äº”-ç•™ä¸‹çš„å‘" class="headerlink" title="äº”.ç•™ä¸‹çš„å‘"></a>äº”.ç•™ä¸‹çš„å‘</h2><ol><li>Sleuthé€šè¿‡<em>LazyTraceExecutor</em>è§£å†³å¤šçº¿ç¨‹ä¸‹çš„é—®é¢˜ï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰è§£å†³<strong>ç»™æ‰‹åŠ¨åˆ›å»ºçš„Threadä¼ é€’ä¿¡æ¯</strong>çš„é—®é¢˜</li><li>æœ‰æœºä¼šè¯•è¯•javaå­—èŠ‚ç æ›¿æ¢æ€ä¹ˆæ“ä½œ</li><li>Sleuthå¦‚ä½•é‡å†™RestTemplateçš„</li><li>TraceFeignClientæ€ä¹ˆç”ŸæˆClientçš„å®ä¾‹</li></ol><h2 id="å…­-åè®°"><a href="#å…­-åè®°" class="headerlink" title="å…­.åè®°"></a>å…­.åè®°</h2><p>å› ä¸ºé™„åŠ ä¿¡æ¯çš„ä¼ é€’åœ¨RPCä¸­æ‰®æ¼”äº†å¾ˆé‡è¦çš„è§’è‰²ï¼Œæˆ‘æ½œæ„è¯†é‡Œè§‰å¾—ï¼Œè‚¯å®šä¼šæœ‰æ›´åŠ ç®€æ´çš„æ–¹æ³•æˆ–è€…æ¡†æ¶æˆ‘è¿˜æ²¡æœ‰äº†è§£åˆ°ã€‚å¸Œæœ›å„ä½å„ä½è¯»è€…è€å¸ˆèƒ½ä¸åç ç‰ï¼Œæ‰¹è¯„æŒ‡æ­£</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬æ–‡ç”±&lt;code&gt;éƒ­èŠ³ç¢§&lt;/code&gt;æŠ•ç¨¿åˆ†äº«ã€‚æŠ•&lt;code&gt;ç¨¿è¯·åŠ å¾®ä¿¡Software_King&lt;/code&gt;,æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»Spring Cloudä¸­åŸºäºSleuthçš„å‚æ•°é€ä¼ åŠŸèƒ½æ¢ç´¢çš„ç»å†å’Œç›¸å…³è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¤¾åŒº" scheme="http://xujin.org/categories/%E7%A4%BE%E5%8C%BA/"/>
    
    
      <category term="Spring Cloud" scheme="http://xujin.org/tags/Spring-Cloud/"/>
    
  </entry>
  
  <entry>
    <title>Spring Cloud ä½¿ç”¨ HTTP2çš„æ€§èƒ½å‹æµ‹å¯¹æ¯”</title>
    <link href="http://xujin.org/sc/sq/sc-http2/"/>
    <id>http://xujin.org/sc/sq/sc-http2/</id>
    <published>2017-12-17T06:00:00.000Z</published>
    <updated>2019-01-13T05:08:29.131Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬æ–‡ç”±<code>ä½•é¹°</code>æŠ•ç¨¿åˆ†äº«ã€‚æŠ•<code>ç¨¿è¯·åŠ å¾®ä¿¡Software_King</code>,æœ¬æ–‡ä¸»è¦æ˜¯å¯¹Spring Cloudä¸­çš„HTTP2çš„æ€§èƒ½è¿›è¡Œå‹æµ‹åˆ†æï¼Œç”Ÿæˆå‹æµ‹ç»“æœã€‚<a href="https://github.com/charlesvhe/spring-cloud-practice/tree/http2" target="_blank" rel="noopener">spring cloud ä½¿ç”¨ HTTP2æºç åœ°å€</a></p><a id="more"></a><h2 id="ä¸€-Spring-Cloud-ä½¿ç”¨-HTTP2"><a href="#ä¸€-Spring-Cloud-ä½¿ç”¨-HTTP2" class="headerlink" title="ä¸€.Spring Cloud ä½¿ç”¨ HTTP2"></a>ä¸€.Spring Cloud ä½¿ç”¨ HTTP2</h2><p>  æˆ‘æœ¬äººæ˜¯ä» Dubbo è½¬ç”¨ Spring cloudã€‚2016å¹´9æœˆå·¦å³åˆšæ¥è§¦ Spring cloudï¼Œé‚£ä¸ªæ—¶å€™è·Ÿå¤§å®¶ä¸€æ ·åšäº†å¾ˆå¤š dubbo vs Spring cloud çš„å¯¹æ¯”åˆ†æã€‚å½“æ—¶æœ€å¤§çš„ç–‘é—®æ˜¯æ€§èƒ½å¯¹æ¯”ï¼Œé—® Josh Long åç»­æœ‰æ— æ”¯æŒç±»ä¼¼äº dubbo çš„å…¶ä»–RPCã€åºåˆ—åŒ–åè®®ï¼Œä»–è¯´ HTTP2æ€§èƒ½å·²ç»è¶³å¤Ÿå¥½äº†ï¼Œæ²¡æœ‰è®¡åˆ’æ”¯æŒã€‚å½“æ—¶æƒ³åˆ° HTTP2æ˜¯å¤šè·¯å¤ç”¨ï¼Œé•¿è¿æ¥ï¼Œæ€§èƒ½æŸå¤±ä»…ä»…æ˜¯åºåˆ—åŒ–ååºåˆ—åŒ–çš„åŒºåˆ«ï¼Œå› æ­¤å°±æ­¤æ‰“ä½æ²¡æœ‰æ·±å…¥æµ‹è¯•ã€‚</p><p><img src="https://raw.githubusercontent.com/charlesvhe/spring-cloud-practice/http2/chrome.net-internals.png" alt="Chrome HTTP2"></p><p>ä¸Šå‘¨åœ¨ W3ä¸Šçœ‹åˆ°å¼ ç¦çš„å¸–å­é‡Œè¯´åˆ° ServiceComboä»¥æ€§èƒ½é—®é¢˜ç¬¬ä¸€ä¸ªå°±æŠŠ Spring cloud æ·˜æ±°äº†ï¼ŒåŠ ä¸Šä¹‹å‰çš„dubbo vs Spring cloud æ€§èƒ½æµ‹è¯•ç»“æœï¼Œå°±æƒ³åˆ°ç”¨ HTTP2è¿›ä¸€æ­¥ä¼˜åŒ– Spring cloud æ€§èƒ½ã€‚<br><a href="https://mp.weixin.qq.com/s?__biz=MzA5MzQ2NTY0OA==&amp;mid=2650796496&amp;idx=1&amp;sn=a544b76660484b9914b65f038cc39e6d&amp;chksm=88562c8fbf21a5995909ffa9f172f31651b1ebd04897917e43caef3491954e24ed0d0477a5a1&amp;mpshare=1&amp;scene=23&amp;srcid=01245faqrBlQETYK9c7zVmd3#rd" target="_blank" rel="noopener">å­°ä¼˜å­°åŠ£ï¼ŸDubbo VS Spring Cloudæ€§èƒ½æµ‹è¯•å¤§å¯¹å†³ï¼</a></p><h2 id="äºŒ-å¯åŠ¨é¡ºåº"><a href="#äºŒ-å¯åŠ¨é¡ºåº" class="headerlink" title="äºŒ.å¯åŠ¨é¡ºåº"></a>äºŒ.å¯åŠ¨é¡ºåº</h2><h3 id="2-1-å¯åŠ¨-config"><a href="#2-1-å¯åŠ¨-config" class="headerlink" title="2.1 å¯åŠ¨ config"></a>2.1 å¯åŠ¨ config</h3><h3 id="2-2-å¯åŠ¨-eureka"><a href="#2-2-å¯åŠ¨-eureka" class="headerlink" title="2.2 å¯åŠ¨ eureka"></a>2.2 å¯åŠ¨ eureka</h3><h3 id="2-3-å¯åŠ¨-provider"><a href="#2-3-å¯åŠ¨-provider" class="headerlink" title="2.3 å¯åŠ¨ provider"></a>2.3 å¯åŠ¨ provider</h3><h3 id="2-4-å¯åŠ¨-consumer"><a href="#2-4-å¯åŠ¨-consumer" class="headerlink" title="2.4 å¯åŠ¨ consumer"></a>2.4 å¯åŠ¨ consumer</h3><p>JDK9ä»¥ä¸‹ä¸é»˜è®¤æ”¯æŒHTTP2ï¼Œéœ€è¦æ·»åŠ å¯åŠ¨å‚æ•°ï¼š</p><blockquote><p>-Xbootclasspath/p:/Users/charles/.m2/repository/org/mortbay/jetty/alpn/alpn-boot/8.1.12-SNAPSHOT/alpn-boot-8.1.12-SNAPSHOT.jar</p></blockquote><h2 id="ä¸‰-æµ‹è¯•-HTTP2"><a href="#ä¸‰-æµ‹è¯•-HTTP2" class="headerlink" title="ä¸‰.æµ‹è¯• HTTP2"></a>ä¸‰.æµ‹è¯• HTTP2</h2><h3 id="3-1-æµ‹è¯•æœåŠ¡æä¾›è€…"><a href="#3-1-æµ‹è¯•æœåŠ¡æä¾›è€…" class="headerlink" title="3.1 æµ‹è¯•æœåŠ¡æä¾›è€…"></a>3.1 æµ‹è¯•æœåŠ¡æä¾›è€…</h3><p>è®¿é—® <a href="https://localhost:8443/user" target="_blank" rel="noopener">https://localhost:8443/user</a><br>è®¿é—® chrome://net-internals/#http2<br>ç¡®è®¤æœåŠ¡å™¨HTTP2æ”¯æŒå·²ç»å¼€å¯</p><h3 id="3-2-æµ‹è¯•æœåŠ¡æ¶ˆè´¹è€…"><a href="#3-2-æµ‹è¯•æœåŠ¡æ¶ˆè´¹è€…" class="headerlink" title="3.2 æµ‹è¯•æœåŠ¡æ¶ˆè´¹è€…"></a>3.2 æµ‹è¯•æœåŠ¡æ¶ˆè´¹è€…</h3><p>è®¿é—® <a href="http://localhost:18090/test" target="_blank" rel="noopener">http://localhost:18090/test</a><br>åœ¨æœåŠ¡æä¾›è€…æ§åˆ¶å°æŸ¥çœ‹æ—¥å¿— æ˜¯å¦æ˜¯ http2 åè®®</p><blockquote><p>2017-12-17 11:36:59.479  INFO 663 â€” [  XNIO-2 task-7] c.g.c.s.p.p.controller.UserController    : query all HTTP/2.0  [accept-language:en-US,en;q=0.9]  [upgrade-insecure-requests:1]  [Host:localhost:8443]  [accept-encoding:gzip, deflate, br]  [accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,<em>/</em>;q=0.8]  [user-agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36] </p></blockquote><h3 id="3-3-æµ‹è¯•æ€§èƒ½"><a href="#3-3-æµ‹è¯•æ€§èƒ½" class="headerlink" title="3.3 æµ‹è¯•æ€§èƒ½"></a>3.3 æµ‹è¯•æ€§èƒ½</h3><p>è®¿é—®ï¼š</p><blockquote><p><a href="http://localhost:18090/test/count?thread=200&amp;api=test100" target="_blank" rel="noopener">http://localhost:18090/test/count?thread=200&amp;api=test100</a></p></blockquote><p>thread å¯ä»¥ä¸ºä»»æ„å€¼<br>apiä¸º test10 test100 test1000<br>æœåŠ¡æ¶ˆè´¹è€…æ§åˆ¶å°æŸ¥çœ‹ååé‡</p><h2 id="å››-æ€§èƒ½å¯¹æ¯”"><a href="#å››-æ€§èƒ½å¯¹æ¯”" class="headerlink" title="å››.æ€§èƒ½å¯¹æ¯”"></a>å››.æ€§èƒ½å¯¹æ¯”</h2><h3 id="4-1-æµ‹è¯•-HTTP-with-SSL-æ€§èƒ½å¯¹æ¯”"><a href="#4-1-æµ‹è¯•-HTTP-with-SSL-æ€§èƒ½å¯¹æ¯”" class="headerlink" title="4.1 æµ‹è¯• HTTP with SSL æ€§èƒ½å¯¹æ¯”"></a>4.1 æµ‹è¯• HTTP with SSL æ€§èƒ½å¯¹æ¯”</h3><p>provider bootstrap.properties æ³¨é‡Š server.http2.enabled=true<br>å’Œä¸Šé¢ä¸€æ ·è¿›è¡Œæ€§èƒ½æµ‹è¯•</p><h3 id="4-2-æµ‹è¯•-HTTP-æ€§èƒ½å¯¹æ¯”"><a href="#4-2-æµ‹è¯•-HTTP-æ€§èƒ½å¯¹æ¯”" class="headerlink" title="4.2 æµ‹è¯• HTTP æ€§èƒ½å¯¹æ¯”"></a>4.2 æµ‹è¯• HTTP æ€§èƒ½å¯¹æ¯”</h3><p>provider bootstrap.properties æ³¨é‡Š server.http2.enabled=trueä»¥åŠä¸‹æ–¹æ‰€æœ‰é…ç½®é¡¹<br>å’Œä¸Šé¢ä¸€æ ·è¿›è¡Œæ€§èƒ½æµ‹è¯•</p><h3 id="4-3-æµ‹è¯•-HTTP-without-Keep-Alive"><a href="#4-3-æµ‹è¯•-HTTP-without-Keep-Alive" class="headerlink" title="4.3 æµ‹è¯• HTTP without Keep-Alive"></a>4.3 æµ‹è¯• HTTP without Keep-Alive</h3><p>ä¿®æ”¹TestController æ¯æ¬¡ new RestTemplate (å…¶å®åœ¨ Header ä¸­æŒ‡å®š Connection=close å¯ä»¥å…³é—­ Keep-Alive ä½†æ˜¯ä¼šè¿è¡Œä¸€æ®µæ—¶é—´åè¶…æ—¶ error)</p><blockquote><p>new RestTemplate().getForObject(â€œ<a href="http://127.0.0.1:8080/user/" target="_blank" rel="noopener">http://127.0.0.1:8080/user/</a>â€œ + api, String.class);</p><p>// restTemplate.getForObject(â€œ<a href="http://provider/user/" target="_blank" rel="noopener">http://provider/user/</a>â€œ + api, String.class);</p></blockquote><h3 id="4-4-æµ‹è¯•ç»“æœ-ååé‡-ç§’"><a href="#4-4-æµ‹è¯•ç»“æœ-ååé‡-ç§’" class="headerlink" title="4.4 æµ‹è¯•ç»“æœ ååé‡/ç§’"></a>4.4 æµ‹è¯•ç»“æœ ååé‡/ç§’</h3><table><thead><tr><th>æµ‹è¯•ç»„åˆ</th><th>HTTP without Keep-Alive</th><th>HTTP with Keep-Alive</th><th>HTTP+SSL</th><th>HTTP2</th></tr></thead><tbody><tr><td>T100 O10</td><td>1210</td><td>8850</td><td>3310</td><td>6320</td></tr><tr><td>T100 0100</td><td>1115</td><td>7525</td><td>2225</td><td>3410</td></tr><tr><td>T100 01000</td><td>950</td><td>2710</td><td>1150</td><td>1080</td></tr><tr><td>T200 010</td><td>1050</td><td>8650+error</td><td>4200+error</td><td>6120</td></tr><tr><td>T200 0100</td><td>1035</td><td>7250</td><td>330+error</td><td>3250</td></tr><tr><td>T200 01000</td><td>870</td><td>2650</td><td>495</td><td>930</td></tr></tbody></table><p>åˆ†æï¼š</p><p>æµ‹è¯•ç»“æœä¸ Josh Long æ‰€è¯´ä¸åŒï¼ŒHTTP2å¹¶ä¸èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ã€‚HTTP2 çš„å¤šè·¯å¤ç”¨ç›¸æ¯” HTTP1.1 Keep-Alive çš„â€å•è·¯å¤ç”¨â€ç›¸æ¯”ä¼˜åŠ¿å¹¶ä¸å¤§ï¼Œåè€Œå¸¦æ¥äº† SSL åŠ è§£å¯†çš„æ€§èƒ½æŸå¤±(HTTP2åè®®æœ¬èº«ä¸è¦æ±‚ SSLï¼Œä½†æ˜¯ç›®å‰å®ç°å‡ä¸º HTTP2å¼ºåˆ¶ SSL)ã€‚HTTP2å¤šè·¯å¤ç”¨å¯ä»¥èŠ‚çœé“¾æ¥ï¼Œé¿å…é“¾æ¥è¶…å®¹å™¨ä¸Šé™ã€‚</p><p>HTTP2+SSL ç›¸æ¯” HTTP1.1+SSL æœ‰æ€§èƒ½ä¼˜åŠ¿ï¼Œä½†æ˜¯é’ˆå¯¹ Spring cloud å†…éƒ¨è°ƒç”¨åœºæ™¯æˆ‘ä»¬å¹¶ä¸ä¼šå¼€å¯ HTTPSï¼Œå› æ­¤æ˜¯ä¸ªåºŸçš„ï¼Œåœ¨æ­¤åœºæ™¯ä¹‹ä¸‹æœ€ä½³é€‰æ‹©æ˜¯ <strong>HTTP1.1 + Keep-Alive</strong>ã€‚</p><blockquote><p>åŸæ–‡é“¾æ¥:<a href="http://www.jianshu.com/p/ed3f8f983764" target="_blank" rel="noopener">http://www.jianshu.com/p/ed3f8f983764</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬æ–‡ç”±&lt;code&gt;ä½•é¹°&lt;/code&gt;æŠ•ç¨¿åˆ†äº«ã€‚æŠ•&lt;code&gt;ç¨¿è¯·åŠ å¾®ä¿¡Software_King&lt;/code&gt;,æœ¬æ–‡ä¸»è¦æ˜¯å¯¹Spring Cloudä¸­çš„HTTP2çš„æ€§èƒ½è¿›è¡Œå‹æµ‹åˆ†æï¼Œç”Ÿæˆå‹æµ‹ç»“æœã€‚&lt;a href=&quot;https://github.com/charlesvhe/spring-cloud-practice/tree/http2&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;spring cloud ä½¿ç”¨ HTTP2æºç åœ°å€&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="ç¤¾åŒº" scheme="http://xujin.org/categories/%E7%A4%BE%E5%8C%BA/"/>
    
    
      <category term="Spring Cloud" scheme="http://xujin.org/tags/Spring-Cloud/"/>
    
      <category term="http2" scheme="http://xujin.org/tags/http2/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäºSpring Cloudçš„å‡ ä¸ªè‡ªç ”å¾®æœåŠ¡ç»„ä»¶</title>
    <link href="http://xujin.org/sc/sq/sc-zyzj/"/>
    <id>http://xujin.org/sc/sq/sc-zyzj/</id>
    <published>2017-12-14T06:00:00.000Z</published>
    <updated>2019-01-13T05:09:47.660Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬æ–‡ç”±<code>å®œä¿¡-æŠ€æœ¯ç ”å‘ä¸­å¿ƒ-é«˜çº§æ¶æ„å¸ˆ-æ¢é‘«</code>æŠ•ç¨¿åˆ†äº«ã€‚æŠ•<code>ç¨¿è¯·åŠ å¾®ä¿¡Software_King</code>,ä¹‹å‰åˆ†äº«äº†ä¸€ä¸‹æˆ‘åœ¨å…¬å¸é¡¹ç›®ä¸­æ­å»ºSpring Cloudæ¡†æ¶çš„ç»éªŒï¼Œåœ¨æ­¤åŸºç¡€ä¹‹ä¸Šï¼Œä¸ºäº†æ›´å¥½çš„æ»¡è¶³ä¸šåŠ¡åŠŸèƒ½éœ€æ±‚å’Œä¾¿æ·è¿ç»´çš„éœ€è¦ï¼Œæˆ‘ä»¬å¼€å‘äº†å‡ ä¸ªåŸºäºspringcloudçš„å¾®æœåŠ¡ç»„ä»¶ï¼Œåœ¨æ­¤åšä¸ªæ€»ç»“è·Ÿå¤§å®¶å…±åŒæ¢è®¨ä¸€ä¸‹ã€‚</p><a id="more"></a><h2 id="åŸºäºSpringCloudçš„å‡ ä¸ªè‡ªç ”å¾®æœåŠ¡ç»„ä»¶"><a href="#åŸºäºSpringCloudçš„å‡ ä¸ªè‡ªç ”å¾®æœåŠ¡ç»„ä»¶" class="headerlink" title="åŸºäºSpringCloudçš„å‡ ä¸ªè‡ªç ”å¾®æœåŠ¡ç»„ä»¶"></a>åŸºäºSpringCloudçš„å‡ ä¸ªè‡ªç ”å¾®æœåŠ¡ç»„ä»¶</h2><h3 id="ä¸€-åº”ç”¨ç®¡ç†ä¸­å¿ƒ"><a href="#ä¸€-åº”ç”¨ç®¡ç†ä¸­å¿ƒ" class="headerlink" title="ä¸€.åº”ç”¨ç®¡ç†ä¸­å¿ƒ"></a>ä¸€.åº”ç”¨ç®¡ç†ä¸­å¿ƒ</h3><p>é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ä»¥åï¼ŒæŠŠåŸå…ˆå•ä¸€çš„èŠ‚ç‚¹æ‹†è§£æˆäº†å¤šä¸ªå¾®æœåŠ¡èŠ‚ç‚¹ã€‚å…¬å¸è™½ç„¶æœ‰ä¸€é”®å‘å¸ƒå¹³å°ï¼Œä½†æ˜¯æ˜¯é’ˆå¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹é‡‡å–å•ç‹¬çš„å‘å¸ƒï¼Œå¯åŠ¨ï¼Œåœæ­¢æ“ä½œï¼Œæ²¡æœ‰å…¨å±€åŒ–ç»Ÿä¸€ç®¡ç†åŠŸèƒ½ã€‚ä¸Šçº¿è¿ç»´çš„å·¥ä½œé‡å°±å˜çš„éå¸¸åºå¤§ï¼Œå› æ­¤æˆ‘ä»¬å¼€å‘äº†åŸºäºspringcloudçš„åº”ç”¨ç®¡ç†ä¸­å¿ƒæ¥æ–¹ä¾¿æˆ‘ä»¬çš„å·¥ä½œã€‚</p><h4 id="1-1-å®ç°æœºåˆ¶"><a href="#1-1-å®ç°æœºåˆ¶" class="headerlink" title="1.1 å®ç°æœºåˆ¶"></a>1.1 å®ç°æœºåˆ¶</h4><ul><li>æ¯ä¸ªå¾®æœåŠ¡å¯åŠ¨æ—¶ï¼Œå°†è‡ªèº«çš„è¿›ç¨‹IDï¼Œå½“å‰è·¯å¾„ï¼ŒJDKè·¯å¾„ï¼Œjaråç§°ï¼Œç³»ç»Ÿç”¨æˆ·ï¼ŒIPåœ°å€ï¼Œç«¯å£å·æ³¨å†Œåˆ°zookeeper;</li><li>åº”ç”¨ç®¡ç†ä¸­å¿ƒä»zookeeperä¸­æŸ¥è¯¢åˆ°æ‰€æœ‰çš„å¾®æœåŠ¡è¿›ç¨‹ä¿¡æ¯ï¼›</li><li>è·å–ä¿¡æ¯åæ„é€ å¯åŠ¨å‘½ä»¤ï¼Œåœæ­¢å‘½ä»¤ï¼›</li><li>åœ¨æ•°æ®åº“ä¿å­˜ç³»ç»Ÿçš„ç”¨æˆ·åå’Œå¯†ç ï¼›</li><li>åœ¨éƒ¨ç½²æ—¶æŒ‡å®šgitåœ°å€ï¼Œåˆ†æ”¯ï¼ŒIPç­‰è°ƒç”¨jenkinsï¼Œç¼–è¯‘ç”Ÿæˆæœ€æ–°jaråŒ…æ‹·è´åˆ°ç›®æ ‡æœåŠ¡å™¨æŒ‡å®šä½ç½®ï¼›</li><li>é€šè¿‡è¿œç¨‹jschè¿œç¨‹æ‰§è¡Œshellå‘½ä»¤å¯¹å¾®æœåŠ¡è¿›ç¨‹è¿›è¡Œæ“ä½œã€‚</li></ul><h4 id="1-2-åŠŸèƒ½åŸç†"><a href="#1-2-åŠŸèƒ½åŸç†" class="headerlink" title="1.2 åŠŸèƒ½åŸç†"></a>1.2 åŠŸèƒ½åŸç†</h4><p><img src="/images/sq/app_yuanli.png" alt="åŠŸèƒ½åŸç†"></p><h4 id="1-3-æ•ˆæœå›¾"><a href="#1-3-æ•ˆæœå›¾" class="headerlink" title="1.3 æ•ˆæœå›¾"></a>1.3 æ•ˆæœå›¾</h4><p><img src="/images/sq/app1.png" alt="Image text"><br><img src="/images/sq/app2.png" alt="Image text"><br><img src="/images/sq/app3.png" alt="Image text"></p><h3 id="äºŒ-å¾®æœåŠ¡å¥åº·æ£€æµ‹ä¸­å¿ƒ"><a href="#äºŒ-å¾®æœåŠ¡å¥åº·æ£€æµ‹ä¸­å¿ƒ" class="headerlink" title="äºŒ.å¾®æœåŠ¡å¥åº·æ£€æµ‹ä¸­å¿ƒ"></a>äºŒ.å¾®æœåŠ¡å¥åº·æ£€æµ‹ä¸­å¿ƒ</h3><p>åŸºäºactuatoræˆ‘ä»¬å¯ä»¥å¾ˆå¥½çš„é’ˆå¯¹æ¯ä¸ªå¾®æœåŠ¡èŠ‚ç‚¹è¿›è¡Œç›‘æ§ï¼Œå½“å‡ºç°é—®é¢˜æ—¶åŠæ—¶æŠ¥è­¦ã€‚</p><h4 id="2-1-å®ç°æœºåˆ¶"><a href="#2-1-å®ç°æœºåˆ¶" class="headerlink" title="2.1 å®ç°æœºåˆ¶"></a>2.1 å®ç°æœºåˆ¶</h4><ul><li>ä¿è¯æ‰€æœ‰çš„å¾®æœåŠ¡èŠ‚ç‚¹éƒ½åŠ è½½äº†actuator;</li><li>ä»eurekaä¸­è·å–æ‰€æœ‰çš„å¾®æœåŠ¡æ³¨å†Œä¿¡æ¯ï¼›</li><li>å®šæ—¶ä»»åŠ¡è½®è¯¢è¯·æ±‚æ¯ä¸ªå¾®æœåŠ¡çš„healthä¿¡æ¯ï¼›</li><li>Healthè¿”å›statusæ ‘å£®ç»“æ„ä¿¡æ¯ï¼›</li><li>å¦‚æœstatusçŠ¶æ€ä¸ºdownå‘é€æŠ¥è­¦å¹¶åŒ…å«healthå®Œæ•´ä¿¡æ¯ã€‚</li></ul><h4 id="2-2-åŠŸèƒ½åŸç†"><a href="#2-2-åŠŸèƒ½åŸç†" class="headerlink" title="2.2 åŠŸèƒ½åŸç†"></a>2.2 åŠŸèƒ½åŸç†</h4><p><img src="/images/sq/health_yuanli.png" alt="Image text"></p><h4 id="2-3-æ•ˆæœå›¾"><a href="#2-3-æ•ˆæœå›¾" class="headerlink" title="2.3 æ•ˆæœå›¾"></a>2.3 æ•ˆæœå›¾</h4><p>æˆ‘ä»¬åœ¨å¥åº·æ£€æµ‹ä¸­å¿ƒä¸­åŒæ—¶åŠ è½½äº†spring boot admin,å¯ä»¥éšæ—¶æŸ¥çœ‹å¾®æœåŠ¡èŠ‚ç‚¹çš„æ‰€æœ‰è¿è¡Œä¿¡æ¯ã€‚</p><p><img src="/images/sq/health1.png" alt="Image text"></p><h4 id="2-4-éƒ¨åˆ†æºç "><a href="#2-4-éƒ¨åˆ†æºç " class="headerlink" title="2.4 éƒ¨åˆ†æºç "></a>2.4 éƒ¨åˆ†æºç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scheduled</span>(initialDelay = <span class="number">10000L</span>, fixedRate = <span class="number">60000L</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">scheduledTaskHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> begin = System.currentTimeMillis();</span><br><span class="line">    List&lt;String&gt; items = getIPAndPorts();</span><br><span class="line">    <span class="keyword">for</span> (String IPAndPort : items) &#123;</span><br><span class="line">        LOGGER.info(<span class="string">"prepare checking "</span> + IPAndPort);</span><br><span class="line">        <span class="keyword">if</span> (IPAndPort.isEmpty()) &#123;</span><br><span class="line">            LOGGER.warn(<span class="string">"checking "</span> + IPAndPort + <span class="string">" is empty"</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String[] item = IPAndPort.split(<span class="string">":"</span>);</span><br><span class="line">            String info = healthService.getHealthInfo(item[<span class="number">0</span>], item[<span class="number">1</span>]);</span><br><span class="line">            String prettyjson = getPrettyJSON(info);</span><br><span class="line">            ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">            <span class="meta">@SuppressWarnings</span>(<span class="string">"rawtypes"</span>)</span><br><span class="line">            Map&lt;?, ?&gt; infoMap = mapper.readValue(info, <span class="keyword">new</span> TypeReference&lt;Map&gt;() &#123;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">if</span> (infoMap.containsKey(STATUS)) &#123;</span><br><span class="line">                String status = infoMap.get(STATUS).toString();</span><br><span class="line">                <span class="keyword">if</span> (status.equals(UP)) &#123;</span><br><span class="line">                    LOGGER.info(<span class="string">"checking "</span> + IPAndPort + <span class="string">" is UP:\n"</span> + prettyjson);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            emailService.sendLimitedEmail(prettyjson, IPAndPort, IPAndPort, <span class="number">10</span> * <span class="number">60</span> * <span class="number">1000L</span>);</span><br><span class="line">            LOGGER.info(<span class="string">"checking "</span> + IPAndPort + <span class="string">" is DOWN:\n"</span> + prettyjson);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (feign.RetryableException ex) &#123;</span><br><span class="line">            String content = exception2String(ex);</span><br><span class="line">            emailService.sendEmail(content, <span class="string">"ç¨‹åºè¿è¡Œå¼‚å¸¸"</span>);</span><br><span class="line">            LOGGER.info(<span class="string">"checking "</span> + IPAndPort + <span class="string">" is DOWN"</span>);</span><br><span class="line">            LOGGER.error(<span class="string">""</span>, ex);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (FeignException fex) &#123;</span><br><span class="line">            String body = getBodyFromFeignException(fex);</span><br><span class="line">            String prettybody = getPrettyJSON(body);</span><br><span class="line">            emailService.sendLimitedEmail(prettybody, IPAndPort, IPAndPort, <span class="number">10</span> * <span class="number">60</span> * <span class="number">1000L</span>);</span><br><span class="line">            LOGGER.info(<span class="string">"checking "</span> + IPAndPort + <span class="string">" is DOWN:\n"</span> + prettybody);</span><br><span class="line">            LOGGER.error(<span class="string">""</span>, fex);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            String content = exception2String(ex);</span><br><span class="line">            emailService.sendEmail(content, <span class="string">"ç¨‹åºè¿è¡Œå¼‚å¸¸"</span>);</span><br><span class="line">            LOGGER.info(<span class="string">"checking "</span> + IPAndPort + <span class="string">" is DOWN"</span>);</span><br><span class="line">            LOGGER.error(<span class="string">""</span>, ex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    LOGGER.info(<span class="string">"SkytrainHealthChecking cost: "</span> + (System.currentTimeMillis() - begin) + <span class="string">" Millis"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸‰-å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸­å¿ƒ"><a href="#ä¸‰-å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸­å¿ƒ" class="headerlink" title="ä¸‰.å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸­å¿ƒ"></a>ä¸‰.å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸­å¿ƒ</h3><p>æˆ‘ä»¬éœ€è¦å»ºç«‹å®šæ—¶ä»»åŠ¡å…¨å±€è§†å›¾ï¼Œå¹¶å¸Œæœ›å¯¹æ¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡å…·å¤‡å¯åœçš„èƒ½åŠ›ã€‚æˆ‘ä»¬é‡‡ç”¨äº†é€šè¿‡ç»§æ‰¿ç»Ÿä¸€çš„AbstractScheduledTaskï¼Œæš´éœ²å®šæ—¶ä»»åŠ¡çš„å¯åŠ¨ï¼Œåœæ­¢æ¥å£ã€‚è®©æ¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡è‡ªåŠ¨å…·å¤‡çš„å¯åœåŠŸèƒ½ã€‚</p><h4 id="3-1-å®ç°æœºåˆ¶"><a href="#3-1-å®ç°æœºåˆ¶" class="headerlink" title="3.1 å®ç°æœºåˆ¶"></a>3.1 å®ç°æœºåˆ¶</h4><ul><li>é€šè¿‡BeanPostProcessoråœ¨beanåˆå§‹å®Œæˆåæ‹¦æˆªæ‰€æœ‰çš„@Scheduledæ³¨è§£ï¼Œè·å–ipï¼Œportï¼ŒapplicationNameï¼ŒclassNameï¼ŒbeanNameï¼Œscheduledç­‰ä¿¡æ¯æ³¨å†Œåˆ°zookeeperï¼›</li><li>å®šæ—¶ä»»åŠ¡å®ç°ç»§æ‰¿AbstractScheduledTaskInteræ¥å£ï¼Œæš´éœ²startScheduledTaskå’ŒstopScheduledTaskï¼Œå¯ä»¥é’ˆå¯¹å®šæ—¶ä»»åŠ¡è¿›è¡Œå¯åŠ¨åœæ­¢ï¼›</li><li>å®ç°åŸºå‡†TaskScheduledControllerç±»ï¼Œé€šè¿‡beanNameè·å–å®šæ—¶ä»»åŠ¡ç±»ï¼Œè°ƒç”¨è¯¥ç±»çš„å¯åŠ¨åœæ­¢æ–¹æ³•ï¼›</li><li>å®šæ—¶ä»»åŠ¡ç®¡ç†ä¸­å¿ƒæŸ¥è¯¢zookeeperå±•ç¤ºå…¨å±€æ³¨å†Œçš„å®šæ—¶ä»»åŠ¡ï¼Œæä¾›å¯åŠ¨åœæ­¢æ“ä½œå¯¹å®šæ—¶ä»»åŠ¡è¿›è¡Œæ§åˆ¶ï¼›</li><li>å®šæ—¶ä»»åŠ¡åˆ†ä¸ºå…¨å±€å”¯ä¸€å®šæ—¶ä»»åŠ¡å’Œéå”¯ä¸€å®šæ—¶ä»»åŠ¡ã€‚</li></ul><h4 id="3-2-åŠŸèƒ½åŸç†"><a href="#3-2-åŠŸèƒ½åŸç†" class="headerlink" title="3.2 åŠŸèƒ½åŸç†"></a>3.2 åŠŸèƒ½åŸç†</h4><p><img src="/images/sq/task_yuanli.png" alt="Image text"></p><h4 id="3-3-æ•ˆæœå›¾"><a href="#3-3-æ•ˆæœå›¾" class="headerlink" title="3.3 æ•ˆæœå›¾"></a>3.3 æ•ˆæœå›¾</h4><p><img src="/images/sq/task1.png" alt="Image text"><br><img src="/images/sq/task2.png" alt="Image text"></p><h4 id="3-4-éƒ¨åˆ†æºç "><a href="#3-4-éƒ¨åˆ†æºç " class="headerlink" title="3.4 éƒ¨åˆ†æºç "></a>3.4 éƒ¨åˆ†æºç </h4><ul><li>è·å–å®šæ—¶ä»»åŠ¡</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">postProcessAfter</span><span class="params">(Object bean, String beanName)</span> </span>&#123;</span><br><span class="line">    Class&lt;?&gt; targetClass = AopUtils.getTargetClass(bean);</span><br><span class="line">    Map&lt;Method, Set&lt;Scheduled&gt;&gt; annotatedMethods = MethodIntrospector.selectMethods(targetClass,</span><br><span class="line">            <span class="keyword">new</span> MethodIntrospector.MetadataLookup&lt;Set&lt;Scheduled&gt;&gt;() &#123;</span><br><span class="line">                <span class="function"><span class="keyword">public</span> Set&lt;Scheduled&gt; <span class="title">inspect</span><span class="params">(Method method)</span> </span>&#123;</span><br><span class="line">                    Set&lt;Scheduled&gt; scheduledMethods = AnnotatedElementUtils.getMergedRepeatableAnnotations(method,</span><br><span class="line">                            Scheduled.class, Schedules.class);</span><br><span class="line">                    <span class="keyword">return</span> (!scheduledMethods.isEmpty() ? scheduledMethods : <span class="keyword">null</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">    <span class="keyword">if</span> (!annotatedMethods.isEmpty()) &#123;</span><br><span class="line">        String className = targetClass.getName();</span><br><span class="line">        className = SpringBeanUtil.getNormalClassName(className);</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;Method, Set&lt;Scheduled&gt;&gt; entry : annotatedMethods.entrySet()) &#123;</span><br><span class="line">            Method method = entry.getKey();</span><br><span class="line">            <span class="keyword">for</span> (Scheduled scheduled : entry.getValue()) &#123;</span><br><span class="line">                String key = className + <span class="string">":"</span> + method.getName();</span><br><span class="line">                Map&lt;String, String&gt; scheduledMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">                scheduledMap.put(<span class="string">"className"</span>, className);</span><br><span class="line">                scheduledMap.put(<span class="string">"methodName"</span>, method.getName());</span><br><span class="line">                scheduledMap.put(<span class="string">"beanName"</span>, beanName);</span><br><span class="line">                scheduledMap.put(<span class="string">"scheduled"</span>, scheduled.toString());</span><br><span class="line">                taskInfos.put(key, scheduledMap);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>AbstractScheduledTask</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractScheduledTask</span> <span class="keyword">implements</span> <span class="title">AbstractScheduledTaskInter</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">boolean</span> scheduledTaskStatus = <span class="keyword">true</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">startScheduledTask</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    scheduledTaskStatus = <span class="keyword">true</span>;</span><br><span class="line">    updateRegisterTaskStatus(scheduledTaskStatus);</span><br><span class="line">    <span class="keyword">return</span> String.valueOf(scheduledTaskStatus);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">stopScheduledTask</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    scheduledTaskStatus = <span class="keyword">false</span>;</span><br><span class="line">    updateRegisterTaskStatus(scheduledTaskStatus);</span><br><span class="line">    <span class="keyword">return</span> String.valueOf(scheduledTaskStatus);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateRegisterTaskStatus</span><span class="params">(<span class="keyword">boolean</span> status)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        String className = <span class="keyword">this</span>.getClass().getName();</span><br><span class="line">        className=SpringBeanUtil.getNormalClassName(className);</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">        LOGGER.error(e.getMessage(), e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">boolean</span> isRegister = <span class="keyword">false</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isRegister</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isRegister) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">scheduledTaskController</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isRegister()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (scheduledTaskStatus) &#123;</span><br><span class="line">            scheduledTaskHandler();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">scheduledTaskHandler</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å…·å¤‡å¯åœèƒ½åŠ›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskScheduledController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/start_scheduled_task"</span>, produces = <span class="string">"application/json;charset=UTF-8"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">start</span><span class="params">(@RequestParam()</span> String beanName) </span>&#123;</span><br><span class="line">        AbstractScheduledTaskInter scheduledTask = SpringBeanUtil.getBean(beanName);</span><br><span class="line">        <span class="keyword">return</span> scheduledTask.startScheduledTask();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/stop_scheduled_task"</span>, produces = <span class="string">"application/json;charset=UTF-8"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">stop</span><span class="params">(@RequestParam()</span> String beanName) </span>&#123;</span><br><span class="line">        AbstractScheduledTaskInter scheduledTask = SpringBeanUtil.getBean(beanName);</span><br><span class="line">        <span class="keyword">return</span> scheduledTask.stopScheduledTask();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å››-å…¨å±€çƒ­å¤‡é”"><a href="#å››-å…¨å±€çƒ­å¤‡é”" class="headerlink" title="å››.å…¨å±€çƒ­å¤‡é”"></a>å››.å…¨å±€çƒ­å¤‡é”</h3><p>æ— è®ºå®šæ—¶ä»»åŠ¡è¿˜æ˜¯æ™®é€šè·‘æ‰¹ä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™äº›ä»»åŠ¡å®ç°çƒ­å¤‡ï¼Œä»¥ä¾¿åœ¨å•ç‚¹æ•…éšœæ—¶ä»»åŠ¡ä¾ç„¶å¯ä»¥é¡ºåˆ©çš„æ‰§è¡Œã€‚</p><h4 id="4-1-å®ç°æœºåˆ¶"><a href="#4-1-å®ç°æœºåˆ¶" class="headerlink" title="4.1 å®ç°æœºåˆ¶"></a>4.1 å®ç°æœºåˆ¶</h4><ul><li>å…¨å±€çƒ­å¤‡é”åŒ…æ‹¬æ™®é€šä»»åŠ¡ï¼ˆä¾‹å¦‚ç›‘å¬rabbitmqæ¶ˆæ¯ï¼‰å’Œå®šæ—¶ä»»åŠ¡ï¼›</li><li>ä»»åŠ¡ä»¥applicationNameå’ŒclassNameæ ‡è¯†å”¯ä¸€ï¼Œä»»åŠ¡å¯åŠ¨æ—¶æŠŠç›¸å…³ä¿¡æ¯æ³¨å†Œåˆ°zookeeperï¼›</li><li>å…¶ä»–èŠ‚ç‚¹çš„ä»»åŠ¡å¯åŠ¨æ—¶å‘ç°å·²ç»æœ‰ä»»åŠ¡è¿è¡Œï¼Œåˆ™ç›‘å¬zookeeperï¼›</li><li>è¿è¡Œä»»åŠ¡åœæ­¢åï¼Œå…¶å®ƒèŠ‚ç‚¹æ ¹æ®ç›‘å¬çŠ¶æ€å¯åŠ¨è‡ªèº«ä»»åŠ¡ï¼›</li><li>å®šæ—¶ä»»åŠ¡å’Œæ™®é€šä»»åŠ¡ä¸åŒï¼Œå®šæ—¶ä»»åŠ¡éœ€è¦æ³¨å†Œéè¿è¡ŒèŠ‚ç‚¹ï¼Œå¹¶å¯¹å­èŠ‚ç‚¹æ•°ç›®å˜åŒ–å’Œå­èŠ‚ç‚¹æ•°æ®å˜åŒ–éƒ½åšç›‘å¬ã€‚</li></ul><h4 id="4-2-åŠŸèƒ½åŸç†"><a href="#4-2-åŠŸèƒ½åŸç†" class="headerlink" title="4.2 åŠŸèƒ½åŸç†"></a>4.2 åŠŸèƒ½åŸç†</h4><p><img src="/images/sq/lock_yuanli.png" alt="Image text"></p><h4 id="4-3-æ•ˆæœå›¾"><a href="#4-3-æ•ˆæœå›¾" class="headerlink" title="4.3 æ•ˆæœå›¾"></a>4.3 æ•ˆæœå›¾</h4><p><img src="/images/sq/lock1.png" alt="Image text"></p><h4 id="4-4-éƒ¨åˆ†æºç "><a href="#4-4-éƒ¨åˆ†æºç " class="headerlink" title="4.4 éƒ¨åˆ†æºç "></a>4.4 éƒ¨åˆ†æºç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractGlobalLockTask</span> <span class="keyword">implements</span> <span class="title">CommandLineRunner</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(<span class="keyword">final</span> String... strings)</span> </span>&#123;</span><br><span class="line">        String className = getClass().getName();</span><br><span class="line">        className = SpringBeanUtil.getNormalClassName(className);</span><br><span class="line">        <span class="keyword">final</span> String alarmConfigPath = SKYTRAIN_GlOBAL_LOCK_TASK_PREFIX + applicationName + <span class="string">":"</span> + className;</span><br><span class="line">        <span class="keyword">boolean</span> exists = zooKeeperExecutor.isExists(alarmConfigPath);</span><br><span class="line">        <span class="keyword">if</span> (!exists) &#123;</span><br><span class="line">            JSONObject info = <span class="keyword">new</span> JSONObject();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                info.put(<span class="string">"applicationName"</span>, applicationName);</span><br><span class="line">                info.put(<span class="string">"className"</span>, className);</span><br><span class="line">                info.put(<span class="string">"ip"</span>, ipAddress);</span><br><span class="line">                info.put(<span class="string">"port"</span>, serverPort);</span><br><span class="line">                info.put(<span class="string">"date"</span>, <span class="keyword">new</span> Date());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">                LOGGER.error(e.getMessage(), e);</span><br><span class="line">            &#125;</span><br><span class="line">            createGlobalLockNode(alarmConfigPath, info.toString(), strings);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                zooKeeperExecutor.getZooKeeper().exists(alarmConfigPath, <span class="keyword">new</span> Watcher() &#123;</span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(WatchedEvent watchedEvent)</span> </span>&#123;</span><br><span class="line">                        LOGGER.info(<span class="string">"äº‹ä»¶ç±»å‹"</span> + watchedEvent.getType() + <span class="string">"ï¼Œè·¯å¾„"</span> + watchedEvent.getPath());</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            register(strings);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                            LOGGER.error(<span class="string">""</span>, e);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (KeeperException e) &#123;</span><br><span class="line">                LOGGER.error(e.getMessage(), e);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                LOGGER.error(e.getMessage(), e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createGlobalLockNode</span><span class="params">(String path, String value, String... strings)</span> </span>&#123;</span><br><span class="line">        zooKeeperExecutor.createZKNode(path, value);</span><br><span class="line">        handler(strings);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String... strings)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        register(strings);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handler</span><span class="params">(String... strings)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½œè€…ï¼šå®œä¿¡-æŠ€æœ¯ç ”å‘ä¸­å¿ƒ-é«˜çº§æ¶æ„å¸ˆ-æ¢é‘«</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬æ–‡ç”±&lt;code&gt;å®œä¿¡-æŠ€æœ¯ç ”å‘ä¸­å¿ƒ-é«˜çº§æ¶æ„å¸ˆ-æ¢é‘«&lt;/code&gt;æŠ•ç¨¿åˆ†äº«ã€‚æŠ•&lt;code&gt;ç¨¿è¯·åŠ å¾®ä¿¡Software_King&lt;/code&gt;,ä¹‹å‰åˆ†äº«äº†ä¸€ä¸‹æˆ‘åœ¨å…¬å¸é¡¹ç›®ä¸­æ­å»ºSpring Cloudæ¡†æ¶çš„ç»éªŒï¼Œåœ¨æ­¤åŸºç¡€ä¹‹ä¸Šï¼Œä¸ºäº†æ›´å¥½çš„æ»¡è¶³ä¸šåŠ¡åŠŸèƒ½éœ€æ±‚å’Œä¾¿æ·è¿ç»´çš„éœ€è¦ï¼Œæˆ‘ä»¬å¼€å‘äº†å‡ ä¸ªåŸºäºspringcloudçš„å¾®æœåŠ¡ç»„ä»¶ï¼Œåœ¨æ­¤åšä¸ªæ€»ç»“è·Ÿå¤§å®¶å…±åŒæ¢è®¨ä¸€ä¸‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç¤¾åŒº" scheme="http://xujin.org/categories/%E7%A4%BE%E5%8C%BA/"/>
    
    
      <category term="Spring Cloud" scheme="http://xujin.org/tags/Spring-Cloud/"/>
    
      <category term="Spring Cloudè‡ªç ”ç»„ä»¶" scheme="http://xujin.org/tags/Spring-Cloud%E8%87%AA%E7%A0%94%E7%BB%84%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>èµ°è¿›Spring Cloud CodeGenä¸Šç¯‡</title>
    <link href="http://xujin.org/ex/sc-codegen/"/>
    <id>http://xujin.org/ex/sc-codegen/</id>
    <published>2017-12-13T06:00:00.000Z</published>
    <updated>2019-01-13T05:21:29.532Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ‘˜è¦</strong>:æœ¬æ–‡ä¸»è¦ä»‹ç»ç”±<code>Spring Cloudä¸­å›½ç¤¾åŒºå‘èµ·</code>çš„ä»¥<code>Spring Cloudä¸ºä¸»</code>çš„ä»£ç ç”Ÿæˆå™¨ï¼Œç›®çš„æ˜¯<code>å¿«é€Ÿï¼ŒæŒ‰éœ€å‹¾é€‰ï¼Œç”Ÿæˆæœ€ä¼˜å®è·µçš„Spring Cloudå·¥ç¨‹</code>ã€‚æ¬¢è¿æœ‰æƒ³æ³•çš„<code>å°ä¼™ä¼´åŠ å…¥Spring Cloudä¸­å›½ç¤¾åŒºå¼€æºæˆ˜é˜Ÿ</code>ï¼Œå…³äºä»£ç ç”Ÿæˆå™¨å’Œspring-cloud-codegençš„è®¾è®¡ç»†èŠ‚åé¢å°†æœ‰ä¸€ç³»åˆ—çš„æ–‡ç« ä»‹ç»ã€‚</p><a id="more"></a><h2 id="ä¸€-Spring-Cloud-CodeGenæ¦‚è¿°"><a href="#ä¸€-Spring-Cloud-CodeGenæ¦‚è¿°" class="headerlink" title="ä¸€.Spring Cloud CodeGenæ¦‚è¿°"></a>ä¸€.Spring Cloud CodeGenæ¦‚è¿°</h2><h3 id="1-1-ä¸ºä»€ä¹ˆè¦å¼€å‘Spring-Cloud-CodeGen"><a href="#1-1-ä¸ºä»€ä¹ˆè¦å¼€å‘Spring-Cloud-CodeGen" class="headerlink" title="1.1 ä¸ºä»€ä¹ˆè¦å¼€å‘Spring Cloud CodeGen"></a>1.1 ä¸ºä»€ä¹ˆè¦å¼€å‘Spring Cloud CodeGen</h3><p>  å¦‚ä½•ç”Ÿæˆé¡¹ç›®çš„ä»£ç ï¼Ÿ ä¸å°‘å¼€å‘äººå‘˜éƒ½ä¼šä½¿ç”¨Mavençš„Archetypeæˆ–IDEAçš„Gradleæ’ä»¶ï¼Œé€šè¿‡å‡ ä¸ªç®€å•çš„äº¤äº’å°±å¯ä»¥å¿«é€Ÿå®Œæˆé¡¹ç›®çš„ç»“æ„å’Œå¯¹åº”çš„ä»£ç ç”Ÿæˆã€‚ä½†æ˜¯Springå®˜æ–¹ä¹Ÿç»™æˆ‘ä»¬æä¾›äº†<a href="http://start.spring.io" target="_blank" rel="noopener">http://start.spring.io</a> ç”Ÿæˆï¼Œé“ç†å¾ˆç®€å•ï¼šUIå¯è§†åŒ–ï¼Œé€‰æ‹©é¡¹å¤šï¼Œæ›´æ–°å¿«ã€‚ä½†æ˜¯ä¾‹å¦‚:application.propertiesæ–‡ä»¶çš„ç”Ÿæˆ,<code>å®˜æ–¹æ˜¯ä¸ä¼šç”Ÿæˆå¯¹åº”çš„é…ç½®é¡¹çš„</code> å› æ­¤ä¹Ÿæœ‰ä¸å°‘å…¬å¸å¯¹å…¶è¿›è¡Œä»£ç å¢å¼ºå¤„ç†äºŒæ¬¡å¼€å‘å¤„ç†ã€‚</p><hr><p>æ ¹æ®ç›®å‰ç¤¾åŒºå’Œç°åœ¨ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨çš„ç°çŠ¶ï¼Œè¿«åˆ‡å¸Œæœ›æ‰“é€ ä¸€ä¸ªå¦‚ä¸‹çš„ä»£ç ç”Ÿæˆå™¨:</p><ul><li>ä¸šç•Œæœ€ä½³Spring Cloudå¾®æœåŠ¡å®æˆ˜ç»éªŒæ‰“é€ æœ€ä½³ä»£ç ç”Ÿæˆæ¨¡æ¿</li><li>å®¹å™¨åŒ–/Dockeræ”¯æŒï¼š æ ¹æ®ä½ é€‰æ‹©çš„dependencyï¼Œè‡ªåŠ¨ç”Ÿæˆdocker-compose.ymlæ–‡ä»¶ï¼Œå¦‚é€‰æ‹©mysqlï¼Œredisç­‰ï¼Œä¼šåœ¨docker-compse.ymlè‡ªåŠ¨æ·»åŠ å¯¹åº”çš„é•œåƒé…ç½®ï¼Œæ–¹ä¾¿ä½¿ç”¨docker composeè¿›è¡Œç¯å¢ƒé…ç½®å’Œç»„ä»¶ç¼–æ’ã€‚</li><li>application.propertiesæ–‡ä»¶ç”Ÿæˆï¼š <code>å®˜æ–¹æ˜¯ä¸ä¼šç”Ÿæˆå¯¹åº”çš„é…ç½®é¡¹çš„</code>ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ä¼šç»“åˆSpring Cloudçš„æœ€ä¼˜å®è·µé…ç½®ï¼Œä¸ä»…å¦‚æ­¤æˆ‘ä»¬å°†ä¼šé›†æˆå¸‚é¢ä¸Šå£ç¢‘æœ€å¥½çš„ä¸­é—´ä»¶ç»™å‡ºæœ€ä¼˜é…ç½®ã€‚</li><li>è§„èŒƒï¼špom.xmlçš„è§„èŒƒï¼Œapplication.propertiesçš„è§„èŒƒç­‰ï¼Œæä¾›é»˜è®¤é…ç½®ï¼Œåªéœ€è¦ç¨å¾®è°ƒæ•´ä¸€ä¸‹æˆ–è€…ä¸éœ€è¦ä»»ä½•è°ƒæ•´å°±å¯ä»¥ä½¿ç”¨ã€‚</li><li>å…¶ä»–æ ‡å‡†æ–‡ä»¶çš„è§„èŒƒï¼š.gitignore, logback-spring.xmlç­‰ã€‚ å¦‚æœä½ é€‰æ‹©mybatisä¼šè‡ªåŠ¨ç”Ÿæˆmybatis-config.xmlæ–‡ä»¶ç­‰ã€‚</li><li>æŒç»­é›†æˆï¼šè‡ªåŠ¨ç”Ÿæˆ .gitlab-ci.yml æ–‡ä»¶ï¼Œè‡ªåŠ¨é›†æˆ Gitlab CI</li></ul><p>åŸºäºå¦‚ä¸ŠåŸå› å’Œæ„¿æ™¯,å› æ­¤æˆ‘ä»¬éœ€è¦å¼€å‘ä¸€ä¸ªæœ€ä¼˜Spring Cloudå®è·µçš„ä»£ç ç”Ÿæˆå™¨ã€‚</p><h3 id="1-2-Spring-Cloud-CodeGenæ¦‚è¿°"><a href="#1-2-Spring-Cloud-CodeGenæ¦‚è¿°" class="headerlink" title="1.2 Spring Cloud CodeGenæ¦‚è¿°"></a>1.2 Spring Cloud CodeGenæ¦‚è¿°</h3><p><code>spring-cloud-codegen</code>æ˜¯ç”±<code>Spring Cloudä¸­å›½ç¤¾åŒº</code>å‘èµ·çš„ä¸€ä¸ªä»£ç ç”Ÿæˆå™¨å¼€æºé¡¹ç›®ï¼Œç›®å‰è¯¥å¼€æºé¡¹ç›®ç”±<code>è®¸è¿›ï¼Œä»»æµ©å†›ï¼Œæäº‘é¾™ï¼Œåˆ˜ç¾èƒœå¥‡</code>æŒç»­å¼€å‘è¿­ä»£ã€‚åŸºäºFreemarker+æ¨¡æ¿æ–‡ä»¶çš„ä»£ç ç”Ÿæˆå™¨ï¼Œå¯ä»¥æŒ‰éœ€å‹¾é€‰ç»„ä»¶ï¼Œè½»æ¾å¿«é€Ÿå®ç°å¯¹æ¡†æ¶ä»£ç çš„ä¸€é”®åˆ›å»ºï¼ˆä¾‹å¦‚ä¸šåŠ¡éƒ¨é—¨å®ç°å¯¹åŸºç¡€æ¶æ„éƒ¨æä¾›çš„æ¡†æ¶å¿«é€Ÿæ­å»ºï¼‰ï¼Œå®ç°å¯¹Spring Cloudçš„æœ€ä¼˜å®è·µå’Œé…ç½®å·¥å…·åŒ–å’Œè§„èŒƒåŒ–ã€‚</p><h3 id="1-3-åŠŸèƒ½"><a href="#1-3-åŠŸèƒ½" class="headerlink" title="1.3 åŠŸèƒ½"></a>1.3 åŠŸèƒ½</h3><p>æœ€ç»ˆåŠŸèƒ½åŒ…å«å¦‚ä¸‹ï¼ŒåŒ…æ‹¬å±è”½XXXæ³¨è§£å’Œé…ç½®</p><ul><li>generate app structure   â€”â€”&gt;çŠ¶æ€doing</li><li>generate java code and resources â€”â€”&gt;çŠ¶æ€todo</li><li>generate docker-compose.yml  â€”â€”&gt;çŠ¶æ€todo</li><li>generate .gitlab-ci.yml  â€”â€”&gt;çŠ¶æ€todo</li><li>generate DDD structure  â€”â€”&gt;çŠ¶æ€todo</li></ul><h2 id="äºŒ-èµ°è¿›Spring-Cloud-CodeGen"><a href="#äºŒ-èµ°è¿›Spring-Cloud-CodeGen" class="headerlink" title="äºŒ.èµ°è¿›Spring Cloud CodeGen"></a>äºŒ.èµ°è¿›Spring Cloud CodeGen</h2><h3 id="2-1-é¡¹ç›®ä»‹ç»"><a href="#2-1-é¡¹ç›®ä»‹ç»" class="headerlink" title="2.1 é¡¹ç›®ä»‹ç»"></a>2.1 é¡¹ç›®ä»‹ç»</h3><p><img src="/images/mw/project-ml.png" width="320px" height="350px"></p><p>é¡¹ç›®Demoåœ°å€:<a href="http://start.springcloud.cn/" target="_blank" rel="noopener">http://start.springcloud.cn/</a><br>é¡¹ç›®å¼€å‘äººå‘˜:<a href="http://www.xujin.org" target="_blank" rel="noopener">è®¸è¿›</a>,<a href="http://www.nepxion.com/" target="_blank" rel="noopener">ä»»æµ©å†›</a>,<a href="http://www.liumapp.com" target="_blank" rel="noopener">åˆ˜ç¾èƒœå¥‡</a>,<a href="#">æäº‘é¾™</a><br>githubåœ°å€:<br><a href="https://github.com/springcloud/spring-cloud-codegen" target="_blank" rel="noopener">https://github.com/springcloud/spring-cloud-codegen</a><br><a href="https://github.com/springcloud/spring-cloud-skeleton" target="_blank" rel="noopener">https://github.com/springcloud/spring-cloud-skeleton</a></p><h3 id="2-2-é¡¹ç›®æŠ€æœ¯é€‰å‹"><a href="#2-2-é¡¹ç›®æŠ€æœ¯é€‰å‹" class="headerlink" title="2.2 é¡¹ç›®æŠ€æœ¯é€‰å‹"></a>2.2 é¡¹ç›®æŠ€æœ¯é€‰å‹</h3><p>Spring Boot+Spring MVC+FreeMarker+Vue</p><h3 id="2-3-ä»£ç ç”Ÿæˆå™¨é…ç½®"><a href="#2-3-ä»£ç ç”Ÿæˆå™¨é…ç½®" class="headerlink" title="2.3 ä»£ç ç”Ÿæˆå™¨é…ç½®"></a>2.3 ä»£ç ç”Ÿæˆå™¨é…ç½®</h3><p>1.skeleton-data.properties<br>   ç”¨æ¥æè¿°æ¨¡æ¿æ–‡ä»¶çš„å…¨å±€é…ç½®å€¼ï¼Œé‡Œé¢çš„å€¼æ›¿æ¢æ¨¡æ¿æ–‡ä»¶é‡Œçš„åŠ¨æ€å˜é‡(ç”¨${}è¡¨ç¤º)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># ---------- å·¥ç¨‹é…ç½® ----------</span><br><span class="line"># moduleName=sales-project</span><br><span class="line">moduleName=sales</span><br><span class="line">basePackage=cn.springcloud</span><br><span class="line">pomGroupId=cn.springcloud</span><br><span class="line">pomArtifactId=sales</span><br><span class="line">pomName=springcloud sales</span><br><span class="line">pomVersion=1.0.0</span><br><span class="line">springCloudVersion=Dalston.SR4</span><br><span class="line">springBootVersion=1.5.6.RELEASE</span><br><span class="line">javaVersion=1.8</span><br><span class="line"></span><br><span class="line"># ---------- æ¡†æ¶é…ç½® ----------</span><br><span class="line">serviceName=spring-cloud-sales</span><br><span class="line">port=2222</span><br><span class="line">eurekaEnabled=true</span><br><span class="line">eurekaUrl=http://localhost:1111/eureka/</span><br></pre></td></tr></table></figure></p><ol><li>skeleton-description.xml</li></ol><p><img src="/images/mw/code-gen.png" width="520px" height="650px"></p><p>   å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç”¨æ¥æè¿°æ¨¡ç•Œé¢é©±åŠ¨å’Œæ¸²æŸ“çš„ç»„ä»¶ï¼Œåˆ†ä¸ºGroupå’ŒEntityç»“æ„ï¼Œä¸€ä¸ªGroupåŒ…å«å¤šä¸ªEntityï¼Œå…¶ä»–å±æ€§æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œä¸»è¦ä»‹ç»å¦‚ä¸‹<br>   highlightable - æ ‡è¯†ä¸ºé«˜äº®é¡¹ï¼Œä¸€èˆ¬ç»„ä»¶æ¸²æŸ“æˆé«˜äº®æ–¹å¼ï¼Œä¾‹å¦‚Labelçº¢è‰²å­—ä½“ï¼Œæç¤ºä½¿ç”¨è€…ç€é‡å…³æ³¨<br>   defaultable - æ ‡è¯†ä¸ºé»˜è®¤é¡¹ï¼Œä¸€èˆ¬ç»„ä»¶æ¸²æŸ“æˆé»˜è®¤é¡¹æ–¹å¼ï¼Œæç¤ºä½¿ç”¨è€…å¯ä»¥ä¸ä¿®æ”¹å¯¹åº”å€¼<br>   emptiable - æ ‡è¯†ä¸ºç•™ç©ºé¡¹ï¼Œä¸€èˆ¬ç»„ä»¶æ¸²æŸ“æˆç•™ç©ºé¡¹æ–¹å¼ï¼Œæç¤ºä½¿ç”¨è€…å¯¹åº”å€¼å¯ä»¥ä¸ºç©º<br>   editable - æ ‡è¯†ä¸ºä¸å¯ç¼–è¾‘é¡¹ï¼Œä¸€èˆ¬ç»„ä»¶æ¸²æŸ“æˆä¸å¯ç¼–è¾‘é¡¹æ–¹å¼ï¼Œå¦‚æœfalseåˆ™æŠŠç»„ä»¶ç°æ‰ï¼Œæç¤ºä½¿ç”¨è€…å¯¹åº”å€¼ä¸å¯ç¼–è¾‘</p><p>ç¤ºä¾‹Demoæ•°æ®å¦‚ä¸‹:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">skeleton</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å·¥ç¨‹åŸºæœ¬é…ç½® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">group</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>basic<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>pomGroupId<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Group<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>TEXTFIELD<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>pomArtifactId<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Artifact<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>TEXTFIELD<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>moduleName<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>å·¥ç¨‹æ¨¡å—å<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span>moduleName<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">note</span>&gt;</span>ã€å¿…æ”¹é¡¹ã€‘é¦–å­—æ¯å¿…é¡»å°å†™ï¼Œä¸­é—´åªå…è®¸å‡ºç°â€œ-â€<span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>TEXTFIELD<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>basePackage<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>ä¸Šå±‚åŒ…è·¯å¾„<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span>basePackage<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">note</span>&gt;</span>ã€å¿…æ”¹é¡¹ã€‘è¯¥è·¯å¾„ä¼šä½œä¸ºæ‰€æœ‰Javaä»£ç çš„ä¸Šå±‚è·¯å¾„ã€‚moduleNameã€basePackageå’ŒprojectTypeä¸‰è€…ç»„åˆèµ·æ¥è§£æå‡ºç›¸å…³ç›®å½•å’Œç»“æ„è§„åˆ™ï¼Œä¾‹å¦‚moduleName=payment-ccbï¼ŒbasePackage=com.nepxionï¼ŒprojectType=serverï¼Œé‚£ä¹ˆå·¥ç¨‹åä¸ºpayment-ccb-serverï¼Œç±»è·¯å¾„ä¸ºcom.nepxion.payment.ccb.server</span><br><span class="line">            <span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>TEXTFIELD<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>javaVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Java Version<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>COMBOBOX<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">options</span>&gt;</span>1.8;1.7;1.6<span class="tag">&lt;/<span class="name">options</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ˜¯å¦DockeråŒ– --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">group</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>docker-template<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>Dockeræ¨¡æ¿<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO_GROUP<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>HORIZONTAL<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>true<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>æ˜¯<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>false<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>å¦<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- åº”ç”¨ç±»å‹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">group</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>appType<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>åº”ç”¨ç±»å‹<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO_GROUP<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>HORIZONTAL<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>Spring Boot<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Spring Boot<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>Spring Cloud<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Spring Cloud<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">note</span>&gt;</span>Spring Cloudåº”ç”¨<span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>war<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>waråº”ç”¨<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Spring Cloudç‹¬ç«‹éƒ¨ç½²ç»„ä»¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">group</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>sc-alone<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>Spring Cloud<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO_GROUP<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>HORIZONTAL<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>ç‹¬ç«‹ç»„ä»¶<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>ç‹¬ç«‹ç»„ä»¶<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>service-provider<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>æœåŠ¡æä¾›è€…<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>service-consumer<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>æœåŠ¡æ¶ˆè´¹è€…<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- webåŸºç¡€æ¡†æ¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">group</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>basic-framework<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>åŸºç¡€æ¡†æ¶<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>åŸºç¡€æ¡†æ¶-1<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">type</span>&gt;</span>CHECKBOX_GROUP<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>HORIZONTAL<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>spring-mvc<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Spring MVC<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span>Spring MVC<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>CHECKBOX<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>Mybatis<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Mybatis<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span>Mybatis<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>CHECKBOX<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Spring Cloudç‹¬ç«‹éƒ¨ç½²å•é€‰ç»„ä»¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">group</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>sc-alone-radio<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>ç‹¬ç«‹ç»„ä»¶<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO_GROUP<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>HORIZONTAL<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>eureka-server<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Eureka Server<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>zuul-server<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Zuul Server<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>sc-gateway<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>SC Gateway<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>config-server<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Config Server<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>zipkin-server<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Zipkin Server<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>RADIO<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Spring Cloudå¯ç»„åˆå¤šé€‰ç»„ä»¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">group</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>sc-group-checkBox<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>å¯ç»„åˆç»„ä»¶<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Spring Cloudç»„ä»¶<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">type</span>&gt;</span>CHECKBOX_GROUP<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>HORIZONTAL<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>fegin<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Fegin<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span>Spring MVC<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>CHECKBOX<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>hystrix<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>hystrix<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span>hystrix<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>CHECKBOX<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entity</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>ribbon<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>Ribbon<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">description</span>&gt;</span>Ribbon<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>CHECKBOX<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">highlightable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">highlightable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">defaultable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">defaultable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">emptiable</span>&gt;</span>false<span class="tag">&lt;/<span class="name">emptiable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">editable</span>&gt;</span>true<span class="tag">&lt;/<span class="name">editable</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">skeleton</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-4-Spring-cloud-CodeGenå¼€å‘æ¥å£"><a href="#2-4-Spring-cloud-CodeGenå¼€å‘æ¥å£" class="headerlink" title="2.4 Spring-cloud-CodeGenå¼€å‘æ¥å£"></a>2.4 Spring-cloud-CodeGenå¼€å‘æ¥å£</h3><p>æ ¹æ®é…ç½®æ–‡ä»¶è¿›è¡Œç•Œé¢é©±åŠ¨çš„å…ƒæ•°æ®æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/getMetaData"</span>, method = RequestMethod.GET)</span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;SkeletonGroup&gt; <span class="title">getMetaData</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure><p>è¿”å›JSONæ ¼å¼çš„æ–‡ä»¶ï¼Œç®€å•ä»‹ç»ä¸€ä¸‹æ ¼å¼ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"key"</span>: <span class="string">"basic"</span>,</span><br><span class="line">        <span class="attr">"label"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"NORMAL_GROUP"</span>,</span><br><span class="line">        <span class="attr">"layoutType"</span>: <span class="string">"VERTICAL"</span>,</span><br><span class="line">        <span class="attr">"entityList"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"pomGroupId"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Group"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="string">"cn.springcloud"</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"TEXTFIELD"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"pomArtifactId"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Artifact"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="string">"sales"</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"TEXTFIELD"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"moduleName"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"å·¥ç¨‹æ¨¡å—å"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">"moduleName"</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="string">"ã€å¿…æ”¹é¡¹ã€‘é¦–å­—æ¯å¿…é¡»å°å†™ï¼Œä¸­é—´åªå…è®¸å‡ºç°â€œ-â€"</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="string">"sales"</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"TEXTFIELD"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"basePackage"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"ä¸Šå±‚åŒ…è·¯å¾„"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">"basePackage"</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="string">"ã€å¿…æ”¹é¡¹ã€‘è¯¥è·¯å¾„ä¼šä½œä¸ºæ‰€æœ‰Javaä»£ç çš„ä¸Šå±‚è·¯å¾„ã€‚moduleNameã€basePackageå’ŒprojectTypeä¸‰è€…ç»„åˆèµ·æ¥è§£æå‡ºç›¸å…³ç›®å½•å’Œç»“æ„è§„åˆ™ï¼Œä¾‹å¦‚moduleName=payment-ccbï¼ŒbasePackage=com.nepxionï¼ŒprojectType=serverï¼Œé‚£ä¹ˆå·¥ç¨‹åä¸ºpayment-ccb-serverï¼Œç±»è·¯å¾„ä¸ºcom.nepxion.payment.ccb.server"</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="string">"cn.springcloud"</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"TEXTFIELD"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"javaVersion"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Java Version"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="string">"1.8"</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"COMBOBOX"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: [</span><br><span class="line">                    <span class="string">"1.8"</span>,</span><br><span class="line">                    <span class="string">"1.7"</span>,</span><br><span class="line">                    <span class="string">"1.6"</span></span><br><span class="line">                ],</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"key"</span>: <span class="string">"docker-template"</span>,</span><br><span class="line">        <span class="attr">"label"</span>: <span class="string">"Dockeræ¨¡æ¿"</span>,</span><br><span class="line">        <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"RADIO_GROUP"</span>,</span><br><span class="line">        <span class="attr">"layoutType"</span>: <span class="string">"HORIZONTAL"</span>,</span><br><span class="line">        <span class="attr">"entityList"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"true"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"æ˜¯"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"false"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"å¦"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"key"</span>: <span class="string">"appType"</span>,</span><br><span class="line">        <span class="attr">"label"</span>: <span class="string">"åº”ç”¨ç±»å‹"</span>,</span><br><span class="line">        <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"RADIO_GROUP"</span>,</span><br><span class="line">        <span class="attr">"layoutType"</span>: <span class="string">"HORIZONTAL"</span>,</span><br><span class="line">        <span class="attr">"entityList"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"Spring Boot"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Spring Boot"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"Spring Cloud"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Spring Cloud"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="string">"Spring Cloudåº”ç”¨"</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"war"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"waråº”ç”¨"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"key"</span>: <span class="string">"sc-alone"</span>,</span><br><span class="line">        <span class="attr">"label"</span>: <span class="string">"Spring Cloud"</span>,</span><br><span class="line">        <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"RADIO_GROUP"</span>,</span><br><span class="line">        <span class="attr">"layoutType"</span>: <span class="string">"HORIZONTAL"</span>,</span><br><span class="line">        <span class="attr">"entityList"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"ç‹¬ç«‹ç»„ä»¶"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"ç‹¬ç«‹ç»„ä»¶"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"service-provider"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"æœåŠ¡æä¾›è€…"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"service-consumer"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"æœåŠ¡æ¶ˆè´¹è€…"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"key"</span>: <span class="string">"basic-framework"</span>,</span><br><span class="line">        <span class="attr">"label"</span>: <span class="string">"åŸºç¡€æ¡†æ¶"</span>,</span><br><span class="line">        <span class="attr">"description"</span>: <span class="string">"åŸºç¡€æ¡†æ¶-1"</span>,</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"CHECKBOX_GROUP"</span>,</span><br><span class="line">        <span class="attr">"layoutType"</span>: <span class="string">"HORIZONTAL"</span>,</span><br><span class="line">        <span class="attr">"entityList"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"spring-mvc"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Spring MVC"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">"Spring MVC"</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"CHECKBOX"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"Mybatis"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Mybatis"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">"Mybatis"</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"CHECKBOX"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"key"</span>: <span class="string">"sc-alone-radio"</span>,</span><br><span class="line">        <span class="attr">"label"</span>: <span class="string">"ç‹¬ç«‹ç»„ä»¶"</span>,</span><br><span class="line">        <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"RADIO_GROUP"</span>,</span><br><span class="line">        <span class="attr">"layoutType"</span>: <span class="string">"HORIZONTAL"</span>,</span><br><span class="line">        <span class="attr">"entityList"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"eureka-server"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Eureka Server"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"zuul-server"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Zuul Server"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"sc-gateway"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"SC Gateway"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"config-server"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Config Server"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"zipkin-server"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Zipkin Server"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"RADIO"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"key"</span>: <span class="string">"sc-group-checkBox"</span>,</span><br><span class="line">        <span class="attr">"label"</span>: <span class="string">"å¯ç»„åˆç»„ä»¶"</span>,</span><br><span class="line">        <span class="attr">"description"</span>: <span class="string">"Spring Cloudç»„ä»¶"</span>,</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"CHECKBOX_GROUP"</span>,</span><br><span class="line">        <span class="attr">"layoutType"</span>: <span class="string">"HORIZONTAL"</span>,</span><br><span class="line">        <span class="attr">"entityList"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"fegin"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Fegin"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">"Spring MVC"</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"CHECKBOX"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"hystrix"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"hystrix"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">"hystrix"</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"CHECKBOX"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"key"</span>: <span class="string">"ribbon"</span>,</span><br><span class="line">                <span class="attr">"label"</span>: <span class="string">"Ribbon"</span>,</span><br><span class="line">                <span class="attr">"description"</span>: <span class="string">"Ribbon"</span>,</span><br><span class="line">                <span class="attr">"note"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"value"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"CHECKBOX"</span>,</span><br><span class="line">                <span class="attr">"options"</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">"highlightable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"defaultable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"emptiable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"editable"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>ä¸‹è½½è„šæ‰‹æ¶Zipæ–‡ä»¶çš„æ¥å£ï¼Œè¿”å›Zipæ–‡ä»¶çš„byteæ•°ç»„ç±»å‹ï¼ŒBodyçš„å†…å®¹ä¸ºsrc\main\resources\config\skeleton-data.properties </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/downloadBytes"</span>, method = RequestMethod.POST)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">byte</span>[] downloadBytes(<span class="meta">@RequestBody</span> String config)</span><br></pre></td></tr></table></figure><p>ä¸‹è½½è„šæ‰‹æ¶Zipæ–‡ä»¶çš„æ¥å£ï¼Œè¿”å›Zipæ–‡ä»¶çš„ResponseEntityç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/downloadResponse"</span>, method = RequestMethod.POST)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ResponseEntity&lt;Resource&gt; <span class="title">downloadResponse</span><span class="params">(@RequestBody String config)</span></span></span><br></pre></td></tr></table></figure><h3 id="2-5-å‰ç«¯è¿è¡Œ"><a href="#2-5-å‰ç«¯è¿è¡Œ" class="headerlink" title="2.5 å‰ç«¯è¿è¡Œ"></a>2.5 å‰ç«¯è¿è¡Œ</h3><p>spring-cloud-codegen-uié‡‡ç”¨Vueå¼€å‘ï¼Œæœ¬åœ°å¼€å‘è°ƒè¯•ï¼Œé‡‡ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># install dependencies</span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line"># serve with hot reload at localhost:8081</span><br><span class="line">npm run dev</span><br><span class="line"></span><br><span class="line"># build for production with minification</span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æ‘˜è¦&lt;/strong&gt;:æœ¬æ–‡ä¸»è¦ä»‹ç»ç”±&lt;code&gt;Spring Cloudä¸­å›½ç¤¾åŒºå‘èµ·&lt;/code&gt;çš„ä»¥&lt;code&gt;Spring Cloudä¸ºä¸»&lt;/code&gt;çš„ä»£ç ç”Ÿæˆå™¨ï¼Œç›®çš„æ˜¯&lt;code&gt;å¿«é€Ÿï¼ŒæŒ‰éœ€å‹¾é€‰ï¼Œç”Ÿæˆæœ€ä¼˜å®è·µçš„Spring Cloudå·¥ç¨‹&lt;/code&gt;ã€‚æ¬¢è¿æœ‰æƒ³æ³•çš„&lt;code&gt;å°ä¼™ä¼´åŠ å…¥Spring Cloudä¸­å›½ç¤¾åŒºå¼€æºæˆ˜é˜Ÿ&lt;/code&gt;ï¼Œå…³äºä»£ç ç”Ÿæˆå™¨å’Œspring-cloud-codegençš„è®¾è®¡ç»†èŠ‚åé¢å°†æœ‰ä¸€ç³»åˆ—çš„æ–‡ç« ä»‹ç»ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¡¹ç›®ç»éªŒ" scheme="http://xujin.org/categories/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="é¡¹ç›®ç»éªŒ" scheme="http://xujin.org/tags/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"/>
    
      <category term="Spring Cloud" scheme="http://xujin.org/tags/Spring-Cloud/"/>
    
      <category term="ä»£ç ç”Ÿæˆå™¨" scheme="http://xujin.org/tags/%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>Spring initializræºç å·¥ç¨‹è§£æ</title>
    <link href="http://xujin.org/ex/spring-initializr/"/>
    <id>http://xujin.org/ex/spring-initializr/</id>
    <published>2017-12-09T06:00:00.000Z</published>
    <updated>2019-01-13T05:19:01.346Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯Spring-initializr"><a href="#ä»€ä¹ˆæ˜¯Spring-initializr" class="headerlink" title="ä»€ä¹ˆæ˜¯Spring initializr"></a>ä»€ä¹ˆæ˜¯Spring initializr</h2><h3 id="ä»€ä¹ˆæ˜¯Spring-initializr-1"><a href="#ä»€ä¹ˆæ˜¯Spring-initializr-1" class="headerlink" title="ä»€ä¹ˆæ˜¯Spring initializr"></a>ä»€ä¹ˆæ˜¯Spring initializr</h3><p>initializræ˜¯Springæä¾›çš„ä¸€ä¸ªå¿«é€Ÿæ ¹æ®æŒ‰éœ€ç”Ÿæˆå¸¦æœ‰Springé£æ ¼çš„å·¥ç¨‹çš„ä»£ç ç”Ÿæˆå™¨ã€‚<br>ä»£ç åœ°å€:<a href="https://github.com/spring-io/initializr/" target="_blank" rel="noopener">https://github.com/spring-io/initializr/</a><br>åœ¨çº¿åœ°å€:<a href="https://start.spring.io" target="_blank" rel="noopener">https://start.spring.io</a></p><a id="more"></a><h3 id="å·¥ç¨‹ç›®å½•è§£è¯»"><a href="#å·¥ç¨‹ç›®å½•è§£è¯»" class="headerlink" title="å·¥ç¨‹ç›®å½•è§£è¯»"></a>å·¥ç¨‹ç›®å½•è§£è¯»</h3><table><thead><tr><th>æ¨¡å—å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>initializr-actuator</td><td>å¯é€‰æ¨¡å—ï¼Œæä¾›ç»Ÿè®¡æ•°æ®å’ŒæŒ‡æ ‡</td></tr><tr><td>initializr-docs</td><td>æ–‡æ¡£</td></tr><tr><td>initializr-generator</td><td>å•ç‹¬çš„ç”Ÿæˆç±»åº“ï¼Œæ ¸å¿ƒæ¨¡å—ï¼Œå¯ä»¥å¼•å…¥è‡ªå·±çš„ä»£ç ç”Ÿæˆå™¨å·¥ç¨‹ä¸­</td></tr><tr><td>initializr-service</td><td>Spring Bootçš„ä¸»å…¥å£åº”ç”¨å·¥ç¨‹</td></tr><tr><td>initializr-web</td><td>RESTç«¯ç‚¹å’Œwebæ¥å£ï¼Œä¸»è¦æ˜¯Controllerç±»</td></tr></tbody></table><blockquote><p>æœªå®Œå¾…ç»­</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯Spring-initializr&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯Spring-initializr&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯Spring initializr&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯Spring initializr&lt;/h2&gt;&lt;h3 id=&quot;ä»€ä¹ˆæ˜¯Spring-initializr-1&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯Spring-initializr-1&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯Spring initializr&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯Spring initializr&lt;/h3&gt;&lt;p&gt;initializræ˜¯Springæä¾›çš„ä¸€ä¸ªå¿«é€Ÿæ ¹æ®æŒ‰éœ€ç”Ÿæˆå¸¦æœ‰Springé£æ ¼çš„å·¥ç¨‹çš„ä»£ç ç”Ÿæˆå™¨ã€‚&lt;br&gt;ä»£ç åœ°å€:&lt;a href=&quot;https://github.com/spring-io/initializr/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/spring-io/initializr/&lt;/a&gt;&lt;br&gt;åœ¨çº¿åœ°å€:&lt;a href=&quot;https://start.spring.io&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://start.spring.io&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="é¡¹ç›®ç»éªŒ" scheme="http://xujin.org/categories/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="Java" scheme="http://xujin.org/tags/Java/"/>
    
      <category term="é¡¹ç›®ç»éªŒ" scheme="http://xujin.org/tags/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"/>
    
  </entry>
  
</feed>
