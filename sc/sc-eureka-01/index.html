<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><title>ä½¿ç”¨Spring Cloud Eurekaå®ç°æœåŠ¡æ³¨å†Œä¸å‘ç° | è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="HaloğŸ’«"><meta name="designer" content="minfive"><meta name="keywords" content="è®¸è¿›|Spring Cloud,ä¸­é—´ä»¶ï¼ŒåŸºç¡€æ¶æ„ï¼Œwww.xujin.org,xujin.org,-è®¸è¿›æ²‰æ€å½•,Venus+,äº‘é¦–ç§‘æŠ€æœ‰é™å…¬å¸,äº‘è®¡ç®—ï¼Œå¤§æ•°æ®ï¼Œç‰©è”ç½‘ï¼ŒSoftware_kingçš„åšå®¢,äº‘è®¡ç®—Saasï¼Œäº‘è®¡ç®—Paasï¼Œäº‘è®¡ç®—Iaas Hadoopï¼Œå¤§æ•°æ®ï¼ŒJavaEEï¼ŒJavaï¼Œç‰©è”ç½‘ï¼ŒHadoopï¼Œ NoSQLï¼ŒMongoDB,Spring, Hibernate,Struts2,Shiro,Spring Security Activiti,JBPM"><meta name="description" content="Spring Cloudä¸­å›½ç¤¾åŒºåˆ›å§‹äººï¼Œå…¥èŒäºé˜¿é‡Œ,æ›¾å…¥èŒäºå”¯å“ä¼šä¸­é—´ä»¶,ä¸šä½™ä¸»è¦ç ”ç©¶Spring Cloudã€‚ã€Šé‡æ–°å®šä¹‰Spring Cloudå®æˆ˜ã€‹ä½œè€…"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="http://xujin.org/sc/sc-eureka-01/index.html"><link rel="icon" type="image/png" href="null" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?c54bda95ff8b34e8be2edd1d138812c1";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-117331438-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-117331438-1")</script><link rel="stylesheet" href="/scss/views/page/post.css"></head><body ontouchstart><div id="page-loading" class="page page-loading" style="background-image:url(/img/loading-small.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶" alt="è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶"><img src="http://xujin.org/css/images/logo.png" alt="è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="é¦–é¡µ" title="é¦–é¡µ">é¦–é¡µ</a></li><li class="nav__item"><a href="/archives" alt="å½’æ¡£" title="å½’æ¡£">å½’æ¡£</a></li><li class="nav__item"><a href="/about" alt="å…³äº" title="å…³äº">å…³äº</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><header class="post__info"><h1 class="post__title">ä½¿ç”¨Spring Cloud Eurekaå®ç°æœåŠ¡æ³¨å†Œä¸å‘ç°</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="http://xujin.org/">è®¸è¿›</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2017-03-23</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/Spring-Cloud-Eureka/">Spring Cloud Eureka</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-eye"></i><ul class="mark__list clearfix"><li id="busuanzi_container_page_pv" class="mark__item"><span id="busuanzi_value_page_pv"></span>æ¬¡</li></ul></div></div></header><div class="post__content"><p><strong>æ‘˜è¦</strong>:ç”±äºç›®å‰ï¼Œ<code>ç½‘ä¸Šçš„Spring Cloudçš„å­¦ä¹ çš„æ¡ˆåˆ—</code>ï¼Œæ¯”è¾ƒ<code>å‡Œä¹±</code>è€Œä¸”<code>æ²¡æœ‰å½¢æˆæ•´ä¸ªä½“ç³»</code>ï¼Œå› æ­¤ç‰¹å¼€ä¸€ä¸ªä¸“é¢˜ä¸º<code>è·Ÿæˆ‘å­¦Spring Cloud</code>ï¼Œå¸Œæœ›å¸®åŠ©åˆ°<code>æœ‰éœ€è¦çš„äºº</code>ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨<code>Spring Cloudä¸­çš„Eurekaç»„ä»¶</code>å¿«é€Ÿå®ç°<code>å¾®æœåŠ¡çš„æœåŠ¡æ³¨å†Œä¸å‘ç°</code>ã€‚è‡³äºå®‰å…¨æ¨¡å¼å’ŒEureka Serverçš„HA,åé¢çš„æ–‡ç« ä¼šè¯¦ç»†ä»‹ç»ã€‚å¦‚æœæ‚¨è§‰å¾—ï¼Œæœ‰æƒ³äº†è§£çš„å†…å®¹ï¼Œå‚ä¸è¯„è®ºç•™è¨€ã€‚<br><a id="more"></a></p><h2 id="ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œä¸å‘ç°"><a href="#ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œä¸å‘ç°" class="headerlink" title="ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œä¸å‘ç°"></a>ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œä¸å‘ç°</h2><h3 id="æœåŠ¡æ³¨å†Œä¸å‘ç°"><a href="#æœåŠ¡æ³¨å†Œä¸å‘ç°" class="headerlink" title="æœåŠ¡æ³¨å†Œä¸å‘ç°"></a>æœåŠ¡æ³¨å†Œä¸å‘ç°</h3><p>åœ¨æœåŠ¡åŒ–çš„æ—©æœŸï¼ŒæœåŠ¡ä¸æ˜¯å¾ˆå¤šï¼ŒæœåŠ¡çš„æ³¨å†Œä¸å‘ç°å¹¶ä¸æ˜¯ä»€ä¹ˆæ–°é²œçš„åè¯ï¼ŒNginx+å†…éƒ¨åŸŸåæœåŠ¡å™¨æ–¹å¼ï¼Œç”šè‡³Nginx+hostæ–‡ä»¶é…ç½®æ–¹å¼ä¹Ÿèƒ½å®ŒæˆæœåŠ¡çš„æ³¨å†Œä¸å‘ç°ã€‚æœåŠ¡ä¸Šä¸‹çº¿éœ€è¦åœ¨nginx,æœåŠ¡å™¨åšç›¸åº”çš„é…ç½®ï¼Œä¸€æ—¦æœåŠ¡çš„IPç«¯å£å‘ç”Ÿå˜åŒ–ï¼Œéƒ½éœ€è¦åœ¨nginxä¸Šåšç›¸åº”çš„é…ç½®ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å¼•å…¥æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚<br>æœåŠ¡æ³¨å†Œ,å³æœåŠ¡åœ¨å¯åŠ¨çš„æ—¶å€™å°±å°†æœåŠ¡çš„IP,ç«¯å£,ç‰ˆæœ¬å·ç­‰EndPointæ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ(Eueka,Zookeeper,Consul)å¯¹æœåŠ¡è¿›è¡Œç»Ÿä¸€ç®¡ç†.<br>æœåŠ¡å‘ç°,ç®€å•çš„å°±æ˜¯è¯´ï¼Œä¸ç®¡æœåŠ¡ä¸Šä¸‹çº¿ï¼Œå½“å¯¹æŸä¸ªæœåŠ¡å‘èµ·è¯·æ±‚æ—¶ï¼Œèƒ½å¤Ÿå¿«é€Ÿçš„ä»æœ¬åœ°ç¼“å­˜æˆ–è€…æ³¨å†Œä¸­å¿ƒçš„æ³¨å†Œåˆ—è¡¨ä¸­ï¼Œå¿«é€Ÿæ‰¾åˆ°æœåŠ¡æä¾›è€…ã€‚</p><h2 id="æœåŠ¡åŒ–æ—©æœŸçš„åšæ³•"><a href="#æœåŠ¡åŒ–æ—©æœŸçš„åšæ³•" class="headerlink" title="æœåŠ¡åŒ–æ—©æœŸçš„åšæ³•"></a>æœåŠ¡åŒ–æ—©æœŸçš„åšæ³•</h2><h3 id="ç¤ºä¾‹å·¥ç¨‹è¯´æ˜"><a href="#ç¤ºä¾‹å·¥ç¨‹è¯´æ˜" class="headerlink" title="ç¤ºä¾‹å·¥ç¨‹è¯´æ˜"></a>ç¤ºä¾‹å·¥ç¨‹è¯´æ˜</h3><blockquote><p><code>Tips</code>ï¼šä»£ç ç¤ºä¾‹:<a href="https://github.com/SoftwareKing/spring-cloud-study/tree/master/sc-eureka-first" target="_blank" rel="noopener">https://github.com/SoftwareKing/spring-cloud-study/tree/master/sc-eureka-first</a></p></blockquote><p><img src="/images/sc-study/sc-e-p.png" alt="å‚è€ƒå·¥ç¨‹"></p><h3 id="Spring-MVCä¸­åŸºäºæ— çŠ¶æ€çš„REST"><a href="#Spring-MVCä¸­åŸºäºæ— çŠ¶æ€çš„REST" class="headerlink" title="Spring MVCä¸­åŸºäºæ— çŠ¶æ€çš„REST"></a>Spring MVCä¸­åŸºäºæ— çŠ¶æ€çš„REST</h3><p>å·¥ç¨‹å¯ä»¥å‚è€ƒsc-rest-demoä¸‹é¢çš„sc-rest-providerå’Œsc-rest-consumerï¼Œå…·ä½“ä½¿ç”¨å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/sc"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä»å±æ€§æ–‡ä»¶ä¸­è¯»å–æœåŠ¡æä¾›çš„URL</span></span><br><span class="line">	<span class="meta">@Value</span>(<span class="string">"$&#123;order.orderServiceUrl&#125;"</span>)</span><br><span class="line">	<span class="keyword">private</span> String orderServiceUrl;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@GetMapping</span>(<span class="string">"/consumer/&#123;id&#125;"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> OrderModel <span class="title">getOrderInfo</span><span class="params">(@PathVariable Long id)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// this.restTemplate.getForObject("http://localhost:8000/sc/order/" +</span></span><br><span class="line">		<span class="comment">// id,OrderModel.class);</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.restTemplate.getForObject(<span class="keyword">this</span>.orderServiceUrl + <span class="string">"/sc/order/"</span> + id,</span><br><span class="line">				OrderModel.class);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><blockquote><p>å¤§å®¶æ³¨æ„åˆ°æ²¡ï¼ŒæŠŠ<a href="http://localhost:8000" target="_blank" rel="noopener">http://localhost:8000</a> ,ç¡¬ç¼–ç åˆ°ç¨‹åºä¸­ï¼Œæ˜¯ä¸æ˜¯æ¯”è¾ƒlowã€‚å¯ä»¥é‡‡ç”¨ä¸Šé¢ä»£ç ä¸­çš„æ–¹å¼ï¼šorderServiceUrlè§£å†³ã€‚ä½†æ˜¯è¿™æ ·è¿˜æ˜¯æ¯”è¾ƒlow,ä¸‹é¢ä»‹ç»ä¸€ä¸‹å¼•å…¥Eurekaå®ç°æœåŠ¡æ³¨å†Œä¸å‘ç°çš„å¤„ç†ã€‚</p></blockquote><h2 id="ä½¿ç”¨Eurekaå®ç°æœåŠ¡çš„æ³¨å†Œä¸å‘ç°"><a href="#ä½¿ç”¨Eurekaå®ç°æœåŠ¡çš„æ³¨å†Œä¸å‘ç°" class="headerlink" title="ä½¿ç”¨Eurekaå®ç°æœåŠ¡çš„æ³¨å†Œä¸å‘ç°"></a>ä½¿ç”¨Eurekaå®ç°æœåŠ¡çš„æ³¨å†Œä¸å‘ç°</h2><h3 id="æ­å»ºæ³¨å†Œä¸­å¿ƒ-Eureka-Server"><a href="#æ­å»ºæ³¨å†Œä¸­å¿ƒ-Eureka-Server" class="headerlink" title="æ­å»ºæ³¨å†Œä¸­å¿ƒ-Eureka Server"></a>æ­å»ºæ³¨å†Œä¸­å¿ƒ-Eureka Server</h3><p>1.å¼•å…¥ä¾èµ–<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- å¼•å…¥spring bootçš„ä¾èµ– --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sc-eureka-first-server-HA01<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>sc-eureka-first-server-HA01<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.apache.org<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- å¼•å…¥Spring Cloud Eurekaä¾èµ– --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- å¼•å…¥spring cloudçš„ä¾èµ– --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>Camden.SR5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- æ·»åŠ spring-bootçš„mavenæ’ä»¶--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><ol><li>åœ¨Resourcesç›®å½•ä¸‹åˆ›å»ºapplication.yml<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8761</span>                    <span class="comment"># æŒ‡å®šè¯¥Eurekaå®ä¾‹çš„ç«¯å£</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line"><span class="attr">  client:</span></span><br><span class="line">    <span class="comment">#è¡¨ç¤ºæ˜¯å¦å°†è‡ªå·±æ³¨å†Œåˆ°Eureka Serverä¸Šï¼Œé»˜è®¤ä¸ºtrueï¼Œå½“å‰åº”ç”¨ä¸ºEureka Serveræ‰€ä»¥æ— éœ€æ³¨å†Œ</span></span><br><span class="line"><span class="attr">    registerWithEureka:</span> <span class="literal">false</span>  </span><br><span class="line">    <span class="comment">#è¡¨ç¤ºæ˜¯å¦ä»Eureka Serverè·å–æ³¨å†Œä¿¡æ¯ï¼Œé»˜è®¤ä¸ºtrueã€‚å› ä¸ºè¿™æ˜¯ä¸€ä¸ªå•ç‚¹çš„Eureka Serverï¼Œä¸éœ€è¦åŒæ­¥å…¶ä»–çš„Eureka ServerèŠ‚ç‚¹çš„æ•°æ®ï¼Œæ•…è€Œè®¾ä¸ºfalseã€‚ </span></span><br><span class="line"><span class="attr">    fetchRegistry:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment">#Eureka Serverçš„è®¿é—®åœ°å€ï¼ŒæœåŠ¡æ³¨å†Œå’Œclientè·å–æœåŠ¡æ³¨å†Œä¿¡æ¯å‡é€šè¿‡è¯¥URLï¼Œå¤šä¸ªæœåŠ¡æ³¨å†Œåœ°å€ç”¨,éš”å¼€</span></span><br><span class="line"><span class="attr">    serviceUrl:</span></span><br><span class="line"><span class="attr">      defaultZone:</span> <span class="attr">http://localhost:8761/eureka/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚è€ƒæ–‡æ¡£ï¼šhttp://projects.spring.io/spring-cloud/docs/1.0.3/spring-cloud.html#_standalone_mode</span></span><br><span class="line"><span class="comment"># å‚è€ƒæ–‡æ¡£ï¼šhttp://my.oschina.net/buwei/blog/618756</span></span><br></pre></td></tr></table></figure></li></ol><p>3.åˆ›å»ºSpring Bootä¸»åº”ç”¨ç¨‹åºå¯åŠ¨ä»£ç <br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.xujin.sc.eureka.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Eureka Server</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> xujin</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringCloudEurekaServer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(SpringCloudEurekaServer.class, args);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>å¯åŠ¨Eureka serveræµ‹è¯•ï¼š<br>å¯åŠ¨sc-eureka-first-server-HA01ï¼Œè®¿é—®<a href="http://localhost:8761/" target="_blank" rel="noopener">http://localhost:8761/</a> ,å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="/images/sc-study/sc-e-1.png" alt="Eureka server"></p><h3 id="åˆ›å»ºæœåŠ¡æä¾›è€…"><a href="#åˆ›å»ºæœåŠ¡æä¾›è€…" class="headerlink" title="åˆ›å»ºæœåŠ¡æä¾›è€…"></a>åˆ›å»ºæœåŠ¡æä¾›è€…</h3><p>1.æœåŠ¡æä¾›è€…ï¼Œä¸ºäº†æ¼”ç¤ºåœ¨è¿™é‡Œæä¾›ä¸€ä¸ªç®€å•çš„<code>è®¢å•æŸ¥è¯¢æœåŠ¡</code>ï¼Œå¦‚å·¥ç¨‹<code>sc-eureka-first-provider01</code>å’Œ<code>sc-eureka-first-provider02</code>æ‰€ç¤ºã€‚<br>2.ä¸»ç¨‹åºå…¥å£ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.xujin.sc.eureka.first.order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æœåŠ¡æä¾›è€…ç«¯ï¼ŒåŠ ä¸Š<span class="doctag">@EnableDiscoveryClient</span>æ³¨è§£ï¼Œå®ŒæˆæœåŠ¡æ³¨å†Œã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> xujin</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@site</span> http://xujin.org</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="comment">// @EnableEurekaClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderProviderSpringBootAppliaction</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(OrderProviderSpringBootAppliaction.class, args);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><blockquote><p><code>Tips</code>:å¦‚æœä½¿ç”¨Eureka, å¯ä»¥ä½¿ç”¨@EnableEurekaClientæ³¨è§£ï¼Œä½†æ˜¯æ¨èä½¿ç”¨@EnableDiscoveryClientä»£æ›¿@EnableEurekaClientæ³¨è§£ï¼Œå› ä¸º@EnableDiscoveryClientæ˜¯ä¸€ä¸ªé«˜åº¦çš„æŠ½è±¡ï¼Œ æ¥è‡ªäºspring-cloud-commonsï¼Œ ç”±äºSpring Cloudé€‰å‹æ˜¯ä¸­ç«‹çš„å› æ­¤æŠ½è±¡å‡ºè¯¥æ¥å£ï¼Œ å½“æœåŠ¡æ³¨å†Œä¸­å¿ƒé€‰å‹æ”¹å˜ä¸ºEurekaï¼ŒZKï¼ŒConsulæ—¶ï¼Œä¸éœ€è¦ä¿®æ”¹åŸæœ‰ä»£ç ä¸­çš„æ³¨è§£ã€‚</p></blockquote><p>3.æœåŠ¡æä¾›è€…æš´éœ²çš„æœåŠ¡-OrderController.java<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> OrderService orderService;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@GetMapping</span>(<span class="string">"/sc/order/&#123;id&#125;"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> OrderModel <span class="title">findOrderById</span><span class="params">(@PathVariable Long id)</span> </span>&#123;</span><br><span class="line">		OrderModel orderModel = orderService.findOrderByOrderId(id);</span><br><span class="line">		<span class="keyword">return</span> orderModel;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>å¯åŠ¨æœåŠ¡æä¾›è€…ï¼ŒæŠŠæœåŠ¡æ³¨å†Œä¿¡æ¯ï¼Œæ³¨å†Œåˆ°Eureka Serveræ³¨å†Œä¸­å¿ƒ<br>å¯åŠ¨sc-eureka-first-provider01,å½“å¯åŠ¨å…¶ä¸­ä¸€ä¸ªæœåŠ¡ååˆ·æ–°Eureka Serverä¼šå‡ºç°å®‰å…¨æ¨¡å¼,å¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="/images/sc-study/sc-e-safe.png" alt="å®‰å…¨æ¨¡å¼"></p><p>å¯åŠ¨sc-eureka-first-provider02ï¼Œåˆ·æ–°Eureka Serverå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><img src="/images/sc-study/sc-e-safe-2.png" alt="å®‰å…¨æ¨¡å¼"></p><h3 id="åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…"><a href="#åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…" class="headerlink" title="åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…"></a>åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…</h3><p>æœåŠ¡æ¶ˆè´¹è€…ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ç”¨æˆ·æœåŠ¡ï¼Œç”¨æˆ·æœåŠ¡æŸ¥è¯¢è®¢å•æœåŠ¡çš„è®¢å•ä¿¡æ¯ã€‚<br>1.å¼•å…¥ç›¸åº”çš„ä¾èµ–<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?xml version="1.0"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.xujin.sc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sc-eureka-first-consumer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>sc-eureka-first-consumer<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.apache.org<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- å¼•å…¥spring bootçš„ä¾èµ– --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.16.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- å¼•å…¥spring cloudçš„ä¾èµ– --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">version</span>&gt;</span>Camden.SR4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- æ·»åŠ spring-bootçš„mavenæ’ä»¶ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>2.ä¸»ç¨‹åºå…¥å£ä»£ç <br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.xujin.sc.eureka.user;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶ˆè´¹è€…ç«¯åŠ å…¥æœåŠ¡å‘ç°æ³¨è§£</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserConsumerApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> RestTemplate <span class="title">restTemplate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> RestTemplate();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(UserConsumerApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><ol><li>æ¶ˆè´¹è€…è°ƒç”¨Controllerã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(UserController.class);</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> DiscoveryClient discoveryClient;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// discoveryClientè·å–æœåŠ¡åˆ—è¡¨ä¸­ï¼Œåº”ç”¨åä¸ºsc-eureka-first-providerä¸€ä¸ªæœåŠ¡æ³¨å†Œä¿¡æ¯</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">serviceUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		List&lt;ServiceInstance&gt; list = discoveryClient</span><br><span class="line">				.getInstances(<span class="string">"sc-eureka-first-provider"</span>);</span><br><span class="line">		<span class="keyword">if</span> (list != <span class="keyword">null</span> &amp;&amp; list.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> String.valueOf(list.get(<span class="number">0</span>).getUri());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@GetMapping</span>(<span class="string">"/sc/user/&#123;id&#125;"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Order <span class="title">findByIdByEurekaServer</span><span class="params">(@PathVariable Long id)</span> </span>&#123;</span><br><span class="line">		String providerServiceUrl = serviceUrl();</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.restTemplate.getForObject(providerServiceUrl + <span class="string">"sc/order/"</span> + id,</span><br><span class="line">				Order.class);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚ä¸Šè¿°ä»£ç ï¼Œæ‰€ç¤ºä½¿ç”¨<code>discoveryClient.getInstances(&quot;sc-eureka-first-provider&quot;)</code>è·å–æœåŠ¡åä¸º<code>sc-eureka-first-provider</code>çš„æœåŠ¡æ³¨å†Œåˆ—è¡¨ä¿¡æ¯ã€‚</p></blockquote><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>å…ˆåå¯åŠ¨sc-eureka-first-consumer,å¦‚æ²¡æœ‰å¼‚å¸¸ï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—®:<a href="http://localhost:8010/sc/user/2" target="_blank" rel="noopener">http://localhost:8010/sc/user/2</a> ,debugå¦‚ä¸‹æ‰€ç¤ºå¯ä»¥çœ‹åˆ°<br><img src="/images/sc-study/sc-e-consumer-1.png" alt="æœåŠ¡æä¾›è€…ç«¯æœåŠ¡å‘ç°"></p><p>åœ¨åˆ·æ–°ä¸€ä¸‹Eureka Serverï¼Œå¦‚å›¾ä¸‹æ‰€ç¤º,æ­¤æ—¶å®‰å…¨æ¨¡å¼å…³é—­ã€‚<br><img src="/images/sc-study/sc-e-safe-3.png" alt="Eureka Server"></p><blockquote><p>å…³äºå®‰å…¨æ¨¡å¼ï¼Œåœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæš‚ä¸è®¨è®ºï¼Œåé¢å°†ä¼šä¸“å†™ä¸€ç¯‡æ–‡ç« ä»‹ç»ï¼Œè¯·æš‚æ—¶å¿½ç•¥ã€‚</p></blockquote><h3 id="è·å–æ¶ˆè´¹è€…è·å–æœåŠ¡ç«¯æ¶ˆè´¹åˆ—è¡¨"><a href="#è·å–æ¶ˆè´¹è€…è·å–æœåŠ¡ç«¯æ¶ˆè´¹åˆ—è¡¨" class="headerlink" title="è·å–æ¶ˆè´¹è€…è·å–æœåŠ¡ç«¯æ¶ˆè´¹åˆ—è¡¨"></a>è·å–æ¶ˆè´¹è€…è·å–æœåŠ¡ç«¯æ¶ˆè´¹åˆ—è¡¨</h3><ol><li><p>ä½¿ç”¨EurekaClientè·å–æœåŠ¡æ³¨å†Œä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> EurekaClient discoveryClient;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">serviceUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    InstanceInfo instance = discoveryClient.getNextServerFromEureka(<span class="string">"STORES"</span>, <span class="keyword">false</span>);</span><br><span class="line">    <span class="keyword">return</span> instance.getHomePageUrl();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨DiscoveryClientè·å–æœåŠ¡æ³¨å†Œä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> DiscoveryClient discoveryClient;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">serviceUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;ServiceInstance&gt; list = discoveryClient.getInstances(<span class="string">"STORES"</span>);</span><br><span class="line">    <span class="keyword">if</span> (list != <span class="keyword">null</span> &amp;&amp; list.size() &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="keyword">return</span> list.get(<span class="number">0</span>).getUri();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://github.com/spring-cloud/spring-cloud-netflix/blob/master/docs/src/main/asciidoc/spring-cloud-netflix.adoc" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-netflix/blob/master/docs/src/main/asciidoc/spring-cloud-netflix.adoc</a></p></li></ol><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>ä¸Šé¢è¿™ä¸ªä¾‹å­ä½¿ç”¨Eurekaå®ç°äº†æœåŠ¡çš„æ³¨å†Œä¸å‘ç°ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯è·å–æœåŠ¡æ³¨å†Œåˆ—è¡¨çš„æ–¹å¼æ¯”è¾ƒlowå¹¶ä¸”å¤ªæ–¹ä¾¿ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ²¡æœ‰ä½¿ç”¨è´Ÿè½½å‡è¡¡ï¼ˆLoad Balance)ï¼Œè¿™æ ·å°±æ²¡æ³•å®ç°å¾®æœåŠ¡çš„HAã€‚åœ¨åé¢çš„æ–‡ç« å°†ä¼šä»‹ç»Eureka Serverçš„HAå’Œä½¿ç”¨Robbinå®ç°LBã€‚ã€‚</p><div class="post-announce">æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œæœ¬æ–‡ç”± <a href="http://xujin.org">è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶</a> ç‰ˆæƒæ‰€æœ‰ã€‚å¦‚è‹¥è½¬è½½ï¼Œè¯·æ³¨æ˜å‡ºå¤„ï¼šè®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶ï¼ˆ<a href="http://xujin.org/sc/sc-eureka-01/">http://xujin.org/sc/sc-eureka-01/</a>ï¼‰</div><div class="post__prevs"><div class="post__prev"><a href="/sc/sc-eureka-cancle/" title="Spring Cloud EurekaæœåŠ¡ä¸‹çº¿(Cancel)æºç åˆ†æ"><i class="iconfont icon-prev"></i>Spring Cloud EurekaæœåŠ¡ä¸‹çº¿(Cancel)æºç åˆ†æ</a></div><div class="post__prev post__prev--right"><a href="/sc/sc-eureka-02/" title="SCä¸­Eureka Serverçš„HAå’Œå®‰å…¨èº«ä»½éªŒè¯">SCä¸­Eureka Serverçš„HAå’Œå®‰å…¨èº«ä»½éªŒè¯<i class="iconfont icon-next"></i></a></div></div></div></article><div id="comment-container"></div></div><aside class="page__sidebar"><div id="toc" class="toc-article"><h3 class="block__title">æ–‡ç« ç›®å½•</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œä¸å‘ç°"><span class="toc-number">1.</span> <span class="toc-text">ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œä¸å‘ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æœåŠ¡æ³¨å†Œä¸å‘ç°"><span class="toc-number">1.1.</span> <span class="toc-text">æœåŠ¡æ³¨å†Œä¸å‘ç°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æœåŠ¡åŒ–æ—©æœŸçš„åšæ³•"><span class="toc-number">2.</span> <span class="toc-text">æœåŠ¡åŒ–æ—©æœŸçš„åšæ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ç¤ºä¾‹å·¥ç¨‹è¯´æ˜"><span class="toc-number">2.1.</span> <span class="toc-text">ç¤ºä¾‹å·¥ç¨‹è¯´æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-MVCä¸­åŸºäºæ— çŠ¶æ€çš„REST"><span class="toc-number">2.2.</span> <span class="toc-text">Spring MVCä¸­åŸºäºæ— çŠ¶æ€çš„REST</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½¿ç”¨Eurekaå®ç°æœåŠ¡çš„æ³¨å†Œä¸å‘ç°"><span class="toc-number">3.</span> <span class="toc-text">ä½¿ç”¨Eurekaå®ç°æœåŠ¡çš„æ³¨å†Œä¸å‘ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ­å»ºæ³¨å†Œä¸­å¿ƒ-Eureka-Server"><span class="toc-number">3.1.</span> <span class="toc-text">æ­å»ºæ³¨å†Œä¸­å¿ƒ-Eureka Server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ›å»ºæœåŠ¡æä¾›è€…"><span class="toc-number">3.2.</span> <span class="toc-text">åˆ›å»ºæœåŠ¡æä¾›è€…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…"><span class="toc-number">3.3.</span> <span class="toc-text">åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æµ‹è¯•"><span class="toc-number">4.</span> <span class="toc-text">æµ‹è¯•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#è·å–æ¶ˆè´¹è€…è·å–æœåŠ¡ç«¯æ¶ˆè´¹åˆ—è¡¨"><span class="toc-number">4.1.</span> <span class="toc-text">è·å–æ¶ˆè´¹è€…è·å–æœåŠ¡ç«¯æ¶ˆè´¹åˆ—è¡¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å°ç»“"><span class="toc-number">5.</span> <span class="toc-text">å°ç»“</span></a></li></ol></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">å…³äº</h3><div class="item__content"><p class="item__text">è½¯ä»¶ä¸–ç•Œå°±æ˜¯æ¨¡æ‹Ÿå®¢è§‚ä¸–ç•Œï¼Œéœ€æ±‚åˆ†æï¼ŒæŠ€æœ¯é©±åŠ¨ï¼Œä»è€Œæ”¹å˜ä¸–ç•Œ!</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Shang Hai, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>Software_King@@qq.com</span></li></ul></div></div><div class="footer-top__item footer__image"><img src="/img/wx.jpeg" alt="logo" title="è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶"></div><div class="footer-top__item"><h3 class="item__title">å‹æƒ…é“¾æ¥</h3><div class="item__content"><ul class="footer-top__list"><li class="list-item"><a href="http://www.xujin.org" title="è®¸è¿›|æ²‰æ€å½•" target="_blank">è®¸è¿›|æ²‰æ€å½•</a></li><li class="list-item"><a href="http://springcloud.cn" title="Spring Cloudä¸­å›½ç¤¾åŒº" target="_blank">Spring Cloudä¸­å›½ç¤¾åŒº</a></li><li class="list-item"><a href="http://www.cnblogs.com/ACMer/" title="æˆ‘çš„åšå®¢å›­" target="_blank">æˆ‘çš„åšå®¢å›­</a></li><li class="list-item"><a href="http://blog.sina.com.cn/softwaremi" title="æ–°æµªåšå®¢" target="_blank">æ–°æµªåšå®¢</a></li><li class="list-item"><a href="http://blog.chingzhu.com/" title="æœ±æ¸…åšå®¢" target="_blank">æœ±æ¸…åšå®¢</a></li><li class="list-item"><a href="http://tietang.wang/" title="é“æ±¤åšå®¢" target="_blank">é“æ±¤åšå®¢</a></li><li class="list-item"><a href="http://blog.csdn.net/forezp" title="æ–¹å¿—æœ‹çš„åšå®¢" target="_blank">æ–¹å¿—æœ‹çš„åšå®¢</a></li></ul></div></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">Powered by <a href="http://xujin.org/" target="_blank">Halo</a>, Made by <a href="https://github.com/softwareking" target="_blank">HaloğŸ’«</a>.</p><ul class="footer__social-network clearfix"><li class="social-network__item"><a href="https://github.com/softwareking" target="_blank" title="github"><i class="iconfont icon-github"></i></a></li><li class="social-network__item"><a href="/atom.xml" target="_blank" title="rss"><i class="iconfont icon-rss"></i></a></li><li class="social-network__item"><a href="/atom.xml" target="_blank" title="linkedin"><i class="iconfont icon-in"></i></a></li><li class="social-network__item"><a href="mailto:softwareking@qq.com" target="_blank" title="email"><i class="iconfont icon-email"></i></a></li></ul><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span>ğŸ€<span class="post-count">27.0k</span> </span><span>| </span><span id="busuanzi_container_site_uv" style="display:inline">ğŸ‘½<span id="busuanzi_value_site_uv">1000000</span><span></span></span><span class="footer-separator"> | </span><span id="busuanzi_container_site_pv" style="display:inline">ğŸŒ€<span id="busuanzi_value_site_pv">1000000</span><span></span></span></div></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/md5.min.js"></script><script>var tags=["Spring Cloud Eureka"],gitalk=new Gitalk({clientID:"322a00ea1ee28f04ba14",clientSecret:"01916d619a774e744b5e7b73bf4faa3d14b53bcc",repo:"iratel.github.io",owner:"SoftwareKing",admin:["SoftwareKing"],labels:tags,id:new Date(14902488e5).getTime()>new Date("2018-02-15").getTime()?md5(location.href):location.href});gitalk.render("comment-container")</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>