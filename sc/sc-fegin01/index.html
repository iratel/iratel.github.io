<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><title>å¿«é€Ÿä½¿ç”¨Spring Cloud Feignä½œä¸ºå®¢æˆ·ç«¯è°ƒç”¨æœåŠ¡æä¾›è€… | è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="HaloğŸ’«"><meta name="designer" content="minfive"><meta name="keywords" content="è®¸è¿›|Spring Cloud,ä¸­é—´ä»¶ï¼ŒåŸºç¡€æ¶æ„ï¼Œwww.xujin.org,xujin.org,-è®¸è¿›æ²‰æ€å½•,Venus+,äº‘é¦–ç§‘æŠ€æœ‰é™å…¬å¸,äº‘è®¡ç®—ï¼Œå¤§æ•°æ®ï¼Œç‰©è”ç½‘ï¼ŒSoftware_kingçš„åšå®¢,äº‘è®¡ç®—Saasï¼Œäº‘è®¡ç®—Paasï¼Œäº‘è®¡ç®—Iaas Hadoopï¼Œå¤§æ•°æ®ï¼ŒJavaEEï¼ŒJavaï¼Œç‰©è”ç½‘ï¼ŒHadoopï¼Œ NoSQLï¼ŒMongoDB,Spring, Hibernate,Struts2,Shiro,Spring Security Activiti,JBPM"><meta name="description" content="Spring Cloudä¸­å›½ç¤¾åŒºåˆ›å§‹äººï¼Œå…¥èŒäºé˜¿é‡Œ,æ›¾å…¥èŒäºå”¯å“ä¼šä¸­é—´ä»¶,ä¸šä½™ä¸»è¦ç ”ç©¶Spring Cloudã€‚ã€Šé‡æ–°å®šä¹‰Spring Cloudå®æˆ˜ã€‹ä½œè€…"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="http://xujin.org/sc/sc-fegin01/index.html"><link rel="icon" type="image/png" href="null" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?c54bda95ff8b34e8be2edd1d138812c1";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-117331438-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-117331438-1")</script><link rel="stylesheet" href="/scss/views/page/post.css"></head><body ontouchstart><div id="page-loading" class="page page-loading" style="background-image:url(/img/loading-small.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶" alt="è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶"><img src="http://xujin.org/css/images/logo.png" alt="è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="é¦–é¡µ" title="é¦–é¡µ">é¦–é¡µ</a></li><li class="nav__item"><a href="/archives" alt="å½’æ¡£" title="å½’æ¡£">å½’æ¡£</a></li><li class="nav__item"><a href="/about" alt="å…³äº" title="å…³äº">å…³äº</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><header class="post__info"><h1 class="post__title">å¿«é€Ÿä½¿ç”¨Spring Cloud Feignä½œä¸ºå®¢æˆ·ç«¯è°ƒç”¨æœåŠ¡æä¾›è€…</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="http://xujin.org/">è®¸è¿›</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2017-05-13</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/Spring-Cloud-Fegin/">Spring Cloud Fegin</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-eye"></i><ul class="mark__list clearfix"><li id="busuanzi_container_page_pv" class="mark__item"><span id="busuanzi_value_page_pv"></span>æ¬¡</li></ul></div></div></header><div class="post__content"><p><strong>å‰è¨€</strong> åœ¨ä½¿ç”¨Spring Cloudå¼€å‘å¾®æœåŠ¡åº”ç”¨æ—¶ä¸­ï¼Œå„ä¸ªå¾®æœåŠ¡æœåŠ¡æä¾›è€…éƒ½æ˜¯ä»¥HTTPæ¥å£çš„å½¢å¼å¯¹å¤–æä¾›æœåŠ¡ï¼Œå› æ­¤æœåŠ¡æ¶ˆè´¹è€…åœ¨è°ƒç”¨æœåŠ¡æä¾›è€…æ—¶ï¼Œé€šè¿‡HTTP Clientçš„æ–¹å¼è®¿é—®ã€‚å½“ç„¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨JDKåŸç”Ÿçš„<code>URLConnection</code>ã€<code>Apacheçš„Http Client</code>ã€<code>Nettyçš„å¼‚æ­¥HTTP Client</code>, Springçš„<code>RestTemplate</code>å»å®ç°æœåŠ¡é—´çš„è°ƒç”¨ã€‚Spring Cloudå¯¹Feginè¿›è¡Œäº†å¢å¼ºï¼Œä½¿Feginæ”¯æŒäº†Spring MVCçš„æ³¨è§£ï¼Œå¹¶æ•´åˆäº†Ribbonå’ŒEurekaï¼Œä»è€Œè®©Feginçš„ä½¿ç”¨æ›´åŠ æ–¹ä¾¿ã€‚</p><h2 id="Feignç®€ä»‹"><a href="#Feignç®€ä»‹" class="headerlink" title="Feignç®€ä»‹"></a>Feignç®€ä»‹</h2><p>Feignæ˜¯ä¸€ç§å£°æ˜å¼ã€æ¨¡æ¿åŒ–çš„HTTPå®¢æˆ·ç«¯ã€‚åœ¨<strong>Spring Cloud</strong>ä¸­ä½¿ç”¨Feign, å¯ä»¥åšåˆ°ä½¿ç”¨HTTP<strong>è¯·æ±‚è¿œç¨‹æœåŠ¡</strong>æ—¶èƒ½å°±åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·çš„ä½“éªŒï¼Œå¼€å‘è€…å®Œå…¨æ„ŸçŸ¥ä¸åˆ°è¿™æ˜¯è¿œç¨‹æ–¹æ³•ï¼Œæ›´æ„ŸçŸ¥ä¸åˆ°è¿™æ˜¯ä¸ªHTTPè¯·æ±‚ã€‚<a href="https://github.com/openfeign/feign" target="_blank" rel="noopener">Feignçš„Githubç½‘å€</a>,æ¯”å¦‚ï¼š<br>Feignå…·æœ‰å¦‚ä¸‹ç‰¹æ€§ï¼š</p><ul><li>å¯æ’æ‹”çš„æ³¨è§£æ”¯æŒï¼ŒåŒ…æ‹¬Feignæ³¨è§£å’ŒJAX-RSæ³¨è§£</li><li>æ”¯æŒå¯æ’æ‹”çš„HTTPç¼–ç å™¨å’Œè§£ç å™¨</li><li>æ”¯æŒHystrixå’Œå®ƒçš„Fallback</li><li>æ”¯æŒRibbonçš„è´Ÿè½½å‡è¡¡</li><li>æ”¯æŒHTTPè¯·æ±‚å’Œå“åº”çš„å‹ç¼©<a id="more"></a> Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„<strong>Web Service</strong>å®¢æˆ·ç«¯ï¼Œå®ƒçš„ç›®çš„å°±æ˜¯è®©<strong>Web Service</strong>è°ƒç”¨æ›´åŠ ç®€å•ã€‚å®ƒæ•´åˆäº†<code>Ribbon</code>å’Œ<code>Hystrix</code>ï¼Œä»è€Œä¸å†éœ€è¦æ˜¾å¼åœ°ä½¿ç”¨è¿™ä¸¤ä¸ªç»„ä»¶ã€‚Feignè¿˜æä¾›äº†HTTPè¯·æ±‚çš„æ¨¡æ¿ï¼Œé€šè¿‡ç¼–å†™ç®€å•çš„æ¥å£å’Œæ³¨è§£ï¼Œå°±å¯ä»¥å®šä¹‰å¥½HTTPè¯·æ±‚çš„å‚æ•°ã€æ ¼å¼ã€åœ°å€ç­‰ä¿¡æ¯ã€‚æ¥ä¸‹æ¥ï¼ŒFeignä¼šå®Œå…¨ä»£ç†HTTPçš„è¯·æ±‚ï¼Œæˆ‘ä»¬åªéœ€è¦åƒè°ƒç”¨æ–¹æ³•ä¸€æ ·è°ƒç”¨å®ƒå°±å¯ä»¥å®ŒæˆæœåŠ¡è¯·æ±‚ã€‚<h2 id="Feign-ç¤ºä¾‹å·¥ç¨‹"><a href="#Feign-ç¤ºä¾‹å·¥ç¨‹" class="headerlink" title="Feign ç¤ºä¾‹å·¥ç¨‹"></a>Feign ç¤ºä¾‹å·¥ç¨‹</h2></li></ul><p><img src="/images/sc-study/sc-feign-ml.png" alt="å·¥ç¨‹ç›®å½•"><br>é“¾æ¥ï¼š<a href="https://github.com/SoftwareKing/spring-cloud-study/tree/master/sc-feign-first" target="_blank" rel="noopener">https://github.com/SoftwareKing/spring-cloud-study/tree/master/sc-feign-first</a></p><blockquote><p>æœ¬æ–‡æœ€ç»ˆä¿®æ”¹æ—¶é—´ï¼š2017-05-20 18:47:23ï¼Œä¸ºäº†è§£å†³<code>é—®é¢˜1å’Œ2</code>æœ€ç»ˆä½¿ç”¨ç‰ˆæœ¬:Spring Bootçš„ç‰ˆæœ¬ä¸º<code>1.5.3.RELEASE</code>ï¼ŒSpring Cloudç‰ˆæœ¬ä¸º<code>Dalston.RELEASE</code></p></blockquote><h3 id="æœåŠ¡æ¶ˆè´¹è€…ä¸­sc-feign-first-consumerçš„Feignçš„å®šä¹‰"><a href="#æœåŠ¡æ¶ˆè´¹è€…ä¸­sc-feign-first-consumerçš„Feignçš„å®šä¹‰" class="headerlink" title="æœåŠ¡æ¶ˆè´¹è€…ä¸­sc-feign-first-consumerçš„Feignçš„å®šä¹‰"></a>æœåŠ¡æ¶ˆè´¹è€…ä¸­sc-feign-first-consumerçš„Feignçš„å®šä¹‰</h3><p>ä¸ºäº†è®©FeignçŸ¥é“åœ¨è°ƒç”¨æ–¹æ³•æ—¶åº”è¯¥å‘å“ªä¸ªåœ°å€å‘è¯·æ±‚ä»¥åŠè¯·æ±‚éœ€è¦å¸¦å“ªäº›å‚æ•°ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªæ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.xujin.sc.feign.user.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.feign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.xujin.sc.feign.user.model.OrderModel;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FeignClient</span>(name = <span class="string">"sc-feign-first-provider"</span>)<span class="comment">//ã€Aã€‘</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserFeignService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/sc/order/&#123;id&#125;"</span>, method = RequestMethod.GET)<span class="comment">//ã€Bã€‘</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> OrderModel <span class="title">findOrderById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Long id)</span>; <span class="comment">//ã€Cã€‘</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>A: @FeignClientç”¨äºé€šçŸ¥Feignç»„ä»¶å¯¹è¯¥æ¥å£è¿›è¡Œä»£ç†(ä¸éœ€è¦ç¼–å†™æ¥å£å®ç°)ï¼Œä½¿ç”¨è€…å¯ç›´æ¥é€šè¿‡@Autowiredæ³¨å…¥ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// æ³¨å…¥æœåŠ¡æä¾›è€…,è¿œç¨‹çš„HttpæœåŠ¡</span></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserFeignService userFeignService;</span><br></pre></td></tr></table></figure><blockquote><p>B: @RequestMappingè¡¨ç¤ºåœ¨è°ƒç”¨è¯¥æ–¹æ³•æ—¶éœ€è¦å‘/sc/order/{id}å‘é€GETè¯·æ±‚ã€‚</p><p>C: @PathVariableä¸SpringMVCä¸­å¯¹åº”æ³¨è§£å«ä¹‰ç›¸åŒ</p></blockquote><h3 id="æœåŠ¡æ¶ˆè´¹è€…ä¸­Feignçš„ä½¿ç”¨"><a href="#æœåŠ¡æ¶ˆè´¹è€…ä¸­Feignçš„ä½¿ç”¨" class="headerlink" title="æœåŠ¡æ¶ˆè´¹è€…ä¸­Feignçš„ä½¿ç”¨"></a>æœåŠ¡æ¶ˆè´¹è€…ä¸­Feignçš„ä½¿ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.xujin.sc.feign.user.controller;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> org.xujin.sc.feign.user.model.OrderModel;</span><br><span class="line"><span class="keyword">import</span> org.xujin.sc.feign.user.service.UserFeignService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * UserController</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> xujin</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(UserController.class);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ³¨å…¥æœåŠ¡æä¾›è€…,è¿œç¨‹çš„HttpæœåŠ¡</span></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserFeignService userFeignService;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æœåŠ¡æ¶ˆè´¹è€…å¯¹ä½æä¾›çš„æœåŠ¡</span></span><br><span class="line">	<span class="meta">@GetMapping</span>(<span class="string">"/sc/user/&#123;id&#125;"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> OrderModel <span class="title">findByIdByEurekaServer</span><span class="params">(@PathVariable Long id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userFeignService.findOrderById(id);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œé€šè¿‡@Autowiredå°†å£°æ˜çš„Feignä¾èµ–æ³¨å…¥å³å¯ï¼Œè°ƒç”¨userFeignService.findOrderById(id)ä½¿ç”¨ã€‚å¼€å‘è€…é€šè¿‡userFeignService.findOrderById()å°±èƒ½å®Œæˆå‘é€HTTPè¯·æ±‚å’Œè§£ç HTTPè¿”å›ç»“æœå¹¶å°è£…æˆå¯¹è±¡çš„è¿‡ç¨‹ã€‚</p></blockquote><h3 id="å¯åŠ¨æµ‹è¯•"><a href="#å¯åŠ¨æµ‹è¯•" class="headerlink" title="å¯åŠ¨æµ‹è¯•"></a>å¯åŠ¨æµ‹è¯•</h3><p>ä¾æ¬¡æŒ‰é¡ºåºå¯åŠ¨å¦‚ä¸‹å·¥ç¨‹<br>æ³¨å†Œä¸­å¿ƒ: sc-fegin-first-server<br>æœåŠ¡æä¾›è€…1:sc-fegin-first-provider01<br>æœåŠ¡æä¾›è€…2:sc-fegin-first-provider02<br>ä»¥ä¸Šå·¥ç¨‹èƒ½æ­£å¸¸å¯åŠ¨workï¼Œä½†æ˜¯å½“å¯åŠ¨æœåŠ¡æ¶ˆè´¹è€…: sc-fegin-first-consumeræŠ¥é”™å¦‚ä¸‹ã€‚</p><blockquote><p>ä½¿ç”¨çš„ç¤ºä¾‹å·¥ç¨‹çš„Spring Bootçš„ç‰ˆæœ¬ä¸º1.5.2.RELEASEï¼ŒSpring Cloudç‰ˆæœ¬ä¸ºDalston.RELEASEä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ã€‚</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼•å…¥spring bootçš„ä¾èµ– --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">&lt;!-- å¼•å…¥spring cloudçš„ä¾èµ– --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>Dalston.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®<a href="http://localhost:8010/sc/user/1" target="_blank" rel="noopener">http://localhost:8010/sc/user/1</a> ,å‡ºç°ä»¥ä¸‹é”™è¯¯å³ï¼š<br><code>ã€é—®é¢˜ä¸€ã€‘</code>feign/Feign$Builder<br>Caused by: java.lang.NoClassDefFoundError: feign/Feign$Builder<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">java.lang.IllegalStateException: ApplicationEventMulticaster not initialized - call &apos;refresh&apos; before multicasting events via the context: org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@2d140a7: startup date [Sun May 14 22:44:43 CST 2017]; parent: org.springframework.context.annotation.AnnotationConfigApplicationContext@4bf48f6</span><br><span class="line">	at org.springframework.context.support.AbstractApplicationContext.getApplicationEventMulticaster(AbstractApplicationContext.java:404) [spring-context-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.context.support.ApplicationListenerDetector.postProcessBeforeDestruction(ApplicationListenerDetector.java:97) ~[spring-context-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DisposableBeanAdapter.destroy(DisposableBeanAdapter.java:253) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.destroyBean(DefaultSingletonBeanRegistry.java:578) [spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.destroySingleton(DefaultSingletonBeanRegistry.java:554) [spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultListableBeanFactory.destroySingleton(DefaultListableBeanFactory.java:961) [spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.destroySingletons(DefaultSingletonBeanRegistry.java:523) [spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultListableBeanFactory.destroySingletons(DefaultListableBeanFactory.java:968) [spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.context.support.AbstractApplicationContext.destroyBeans(AbstractApplicationContext.java:1033) [spring-context-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:555) [spring-context-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.refresh(EmbeddedWebApplicationContext.java:122) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:737) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:370) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.springframework.boot.SpringApplication.run(SpringApplication.java:314) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1162) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1151) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.xujin.sc.feign.user.UserConsumerApplication.main(UserConsumerApplication.java:15) [classes/:na]</span><br><span class="line"></span><br><span class="line">2017-05-14 22:44:44.079 ERROR 2372 --- [           main] o.s.boot.SpringApplication               : Application startup failed</span><br><span class="line"></span><br><span class="line">org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;methodValidationPostProcessor&apos; defined in class path resource [org/springframework/boot/autoconfigure/validation/ValidationAutoConfiguration.class]: Unsatisfied dependency expressed through method &apos;methodValidationPostProcessor&apos; parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;org.xujin.sc.feign.user.service.UserFeignService&apos;: Failed to introspect bean class [org.springframework.cloud.netflix.feign.FeignClientFactoryBean] for lookup method metadata: could not find class that it depends on; nested exception is java.lang.NoClassDefFoundError: feign/Feign$Builder</span><br><span class="line">	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:467) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1173) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1067) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:513) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:483) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.context.support.PostProcessorRegistrationDelegate.registerBeanPostProcessors(PostProcessorRegistrationDelegate.java:223) ~[spring-context-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:702) ~[spring-context-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:527) ~[spring-context-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.refresh(EmbeddedWebApplicationContext.java:122) ~[spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:737) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:370) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.springframework.boot.SpringApplication.run(SpringApplication.java:314) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1162) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1151) [spring-boot-1.5.2.RELEASE.jar:1.5.2.RELEASE]</span><br><span class="line">	at org.xujin.sc.feign.user.UserConsumerApplication.main(UserConsumerApplication.java:15) [classes/:na]</span><br><span class="line">Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;org.xujin.sc.feign.user.service.UserFeignService&apos;: Failed to introspect bean class [org.springframework.cloud.netflix.feign.FeignClientFactoryBean] for lookup method metadata: could not find class that it depends on; nested exception is java.lang.NoClassDefFoundError: feign/Feign$Builder</span><br><span class="line">	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:269) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1118) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1091) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.getSingletonFactoryBeanForTypeCheck(AbstractAutowireCapableBeanFactory.java:923) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.getTypeForFactoryBean(AbstractAutowireCapableBeanFactory.java:804) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractBeanFactory.isTypeMatch(AbstractBeanFactory.java:558) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doGetBeanNamesForType(DefaultListableBeanFactory.java:432) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanNamesForType(DefaultListableBeanFactory.java:395) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.BeanFactoryUtils.beanNamesForTypeIncludingAncestors(BeanFactoryUtils.java:220) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1260) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1101) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1066) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:835) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	... 19 common frames omitted</span><br><span class="line">Caused by: java.lang.NoClassDefFoundError: feign/Feign$Builder</span><br><span class="line">	at java.lang.Class.getDeclaredMethods0(Native Method) ~[na:1.8.0_112]</span><br><span class="line">	at java.lang.Class.privateGetDeclaredMethods(Class.java:2701) ~[na:1.8.0_112]</span><br><span class="line">	at java.lang.Class.getDeclaredMethods(Class.java:1975) ~[na:1.8.0_112]</span><br><span class="line">	at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:613) ~[spring-core-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.util.ReflectionUtils.doWithMethods(ReflectionUtils.java:524) ~[spring-core-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.util.ReflectionUtils.doWithMethods(ReflectionUtils.java:510) ~[spring-core-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:247) ~[spring-beans-4.3.7.RELEASE.jar:4.3.7.RELEASE]</span><br><span class="line">	... 32 common frames omitted</span><br><span class="line">Caused by: java.lang.ClassNotFoundException: feign.Feign$Builder</span><br><span class="line">	at java.net.URLClassLoader.findClass(URLClassLoader.java:381) ~[na:1.8.0_112]</span><br><span class="line">	at java.lang.ClassLoader.loadClass(ClassLoader.java:424) ~[na:1.8.0_112]</span><br><span class="line">	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331) ~[na:1.8.0_112]</span><br><span class="line">	at java.lang.ClassLoader.loadClass(ClassLoader.java:357) ~[na:1.8.0_112]</span><br><span class="line">	... 39 common frames omitted</span><br></pre></td></tr></table></figure><p></p><p><img src="/images/sc-study/sc-feign1.png" alt="sc-feign1"></p><hr><p>ç»æŸ¥æ‰¾è§£å†³é—®é¢˜2å¤©æŸ¥çœ‹æ— æœ(æ‚è„¸ï¼Œåé¢å†™æºç åˆ†æå®šä½)ï¼Œå› æ­¤å†³å®šå°†Spring Bootçš„ç‰ˆæœ¬æ”¹å˜ä¸º1.4.3.RELEASEï¼ŒSpring Cloudç‰ˆæœ¬ä¸ºCamden.SR5ä¹‹å,æŒ‰ä¸Šé¢çš„é¡ºåºå¯åŠ¨ï¼Œä¹‹åæµ‹è¯•<a href="http://localhost:8010/sc/user/1" target="_blank" rel="noopener">http://localhost:8010/sc/user/1</a> ,å¯ä»¥æ­£å¸¸workã€‚</p><h2 id="Feginçš„workåŸç†"><a href="#Feginçš„workåŸç†" class="headerlink" title="Feginçš„workåŸç†"></a>Feginçš„workåŸç†</h2><p>Spring Cloudåº”ç”¨åœ¨å¯åŠ¨æ—¶ï¼ŒFeignä¼š<code>æ‰«ææ ‡æœ‰@FeignClient</code>æ³¨è§£çš„æ¥å£ï¼Œ<code>ç”Ÿæˆä»£ç†</code>ï¼Œå¹¶æ³¨å†Œåˆ°<code>Springå®¹å™¨ä¸­</code>ã€‚ç”Ÿæˆä»£ç†æ—¶Feignä¼šä¸º<code>æ¯ä¸ªæ¥å£æ–¹æ³•åˆ›å»ºä¸€ä¸ªRequetTemplateå¯¹è±¡</code>ï¼Œè¯¥å¯¹è±¡<code>å°è£…äº†HTTPè¯·æ±‚</code>éœ€è¦çš„å…¨éƒ¨ä¿¡æ¯ï¼Œè¯·æ±‚å‚æ•°åã€è¯·æ±‚æ–¹æ³•ç­‰ä¿¡æ¯éƒ½æ˜¯åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ç¡®å®šçš„ï¼ŒFeignçš„æ¨¡æ¿åŒ–å°±ä½“ç°åœ¨è¿™é‡Œã€‚<br>åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†Feignä¸Eurekaå’ŒRibbonç»„åˆä½¿ç”¨ï¼Œ@FeignClient(name = â€œsc-feign-first-providerâ€)æ„ä¸ºé€šçŸ¥Feignåœ¨è°ƒç”¨è¯¥æ¥å£æ–¹æ³•æ—¶è¦å‘Eurekaä¸­æŸ¥è¯¢åä¸ºeaçš„æœåŠ¡ï¼Œä»è€Œå¾—åˆ°æœåŠ¡URLã€‚</p><h2 id="Feginçš„å¸¸è§åº”ç”¨"><a href="#Feginçš„å¸¸è§åº”ç”¨" class="headerlink" title="Feginçš„å¸¸è§åº”ç”¨"></a>Feginçš„å¸¸è§åº”ç”¨</h2><h3 id="Feignçš„Encoderã€Decoderå’ŒErrorDecoder"><a href="#Feignçš„Encoderã€Decoderå’ŒErrorDecoder" class="headerlink" title="Feignçš„Encoderã€Decoderå’ŒErrorDecoder"></a>Feignçš„Encoderã€Decoderå’ŒErrorDecoder</h3><p>Feignå°†æ–¹æ³•ç­¾åä¸­æ–¹æ³•å‚æ•°å¯¹è±¡åºåˆ—åŒ–ä¸ºè¯·æ±‚å‚æ•°æ”¾åˆ°HTTPè¯·æ±‚ä¸­çš„è¿‡ç¨‹ï¼Œæ˜¯ç”±ç¼–ç å™¨(Encoder)å®Œæˆçš„ã€‚åŒç†ï¼Œå°†HTTPå“åº”æ•°æ®ååºåˆ—åŒ–ä¸ºjavaå¯¹è±¡æ˜¯ç”±è§£ç å™¨(Decoder)å®Œæˆçš„ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒFeignä¼šå°†æ ‡æœ‰@RequestParamæ³¨è§£çš„å‚æ•°è½¬æ¢æˆå­—ç¬¦ä¸²æ·»åŠ åˆ°URLä¸­ï¼Œå°†æ²¡æœ‰æ³¨è§£çš„å‚æ•°é€šè¿‡Jacksonè½¬æ¢æˆjsonæ”¾åˆ°è¯·æ±‚ä½“ä¸­ã€‚</p><blockquote><p>æ³¨æ„ï¼Œå¦‚æœåœ¨@RequetMappingä¸­çš„methodå°†è¯·æ±‚æ–¹å¼æŒ‡å®šä¸ºGETï¼Œé‚£ä¹ˆæ‰€æœ‰æœªæ ‡æ³¨è§£çš„å‚æ•°å°†ä¼šè¢«å¿½ç•¥ï¼Œä¾‹å¦‚ï¼š</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/group/&#123;groupId&#125;"</span>, method = RequestMethod.GET)</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(@PathVariable(<span class="string">"groupId"</span>)</span> Integer groupId, @<span class="title">RequestParam</span><span class="params">(<span class="string">"groupName"</span>)</span> String groupName, DataObject obj)</span>;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å› ä¸ºå£°æ˜çš„æ˜¯GETè¯·æ±‚æ²¡æœ‰è¯·æ±‚ä½“ï¼Œæ‰€ä»¥objå‚æ•°å°±ä¼šè¢«å¿½ç•¥ã€‚</p><ul><li>åœ¨Spring Cloudç¯å¢ƒä¸‹ï¼ŒFeignçš„Encoderåªä¼šç”¨æ¥ç¼–ç æ²¡æœ‰æ·»åŠ æ³¨è§£çš„å‚æ•°ã€‚å¦‚æœä½ è‡ªå®šä¹‰äº†Encoder, é‚£ä¹ˆåªæœ‰åœ¨ç¼–ç objå‚æ•°æ—¶æ‰ä¼šè°ƒç”¨ä½ çš„Encoderã€‚</li><li>å¯¹äºDecoder, é»˜è®¤ä¼šå§”æ‰˜ç»™SpringMVCä¸­çš„MappingJackson2HttpMessageConverterç±»è¿›è¡Œè§£ç ã€‚åªæœ‰å½“çŠ¶æ€ç ä¸åœ¨200 ~ 300ä¹‹é—´æ—¶ErrorDecoderæ‰ä¼šè¢«è°ƒç”¨ã€‚</li><li>ErrorDecoderçš„ä½œç”¨æ˜¯å¯ä»¥æ ¹æ®HTTPå“åº”ä¿¡æ¯è¿”å›ä¸€ä¸ªå¼‚å¸¸ï¼Œè¯¥å¼‚å¸¸å¯ä»¥åœ¨è°ƒç”¨Feignæ¥å£çš„åœ°æ–¹è¢«æ•è·åˆ°ã€‚<br>æˆ‘ä»¬ç›®å‰å°±é€šè¿‡ErrorDecoderæ¥ä½¿Feignæ¥å£æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸ä»¥ä¾›è°ƒç”¨è€…å¤„ç†ã€‚</li></ul><h3 id="æ›´æ¢Feigné»˜è®¤ä½¿ç”¨çš„HTTP-Client"><a href="#æ›´æ¢Feigné»˜è®¤ä½¿ç”¨çš„HTTP-Client" class="headerlink" title="æ›´æ¢Feigné»˜è®¤ä½¿ç”¨çš„HTTP Client"></a>æ›´æ¢Feigné»˜è®¤ä½¿ç”¨çš„HTTP Client</h3><p>Feignåœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„æ˜¯JDKåŸç”Ÿçš„<code>URLConnection</code>å‘é€HTTPè¯·æ±‚ï¼Œæ²¡æœ‰è¿æ¥æ± ï¼Œä½†æ˜¯å¯¹æ¯ä¸ªåœ°å€ä¼šä¿æŒä¸€ä¸ªé•¿è¿æ¥ï¼Œå³åˆ©ç”¨HTTPçš„persistence connection ã€‚æˆ‘ä»¬å¯ä»¥ç”¨Apacheçš„<code>HTTP Client</code>æ›¿æ¢FeignåŸå§‹çš„http client, ä»è€Œè·å–<code>è¿æ¥æ± ã€è¶…æ—¶æ—¶é—´</code>ç­‰ä¸æ€§èƒ½æ¯æ¯ç›¸å…³çš„æ§åˆ¶èƒ½åŠ›ã€‚Spring Cloudä»Brixtion.SR5ç‰ˆæœ¬å¼€å§‹æ”¯æŒè¿™ç§æ›¿æ¢ï¼Œé¦–å…ˆåœ¨é¡¹ç›®ä¸­å£°æ˜Apache HTTP Clientå’Œfeign-httpclientä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä½¿ç”¨Apache HttpClientæ›¿æ¢FeignåŸç”Ÿhttpclient --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.httpcomponents<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>httpclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.netflix.feign<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>feign-httpclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.17.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨<code>application.yml</code>ä¸­æ·»åŠ å¦‚ä¸‹ï¼š<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">feign:</span><br><span class="line">  httpclient:</span><br><span class="line">    enabled: true</span><br></pre></td></tr></table></figure><p></p><p><a href="https://segmentfault.com/a/1190000009071952" target="_blank" rel="noopener">spring cloud feignä½¿ç”¨okhttp3å‚è€ƒ</a></p><h2 id="spring-cloud-feignå¸¸è§é—®é¢˜"><a href="#spring-cloud-feignå¸¸è§é—®é¢˜" class="headerlink" title="spring cloud feignå¸¸è§é—®é¢˜"></a>spring cloud feignå¸¸è§é—®é¢˜</h2><h3 id="å‚æ•°ä¸ä¼šè‡ªåŠ¨ä¼ é€’"><a href="#å‚æ•°ä¸ä¼šè‡ªåŠ¨ä¼ é€’" class="headerlink" title="å‚æ•°ä¸ä¼šè‡ªåŠ¨ä¼ é€’"></a>å‚æ•°ä¸ä¼šè‡ªåŠ¨ä¼ é€’</h3><p>æœåŠ¡æ¶ˆè´¹è€…ç«¯è°ƒç”¨<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/test"</span>, method = RequestMethod.GET)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(@RequestParam(<span class="string">"name"</span>)</span> String name, @<span class="title">RequestParam</span><span class="params">(<span class="string">"age"</span>)</span> <span class="keyword">int</span> age) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userFeignService.hello(name, age);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure><p></p><p>æœåŠ¡æä¾›è€…Controllerå¯¹å¤–æœåŠ¡<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/hello"</span>, method = RequestMethod.GET)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(@RequestParam(<span class="string">"name"</span>)</span> String name, @<span class="title">RequestParam</span><span class="params">(<span class="string">"age"</span>)</span> <span class="keyword">int</span> age) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name + age;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure><p></p><p>Feginå®¢æˆ·ç«¯å®šä¹‰è°ƒç”¨<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/hello"</span>, method = RequestMethod.GET)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(String name, @RequestParam(<span class="string">"age"</span>)</span> <span class="keyword">int</span> age)</span>;</span><br></pre></td></tr></table></figure><p></p><p>å¯åŠ¨çš„æ—¶å€™sc-fegin-first-consumerå·¥ç¨‹ä¸æŠ¥é”™ã€‚ä½†æ˜¯å½“è®¿é—®<a href="http://localhost:8010/test?name=xujin&amp;age=25" target="_blank" rel="noopener">http://localhost:8010/test?name=xujin&amp;age=25</a> ,æŠ¥é”™å¦‚ä¸‹<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">feign.FeignException: status 405 reading UserFeignService#hello(String,int); content:</span><br><span class="line">&#123;&quot;timestamp&quot;:1494856464666,&quot;status&quot;:405,&quot;error&quot;:&quot;Method Not Allowed&quot;,&quot;exception&quot;:&quot;org.springframework.web.HttpRequestMethodNotSupportedException&quot;,&quot;message&quot;:&quot;Request method &apos;POST&apos; not supported&quot;,&quot;path&quot;:&quot;/hello&quot;&#125;</span><br><span class="line">	at feign.FeignException.errorStatus(FeignException.java:62) ~[feign-core-9.3.1.jar:na]</span><br></pre></td></tr></table></figure><p></p><p>Feginå®¢æˆ·ç«¯å®šä¹‰ä¿®æ”¹å¦‚ä¸‹OKï¼ŒåŸå› æ˜¯nameè¢«è‡ªåŠ¨æ”¾åˆ°request bodyã€‚åªè¦æœ‰bodyï¼Œå°±ä¼šè¢«feignè®¤ä¸ºæ˜¯postè¯·æ±‚ï¼Œæ‰€ä»¥æ•´ä¸ªhelloæ˜¯è¢«å½“ä½œå¸¦æœ‰request parameterå’Œbodyçš„postè¯·æ±‚å‘é€å‡ºå»äº†ï¼Œå› æ­¤å‡ºç°ä¸Šé¢çš„é”™è¯¯æç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/hello"</span>, method = RequestMethod.GET)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(@RequestParam(<span class="string">"name"</span>)</span> String name, @<span class="title">RequestParam</span><span class="params">(<span class="string">"age"</span>)</span> <span class="keyword">int</span> age)</span>;</span><br></pre></td></tr></table></figure><h3 id="POSTå¤šå‚æ•°è°ƒç”¨"><a href="#POSTå¤šå‚æ•°è°ƒç”¨" class="headerlink" title="POSTå¤šå‚æ•°è°ƒç”¨"></a>POSTå¤šå‚æ•°è°ƒç”¨</h3><ul><li>POSTå¤šå‚æ•° Feignç«¯å®šä¹‰ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/test/post"</span>, method = RequestMethod.POST)</span><br><span class="line"><span class="function"><span class="keyword">public</span> OrderModel <span class="title">post</span><span class="params">(OrderModel orderModel)</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/test/post"</span>, method = RequestMethod.POST)</span><br><span class="line"><span class="function"><span class="keyword">public</span> OrderModel <span class="title">post</span><span class="params">(@RequestBody OrderModel orderModel)</span></span>;</span><br></pre></td></tr></table></figure><blockquote><p>ä»¥ä¸Šä¸¤ç§å®šä¹‰æ–¹å¼ç­‰ä»·</p></blockquote><ul><li>æœåŠ¡æä¾›è€…çš„å®šä¹‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/test/post"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> OrderModel <span class="title">testPost</span><span class="params">(@RequestBody OrderModel orderModel)</span> </span>&#123;</span><br><span class="line">	orderModel.setOrderNo(<span class="number">2222222L</span>);</span><br><span class="line">	<span class="keyword">return</span> orderModel;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¿®æ”¹è®¢å•å·è¿”å›è¯æ˜ï¼ŒæœåŠ¡æä¾›è€…æ¥åˆ°ä»Feign POSTè¯·æ±‚è¿‡æ¥çš„æ•°æ®ã€‚</p></blockquote><ul><li>æœåŠ¡æ¶ˆè´¹è€…ç«¯çš„ä½¿ç”¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/test/post"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> OrderModel <span class="title">testPost</span><span class="params">(@RequestBody OrderModel orderModel)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> userFeignService.post(orderModel);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•<br>å½“ä¿®æ”¹äº†Feigné»˜è®¤çš„http Clientä¹‹åï¼Œå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼Œå…·ä½“å‡ºé”™åŸå› è¿˜åœ¨æ’æŸ¥ä¹‹ä¸­ï¼Œæœ¬æ–‡ä¼šéšæ—¶æ›´æ”¹ã€‚<br><code>ã€é—®é¢˜äºŒã€‘</code>æ›´æ¢äº†Feigné»˜è®¤çš„Clientå‡ºç°HystrixRuntimeException<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"timestamp"</span>: <span class="number">1494947172990</span>,</span><br><span class="line">    <span class="attr">"status"</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="attr">"error"</span>: <span class="string">"Internal Server Error"</span>,</span><br><span class="line">    <span class="attr">"exception"</span>: <span class="string">"com.netflix.hystrix.exception.HystrixRuntimeException"</span>,</span><br><span class="line">    <span class="attr">"message"</span>: <span class="string">"UserFeignService#post(OrderModel) failed and no fallback available."</span>,</span><br><span class="line">    <span class="attr">"path"</span>: <span class="string">"/test/post"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">java.lang.IllegalArgumentException: MIME type may not contain reserved characters</span><br><span class="line">	at org.apache.http.util.Args.check(Args.java:36) ~[httpcore-4.4.5.jar:4.4.5]</span><br><span class="line">	at org.apache.http.entity.ContentType.create(ContentType.java:182) ~[httpcore-4.4.5.jar:4.4.5]</span><br><span class="line">	at feign.httpclient.ApacheHttpClient.getContentType(ApacheHttpClient.java:159) ~[feign-httpclient-8.17.0.jar:8.17.0]</span><br><span class="line">	at feign.httpclient.ApacheHttpClient.toHttpUriRequest(ApacheHttpClient.java:140) ~[feign-httpclient-8.17.0.jar:8.17.0]</span><br><span class="line">	at feign.httpclient.ApacheHttpClient.execute(ApacheHttpClient.java:83) ~[feign-httpclient-8.17.0.jar:8.17.0]</span><br></pre></td></tr></table></figure><p>å½“å…³é—­ä¹‹åï¼Œè®¿é—®æ­£å¸¸å¦‚ä¸‹æ‰€ç¤ºï¼Œé†‰äº†åŒæ ·çš„ä»£ç (PS:æ‚è„¸)</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line"><span class="attr">  httpclient:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"createTime"</span>:<span class="number">1494944311023</span>,<span class="attr">"orderNo"</span>:<span class="number">33333</span>,<span class="attr">"payTime"</span>:<span class="number">1494944311023</span>&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/sc-study/sc-feign-post.png" alt="sc-feign-post.png"></p><h3 id="GETå¤šå‚æ•°è°ƒç”¨"><a href="#GETå¤šå‚æ•°è°ƒç”¨" class="headerlink" title="GETå¤šå‚æ•°è°ƒç”¨"></a>GETå¤šå‚æ•°è°ƒç”¨</h3><p>å½“æœåŠ¡ä¹‹é—´GETè°ƒç”¨ä¸ºå¤šå‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨Mapæ¥æ„å»ºå‚æ•°ä¼ é€’<br>Feignæ¥å£ä¸­çš„ç¤ºä¾‹å®šä¹‰<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/test/get"</span>, method = RequestMethod.GET)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testGet</span><span class="params">(@RequestParam Map&lt;String, Object&gt; map)</span></span>;</span><br></pre></td></tr></table></figure><p></p><p>æœåŠ¡æ¶ˆè´¹è€…çš„è°ƒç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/test/get"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testGet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	HashMap&lt;String, Object&gt; map = Maps.newHashMap();</span><br><span class="line">	map.put(<span class="string">"orderNo"</span>, <span class="string">"1"</span>);</span><br><span class="line">	map.put(<span class="string">"createTime"</span>, <span class="keyword">new</span> Date());</span><br><span class="line">	map.put(<span class="string">"payTime"</span>, <span class="keyword">new</span> Date());</span><br><span class="line">	<span class="keyword">return</span> userFeignService.testGet(map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸ªäººçœ‹æ¥ï¼Œå¦‚æœæ˜¯GETçš„å¤šå‚æ•°é€šè¿‡Mapè¿›è¡Œä¼ é€’ï¼Œå½“å‚æ•°æ¯”è¾ƒå¤šæ—¶ï¼Œä¸ªäººå»ºè®®ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ€ç»´ï¼Œé€šè¿‡POSTçš„æ–¹å¼ä¼ é€’å¯¹è±¡ç›¸å¯¹è¾ƒå¥½ã€‚</p></blockquote><p>æœåŠ¡æä¾›è€…çš„ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/test/get"</span>, method = RequestMethod.GET)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testGet</span><span class="params">(@RequestParam Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> String.valueOf(map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¿é—®URL:<a href="http://localhost:8010/test/get" target="_blank" rel="noopener">http://localhost:8010/test/get</a> ,æµ‹è¯•OK.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;orderNo=1, createTime=Sat May 20 19:47:38 CST 2017, payTime=Sat May 20 19:47:38 CST 2017&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†Feignçš„åŸºæœ¬çš„å®šä¹‰ï¼Œä»¥åŠFeignçš„workåŸç†å’Œä½¿ç”¨Feignçš„æ³¨æ„äº‹é¡¹å’Œå¸¸è§é—®é¢˜ã€‚æœ€åä»‹ç»äº†ä¸€ä¸‹æ›´æ¢Feigné»˜è®¤ä½¿ç”¨çš„HTTP Clientã€‚ä¸»è¦æ˜¯é‡åˆ°ä¸€ä¸ªå¥‡è‘©çš„é—®é¢˜ï¼Œæœ€ç»ˆæ²¡è§£å†³æ›´æ¢ç‰ˆæœ¬ã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­å°†ä»‹ç»Feignçš„å…¶å®ƒçš„ä½¿ç”¨ï¼Œä¾‹å¦‚Feignçš„ç»§æ‰¿ï¼Œæ—¥å¿—çº§åˆ«ï¼Œä»¥åŠFeignæºç åˆ†æç­‰</p><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a href="https://github.com/spring-cloud/spring-cloud-netflix/issues/1253" target="_blank" rel="noopener">å¸Œæœ›Feignèƒ½å¤Ÿæ”¯æŒå‚æ•°è¯·æ±‚ä½¿ç”¨POJOçš„Issue</a><br><a href="https://github.com/spring-cloud/spring-cloud-netflix/issues/659" target="_blank" rel="noopener">å»ºè®®ä½¿ç”¨FeignåŸç”Ÿçš„æ³¨è§£çš„Issue</a><br><a href="https://github.com/spring-cloud/spring-cloud-netflix/issues/1360" target="_blank" rel="noopener">å»ºè®®å¢å¼ºFeignçš„åŠŸèƒ½</a><br><a href="https://github.com/spring-cloud/spring-cloud-netflix/issues/1047" target="_blank" rel="noopener">å»ºè®®æ”¯æŒå¯é€‰çš„Request Bodyï¼ˆç›®å‰Feignå½“POSTä¸€ä¸ªnullæ—¶ï¼Œä¼šæŠ¥å¼‚å¸¸ï¼‰</a></p><div class="post-announce">æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œæœ¬æ–‡ç”± <a href="http://xujin.org">è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶</a> ç‰ˆæƒæ‰€æœ‰ã€‚å¦‚è‹¥è½¬è½½ï¼Œè¯·æ³¨æ˜å‡ºå¤„ï¼šè®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶ï¼ˆ<a href="http://xujin.org/sc/sc-fegin01/">http://xujin.org/sc/sc-fegin01/</a>ï¼‰</div><div class="post__prevs"><div class="post__prev"><a href="/ex/jdk8-parameters/" title="Java8ç¼–è¯‘å™¨çš„æ–°ç‰¹æ€§-å‚æ•°åå­—ä¿ç•™åœ¨å­—èŠ‚ç ä¸­"><i class="iconfont icon-prev"></i>Java8ç¼–è¯‘å™¨çš„æ–°ç‰¹æ€§-å‚æ•°åå­—ä¿ç•™åœ¨å­—èŠ‚ç ä¸­</a></div><div class="post__prev post__prev--right"><a href="/sc/sc-ribbon-demoted/" title="åœ¨Spring Cloudä¸­å®ç°é™çº§ä¹‹æƒé‡è·¯ç”±å’Œæ ‡ç­¾è·¯ç”±">åœ¨Spring Cloudä¸­å®ç°é™çº§ä¹‹æƒé‡è·¯ç”±å’Œæ ‡ç­¾è·¯ç”±<i class="iconfont icon-next"></i></a></div></div></div></article><div id="comment-container"></div></div><aside class="page__sidebar"><div id="toc" class="toc-article"><h3 class="block__title">æ–‡ç« ç›®å½•</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Feignç®€ä»‹"><span class="toc-number">1.</span> <span class="toc-text">Feignç®€ä»‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Feign-ç¤ºä¾‹å·¥ç¨‹"><span class="toc-number">2.</span> <span class="toc-text">Feign ç¤ºä¾‹å·¥ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æœåŠ¡æ¶ˆè´¹è€…ä¸­sc-feign-first-consumerçš„Feignçš„å®šä¹‰"><span class="toc-number">2.1.</span> <span class="toc-text">æœåŠ¡æ¶ˆè´¹è€…ä¸­sc-feign-first-consumerçš„Feignçš„å®šä¹‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æœåŠ¡æ¶ˆè´¹è€…ä¸­Feignçš„ä½¿ç”¨"><span class="toc-number">2.2.</span> <span class="toc-text">æœåŠ¡æ¶ˆè´¹è€…ä¸­Feignçš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¯åŠ¨æµ‹è¯•"><span class="toc-number">2.3.</span> <span class="toc-text">å¯åŠ¨æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Feginçš„workåŸç†"><span class="toc-number">3.</span> <span class="toc-text">Feginçš„workåŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Feginçš„å¸¸è§åº”ç”¨"><span class="toc-number">4.</span> <span class="toc-text">Feginçš„å¸¸è§åº”ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Feignçš„Encoderã€Decoderå’ŒErrorDecoder"><span class="toc-number">4.1.</span> <span class="toc-text">Feignçš„Encoderã€Decoderå’ŒErrorDecoder</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ›´æ¢Feigné»˜è®¤ä½¿ç”¨çš„HTTP-Client"><span class="toc-number">4.2.</span> <span class="toc-text">æ›´æ¢Feigné»˜è®¤ä½¿ç”¨çš„HTTP Client</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spring-cloud-feignå¸¸è§é—®é¢˜"><span class="toc-number">5.</span> <span class="toc-text">spring cloud feignå¸¸è§é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#å‚æ•°ä¸ä¼šè‡ªåŠ¨ä¼ é€’"><span class="toc-number">5.1.</span> <span class="toc-text">å‚æ•°ä¸ä¼šè‡ªåŠ¨ä¼ é€’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#POSTå¤šå‚æ•°è°ƒç”¨"><span class="toc-number">5.2.</span> <span class="toc-text">POSTå¤šå‚æ•°è°ƒç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GETå¤šå‚æ•°è°ƒç”¨"><span class="toc-number">5.3.</span> <span class="toc-text">GETå¤šå‚æ•°è°ƒç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ€»ç»“"><span class="toc-number">6.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å‚è€ƒæ–‡çŒ®"><span class="toc-number">7.</span> <span class="toc-text">å‚è€ƒæ–‡çŒ®</span></a></li></ol></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">å…³äº</h3><div class="item__content"><p class="item__text">è½¯ä»¶ä¸–ç•Œå°±æ˜¯æ¨¡æ‹Ÿå®¢è§‚ä¸–ç•Œï¼Œéœ€æ±‚åˆ†æï¼ŒæŠ€æœ¯é©±åŠ¨ï¼Œä»è€Œæ”¹å˜ä¸–ç•Œ!</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Shang Hai, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>Software_King@@qq.com</span></li></ul></div></div><div class="footer-top__item footer__image"><img src="/img/wx.jpg" alt="logo" title="è®¸è¿›æ²‰æ€å½•-ä¸“æ³¨äºäº’è”ç½‘ä¸ä¸­é—´ä»¶åŸºç¡€æ¶æ„æŠ€æœ¯ç ”ç©¶"></div><div class="footer-top__item"><h3 class="item__title">å‹æƒ…é“¾æ¥</h3><div class="item__content"><ul class="footer-top__list"><li class="list-item"><a href="http://www.xujin.org" title="è®¸è¿›|æ²‰æ€å½•" target="_blank">è®¸è¿›|æ²‰æ€å½•</a></li><li class="list-item"><a href="http://springcloud.cn" title="Spring Cloudä¸­å›½ç¤¾åŒº" target="_blank">Spring Cloudä¸­å›½ç¤¾åŒº</a></li><li class="list-item"><a href="http://www.cnblogs.com/ACMer/" title="æˆ‘çš„åšå®¢å›­" target="_blank">æˆ‘çš„åšå®¢å›­</a></li><li class="list-item"><a href="http://blog.sina.com.cn/softwaremi" title="æ–°æµªåšå®¢" target="_blank">æ–°æµªåšå®¢</a></li><li class="list-item"><a href="http://blog.chingzhu.com/" title="æœ±æ¸…åšå®¢" target="_blank">æœ±æ¸…åšå®¢</a></li><li class="list-item"><a href="http://tietang.wang/" title="é“æ±¤åšå®¢" target="_blank">é“æ±¤åšå®¢</a></li><li class="list-item"><a href="http://blog.csdn.net/forezp" title="æ–¹å¿—æœ‹çš„åšå®¢" target="_blank">æ–¹å¿—æœ‹çš„åšå®¢</a></li></ul></div></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">Powered by <a href="http://xujin.org/" target="_blank">Halo</a>, Made by <a href="https://github.com/softwareking" target="_blank">HaloğŸ’«</a>.</p><ul class="footer__social-network clearfix"><li class="social-network__item"><a href="https://github.com/softwareking" target="_blank" title="github"><i class="iconfont icon-github"></i></a></li><li class="social-network__item"><a href="/atom.xml" target="_blank" title="rss"><i class="iconfont icon-rss"></i></a></li><li class="social-network__item"><a href="/atom.xml" target="_blank" title="linkedin"><i class="iconfont icon-in"></i></a></li><li class="social-network__item"><a href="mailto:softwareking@qq.com" target="_blank" title="email"><i class="iconfont icon-email"></i></a></li></ul><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span>ğŸ€<span class="post-count">105.1k</span> </span><span>| </span><span id="busuanzi_container_site_uv" style="display:inline">ğŸ‘½<span id="busuanzi_value_site_uv">1000000</span><span></span></span><span class="footer-separator"> | </span><span id="busuanzi_container_site_pv" style="display:inline">ğŸŒ€<span id="busuanzi_value_site_pv">1000000</span><span></span></span></div></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/md5.min.js"></script><script>var tags=["Spring Cloud Fegin"],gitalk=new Gitalk({clientID:"322a00ea1ee28f04ba14",clientSecret:"01916d619a774e744b5e7b73bf4faa3d14b53bcc",repo:"italk",owner:"SoftwareKing",admin:["SoftwareKing"],labels:tags,id:new Date(14946552e5).getTime()>new Date("2018-02-15").getTime()?md5(location.href):location.href});gitalk.render("comment-container")</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>